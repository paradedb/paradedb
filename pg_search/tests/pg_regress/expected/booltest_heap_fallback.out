CREATE EXTENSION IF NOT EXISTS pg_search;
DROP TABLE IF EXISTS bt_docs CASCADE;
NOTICE:  table "bt_docs" does not exist, skipping
CREATE TABLE bt_docs (
                         id SERIAL,
                         content TEXT,
                         flag BOOLEAN
);
CREATE INDEX bt_docs_idx
    ON bt_docs
    USING bm25 (id, content)
    WITH (key_field='id');
INSERT INTO bt_docs (content, flag) VALUES
                                        ('hello world', true),
                                        ('hello parade', false),
                                        ('other text', true);
SET paradedb.enable_filter_pushdown = on;
EXPLAIN (COSTS OFF)
SELECT *
FROM bt_docs
WHERE content @@@ 'hello'
  AND flag IS TRUE;
                                                                                                                                     QUERY PLAN                                                                                                                                      
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Custom Scan (ParadeDB Scan) on bt_docs
   Table: bt_docs
   Index: bt_docs_idx
   Exec Method: NormalScanExecState
   Scores: false
   Tantivy Query: {"boolean":{"must":[{"heap_filter":{"indexed_query":{"boolean":{"must":[{"with_index":{"query":{"parse_with_field":{"field":"content","query_string":"hello","lenient":null,"conjunction_mode":null}}}}]}},"field_filters":[{"heap_filter":"(flag IS TRUE)"}]}}]}}
(6 rows)

