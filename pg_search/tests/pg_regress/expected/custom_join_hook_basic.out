-- Test basic join hook functionality
-- This test verifies that our custom join hook is being called
-- Create the extension first
CREATE EXTENSION IF NOT EXISTS pg_search;
-- Enable the custom join feature
SET paradedb.enable_custom_join = true;
-- Create test tables with BM25 indexes
CREATE TABLE documents_join_test (
    id SERIAL PRIMARY KEY,
    title TEXT,
    content TEXT
);
CREATE TABLE files_join_test (
    id SERIAL PRIMARY KEY,
    document_id INTEGER,
    filename TEXT,
    content TEXT
);
-- Create a third table for 3-way joins
CREATE TABLE authors_join_test (
    id SERIAL PRIMARY KEY,
    document_id INTEGER,
    author_name TEXT,
    bio TEXT
);
-- Insert test data
INSERT INTO documents_join_test (title, content) VALUES 
    ('Document 1', 'This is the first document about technology'),
    ('Document 2', 'This is the second document about science'),
    ('Document 3', 'This is the third document about research');
INSERT INTO files_join_test (document_id, filename, content) VALUES 
    (1, 'file1.txt', 'Technology file content'),
    (2, 'file2.txt', 'Science file content'),
    (3, 'file3.txt', 'Research file content');
INSERT INTO authors_join_test (document_id, author_name, bio) VALUES 
    (1, 'John Smith', 'Expert in technology and innovation'),
    (2, 'Jane Doe', 'Scientist specializing in research methods'),
    (3, 'Bob Wilson', 'Research analyst with focus on data science');
-- Create BM25 indexes
CREATE INDEX documents_join_test_idx ON documents_join_test USING bm25 (
    id,
    title,
    content
) WITH (
    key_field = 'id',
    text_fields = '{"title": {"tokenizer": {"type": "default"}}, "content": {"tokenizer": {"type": "default"}}}'
);
CREATE INDEX files_join_test_idx ON files_join_test USING bm25 (
    id,
    document_id,
    filename,
    content
) WITH (
    key_field = 'id',
    numeric_fields = '{"document_id": {"fast": true}}',
    text_fields = '{"filename": {"tokenizer": {"type": "default"}}, "content": {"tokenizer": {"type": "default"}}}'
);
CREATE INDEX authors_join_test_idx ON authors_join_test USING bm25 (
    id,
    document_id,
    author_name,
    bio
) WITH (
    key_field = 'id',
    numeric_fields = '{"document_id": {"fast": true}}',
    text_fields = '{"author_name": {"tokenizer": {"type": "default"}}, "bio": {"tokenizer": {"type": "default"}}}'
);
-- Test 1: Simple INNER JOIN with search predicates
-- This should trigger our join hook and show debug output
SELECT d.id, d.title, f.filename
FROM documents_join_test d
JOIN files_join_test f ON d.id = f.document_id
WHERE d.content @@@ 'technology' AND f.content @@@ 'file';
WARNING:  ParadeDB: Join pathlist callback called - jointype: 0, outer relids: ["documents_join_test"], inner relids: ["files_join_test"]
WARNING:  ParadeDB: Both sides are base relations - proceeding with standard join
WARNING:  ParadeDB: Found BM25 index for relation documents_join_test (rti 1)
WARNING:  ParadeDB: Checked relations ["documents_join_test"] for BM25 indexes, found: true
WARNING:  ParadeDB: Found BM25 index for relation files_join_test (rti 2)
WARNING:  ParadeDB: Checked relations ["files_join_test"] for BM25 indexes, found: true
WARNING:  ParadeDB: Join feasibility check - outer has BM25: true, inner has BM25: true
WARNING:  ParadeDB: Analyzing join search predicates
WARNING:  ParadeDB: Found 1 join restriction clauses
WARNING:  ParadeDB: Analyzing join clause of type T_OpExpr
WARNING:  ParadeDB: Analyzing 1 base restriction clauses for relation
WARNING:  ParadeDB: Extracting predicates for relation documents_join_test (rti 1)
WARNING:  ParadeDB: Extracted search query for documents_join_test: uses_search_operator=true
WARNING:  ParadeDB: Analyzing 1 base restriction clauses for relation
WARNING:  ParadeDB: Extracting predicates for relation files_join_test (rti 2)
WARNING:  ParadeDB: Extracted search query for files_join_test: uses_search_operator=true
WARNING:  ParadeDB: Extracted 1 outer predicates, 1 inner predicates, 0 join conditions
WARNING:  ParadeDB: Found search predicates - outer: 1, inner: 1, bilateral: true
WARNING:  ParadeDB: Join is feasible based on composite analysis: BothBaseRelations
WARNING:  ParadeDB: Outer predicate for documents_join_test - uses_search: true
WARNING:  ParadeDB: Inner predicate for files_join_test - uses_search: true
WARNING:  ParadeDB: Bilateral search detected - proceeding with custom join path
WARNING:  ParadeDB: Storing join relation OIDs - outer: ["documents_join_test"], inner: ["files_join_test"]
WARNING:  ParadeDB: Join path estimates - rows: 1, startup_cost: 100.00, total_cost: 100.01
WARNING:  ParadeDB: Created custom join path, adding to joinrel
WARNING:  ParadeDB: Join pathlist callback called - jointype: 0, outer relids: ["files_join_test"], inner relids: ["documents_join_test"]
WARNING:  ParadeDB: Both sides are base relations - proceeding with standard join
WARNING:  ParadeDB: Found BM25 index for relation files_join_test (rti 2)
WARNING:  ParadeDB: Checked relations ["files_join_test"] for BM25 indexes, found: true
WARNING:  ParadeDB: Found BM25 index for relation documents_join_test (rti 1)
WARNING:  ParadeDB: Checked relations ["documents_join_test"] for BM25 indexes, found: true
WARNING:  ParadeDB: Join feasibility check - outer has BM25: true, inner has BM25: true
WARNING:  ParadeDB: Analyzing join search predicates
WARNING:  ParadeDB: Found 1 join restriction clauses
WARNING:  ParadeDB: Analyzing join clause of type T_OpExpr
WARNING:  ParadeDB: Analyzing 1 base restriction clauses for relation
WARNING:  ParadeDB: Extracting predicates for relation files_join_test (rti 2)
WARNING:  ParadeDB: Extracted search query for files_join_test: uses_search_operator=true
WARNING:  ParadeDB: Analyzing 1 base restriction clauses for relation
WARNING:  ParadeDB: Extracting predicates for relation documents_join_test (rti 1)
WARNING:  ParadeDB: Extracted search query for documents_join_test: uses_search_operator=true
WARNING:  ParadeDB: Extracted 1 outer predicates, 1 inner predicates, 0 join conditions
WARNING:  ParadeDB: Found search predicates - outer: 1, inner: 1, bilateral: true
WARNING:  ParadeDB: Join is feasible based on composite analysis: BothBaseRelations
WARNING:  ParadeDB: Outer predicate for files_join_test - uses_search: true
WARNING:  ParadeDB: Inner predicate for documents_join_test - uses_search: true
WARNING:  ParadeDB: Bilateral search detected - proceeding with custom join path
WARNING:  ParadeDB: Storing join relation OIDs - outer: ["files_join_test"], inner: ["documents_join_test"]
WARNING:  ParadeDB: Join path estimates - rows: 1, startup_cost: 100.00, total_cost: 100.01
WARNING:  ParadeDB: Created custom join path, adding to joinrel
WARNING:  ParadeDB: Planning custom join path with scanrelid = 0
WARNING:  ParadeDB: Join target list has 3 entries
WARNING:  ParadeDB: Mapped join variable varno=1, varattno=1 to 'join_attr_1'
WARNING:  ParadeDB: Mapped join variable varno=1, varattno=2 to 'join_attr_2'
WARNING:  ParadeDB: Mapped join variable varno=2, varattno=3 to 'join_attr_3'
WARNING:  ParadeDB: Set custom scan target list for join node
WARNING:  ParadeDB: Creating custom scan state for join node (scanrelid = 0)
WARNING:  ParadeDB: Extracted search predicates from private data - outer: 1, inner: 1, bilateral: true
WARNING:  ParadeDB: Stored outer relation OIDs: ["documents_join_test"]
WARNING:  ParadeDB: Stored inner relation OIDs: ["files_join_test"]
WARNING:  ParadeDB: Storing 3 variable mappings from planning phase
WARNING:  ParadeDB: Planning-time mapping: varno=1, attno=1 -> 'join_attr_1'
WARNING:  ParadeDB: Planning-time mapping: varno=1, attno=2 -> 'join_attr_2'
WARNING:  ParadeDB: Planning-time mapping: varno=2, attno=3 -> 'join_attr_3'
WARNING:  ParadeDB: Beginning custom scan for join node
WARNING:  ParadeDB: Initializing join execution (simplified)
WARNING:  ParadeDB: Using stored search predicates - outer: 1, inner: 1, bilateral: true
WARNING:  ParadeDB: Join execution initialization complete
WARNING:  ParadeDB: Executing join step
WARNING:  ParadeDB: Starting join execution - initializing search
WARNING:  ParadeDB: Initializing search execution for join
WARNING:  ParadeDB: Retrieved search predicates from join state - outer: 1, inner: 1
WARNING:  ParadeDB: Initializing search readers for join relations
WARNING:  ParadeDB: Opening search reader for outer relation documents_join_test
WARNING:  ParadeDB: Successfully opened search reader for documents_join_test
WARNING:  ParadeDB: Opening search reader for inner relation files_join_test
WARNING:  ParadeDB: Successfully opened search reader for files_join_test
WARNING:  ParadeDB: Initialized 2 search readers
WARNING:  ParadeDB: Executing real searches on join relations
WARNING:  ParadeDB: Executing search on outer relation documents_join_test
WARNING:  ParadeDB: Executing real BM25 search on relation documents_join_test
WARNING:  ParadeDB: Real search on documents_join_test returned 1 results
WARNING:  ParadeDB: Found 1 results for outer relation documents_join_test
WARNING:  ParadeDB: Executing search on inner relation files_join_test
WARNING:  ParadeDB: Executing real BM25 search on relation files_join_test
WARNING:  ParadeDB: Real search on files_join_test returned 3 results
WARNING:  ParadeDB: Found 3 results for inner relation files_join_test
WARNING:  ParadeDB: Completed real search execution - outer: 1, inner: 3
WARNING:  ParadeDB: Executing join step
WARNING:  ParadeDB: Executing outer search
WARNING:  ParadeDB: Executing search on outer relation
WARNING:  ParadeDB: Outer search completed - 1 results
WARNING:  ParadeDB: Executing join step
WARNING:  ParadeDB: Executing inner search
WARNING:  ParadeDB: Executing search on inner relation
WARNING:  ParadeDB: Inner search completed - 3 results
WARNING:  ParadeDB: Executing join step
WARNING:  ParadeDB: Performing join matching
WARNING:  ParadeDB: Matching and returning next tuple with join condition evaluation
WARNING:  ParadeDB: Using stored relation OIDs from join state - outer: documents_join_test, inner: files_join_test
WARNING:  ParadeDB: Fetching column 'id' from relation documents_join_test with CTID 1
WARNING:  ParadeDB: Fetched column 'id' (attno 1) = Some("1")
WARNING:  ParadeDB: Fetching column 'document_id' from relation files_join_test with CTID 1
WARNING:  ParadeDB: Fetched column 'document_id' (attno 2) = Some("1")
WARNING:  ParadeDB: Join condition evaluation: 1 (documents_join_test.id) = 1 (files_join_test.document_id) -> true
WARNING:  ParadeDB: Evaluating join condition for outer[0] (ctid 1) × inner[0] (ctid 1) = true
WARNING:  ParadeDB: Join condition satisfied - creating result tuple for outer[0] × inner[0]
WARNING:  ParadeDB: Creating join result tuple for outer[0], inner[0]
WARNING:  ParadeDB: Creating result tuple with 3 attributes
WARNING:  ParadeDB: Using stored relation OIDs from join state - outer: documents_join_test, inner: files_join_test
WARNING:  ParadeDB: Fetching real heap tuple values from relations documents_join_test and files_join_test
WARNING:  ParadeDB: Using stored relation OIDs from join state - outer: documents_join_test, inner: files_join_test
WARNING:  ParadeDB: Detected relations from predicates - outer: 'documents_join_test', inner: 'files_join_test'
WARNING:  ParadeDB: Fetching all columns with names from relation documents_join_test with CTID 1
WARNING:  ParadeDB: documents_join_test column 'id' = '1'
WARNING:  ParadeDB: documents_join_test column 'title' = 'Document 1'
WARNING:  ParadeDB: documents_join_test column 'content' = 'This is the first document about technology'
WARNING:  ParadeDB: Successfully fetched 3 columns from documents_join_test relation
WARNING:  ParadeDB: Fetching all columns with names from relation files_join_test with CTID 1
WARNING:  ParadeDB: files_join_test column 'id' = '1'
WARNING:  ParadeDB: files_join_test column 'document_id' = '1'
WARNING:  ParadeDB: files_join_test column 'filename' = 'file1.txt'
WARNING:  ParadeDB: files_join_test column 'content' = 'Technology file content'
WARNING:  ParadeDB: Successfully fetched 4 columns from files_join_test relation
WARNING:  ParadeDB: Fetched 3 columns from outer relation, 4 from inner relation
WARNING:  ParadeDB: Analyzing 3 target entries using execution-time varno/attno mapping: [(1, Some((Ok("{VAR :varno -3 :varattno 1 :vartype 23 :vartypmod -1 :varcollid 0 :varnullingrels (b) :varlevelsup 0 :varnosyn 1 :varattnosyn 1 :location -1}"),))), (2, Some((Ok("{VAR :varno -3 :varattno 2 :vartype 25 :vartypmod -1 :varcollid 100 :varnullingrels (b) :varlevelsup 0 :varnosyn 1 :varattnosyn 2 :location -1}"),))), (3, Some((Ok("{VAR :varno -3 :varattno 3 :vartype 25 :vartypmod -1 :varcollid 100 :varnullingrels (b) :varlevelsup 0 :varnosyn 2 :varattnosyn 3 :location -1}"),)))]
WARNING:  ParadeDB: Mapped varno 4294967293 to outer relation documents_join_test
WARNING:  ParadeDB: Built execution-time varno mapping with 1 entries: [(4294967293, "documents_join_test")]
WARNING:  ParadeDB: Analyzing target entry 1 (resno: 1)
WARNING:  ParadeDB: Found Var in target entry 1 - varno: -3, attno: 1, varnosyn: 1, varattnosyn: 1
WARNING:  ParadeDB: Variable references INDEX/intermediate result, using varnosyn: 1, varattnosyn: 1
WARNING:  ParadeDB: Mapping original variable varnosyn: 1, varattnosyn: 1 to relation
WARNING:  ParadeDB: Using stored relation OIDs from join state - outer: documents_join_test, inner: files_join_test
WARNING:  ParadeDB: Resolved varnosyn 1 to relation documents_join_test
WARNING:  ParadeDB: varnosyn 1 resolved to relation documents_join_test, attno 1
WARNING:  ParadeDB: Relation documents_join_test attno 1 -> column name 'id'
WARNING:  ParadeDB: Target entry 1 mapped to: RelationColumn(documents_join_test,id)
WARNING:  ParadeDB: Analyzing target entry 2 (resno: 2)
WARNING:  ParadeDB: Found Var in target entry 2 - varno: -3, attno: 2, varnosyn: 1, varattnosyn: 2
WARNING:  ParadeDB: Variable references INDEX/intermediate result, using varnosyn: 1, varattnosyn: 2
WARNING:  ParadeDB: Mapping original variable varnosyn: 1, varattnosyn: 2 to relation
WARNING:  ParadeDB: Using stored relation OIDs from join state - outer: documents_join_test, inner: files_join_test
WARNING:  ParadeDB: Resolved varnosyn 1 to relation documents_join_test
WARNING:  ParadeDB: varnosyn 1 resolved to relation documents_join_test, attno 2
WARNING:  ParadeDB: Relation documents_join_test attno 2 -> column name 'title'
WARNING:  ParadeDB: Target entry 2 mapped to: RelationColumn(documents_join_test,title)
WARNING:  ParadeDB: Analyzing target entry 3 (resno: 3)
WARNING:  ParadeDB: Found Var in target entry 3 - varno: -3, attno: 3, varnosyn: 2, varattnosyn: 3
WARNING:  ParadeDB: Variable references INDEX/intermediate result, using varnosyn: 2, varattnosyn: 3
WARNING:  ParadeDB: Mapping original variable varnosyn: 2, varattnosyn: 3 to relation
WARNING:  ParadeDB: Using stored relation OIDs from join state - outer: documents_join_test, inner: files_join_test
WARNING:  ParadeDB: Resolved varnosyn 2 to relation files_join_test
WARNING:  ParadeDB: varnosyn 2 resolved to relation files_join_test, attno 3
WARNING:  ParadeDB: Relation files_join_test attno 3 -> column name 'filename'
WARNING:  ParadeDB: Target entry 3 mapped to: RelationColumn(files_join_test,filename)
WARNING:  ParadeDB: Mapped 3 out of 3 column values: [Some("1"), Some("Document 1"), Some("file1.txt")]
WARNING:  ParadeDB: Converting '1' to integer 1
WARNING:  ParadeDB: Created join result tuple with real heap data: [Some("1"), Some("Document 1"), Some("file1.txt")]
WARNING:  ParadeDB: Executing join step
WARNING:  ParadeDB: Performing join matching
WARNING:  ParadeDB: Matching and returning next tuple with join condition evaluation
WARNING:  ParadeDB: Using stored relation OIDs from join state - outer: documents_join_test, inner: files_join_test
WARNING:  ParadeDB: Fetching column 'id' from relation documents_join_test with CTID 1
WARNING:  ParadeDB: Fetched column 'id' (attno 1) = Some("1")
WARNING:  ParadeDB: Fetching column 'document_id' from relation files_join_test with CTID 2
WARNING:  ParadeDB: Fetched column 'document_id' (attno 2) = Some("2")
WARNING:  ParadeDB: Join condition evaluation: 1 (documents_join_test.id) = 2 (files_join_test.document_id) -> false
WARNING:  ParadeDB: Evaluating join condition for outer[0] (ctid 1) × inner[1] (ctid 2) = false
WARNING:  ParadeDB: Join condition not satisfied - advancing to next combination
WARNING:  ParadeDB: Using stored relation OIDs from join state - outer: documents_join_test, inner: files_join_test
WARNING:  ParadeDB: Fetching column 'id' from relation documents_join_test with CTID 1
WARNING:  ParadeDB: Fetched column 'id' (attno 1) = Some("1")
WARNING:  ParadeDB: Fetching column 'document_id' from relation files_join_test with CTID 3
WARNING:  ParadeDB: Fetched column 'document_id' (attno 2) = Some("3")
WARNING:  ParadeDB: Join condition evaluation: 1 (documents_join_test.id) = 3 (files_join_test.document_id) -> false
WARNING:  ParadeDB: Evaluating join condition for outer[0] (ctid 1) × inner[2] (ctid 3) = false
WARNING:  ParadeDB: Join condition not satisfied - advancing to next combination
WARNING:  ParadeDB: Join matching complete - total matches: 1
WARNING:  ParadeDB: Cleaning up join execution
WARNING:  ParadeDB: Cleaning up join execution state
WARNING:  ParadeDB: ===== JOIN EXECUTION STATISTICS =====
WARNING:  ParadeDB: Search Results - Outer: 1, Inner: 3, Total Combinations: 3
WARNING:  ParadeDB: Join Processing - Matches: 1, Returned: 1, Success Rate: 33.3%
WARNING:  ParadeDB: Heap Tuple Access - Attempts: 2, Successes: 3, Success Rate: 150.0%
WARNING:  ParadeDB: Cleaned up 2 search readers
WARNING:  ParadeDB: Cleared 1 outer and 3 inner search results
WARNING:  ParadeDB: ===== END JOIN EXECUTION STATISTICS =====
WARNING:  ParadeDB: Join execution cleanup complete
 id |   title    | filename  
----+------------+-----------
  1 | Document 1 | file1.txt
(1 row)

-- Test 2: JOIN without search predicates (should not trigger custom join)
SELECT d.id, d.title, f.filename  
FROM documents_join_test d
JOIN files_join_test f ON d.id = f.document_id
WHERE d.id = 1;
WARNING:  ParadeDB: Join pathlist callback called - jointype: 0, outer relids: ["documents_join_test"], inner relids: ["files_join_test"]
WARNING:  ParadeDB: Both sides are base relations - proceeding with standard join
WARNING:  ParadeDB: Found BM25 index for relation documents_join_test (rti 1)
WARNING:  ParadeDB: Checked relations ["documents_join_test"] for BM25 indexes, found: true
WARNING:  ParadeDB: Found BM25 index for relation files_join_test (rti 2)
WARNING:  ParadeDB: Checked relations ["files_join_test"] for BM25 indexes, found: true
WARNING:  ParadeDB: Join feasibility check - outer has BM25: true, inner has BM25: true
WARNING:  ParadeDB: Analyzing join search predicates
WARNING:  ParadeDB: Analyzing 1 base restriction clauses for relation
WARNING:  ParadeDB: Extracting predicates for relation documents_join_test (rti 1)
WARNING:  ParadeDB: Extracted search query for documents_join_test: uses_search_operator=false
WARNING:  ParadeDB: Analyzing 1 base restriction clauses for relation
WARNING:  ParadeDB: Extracting predicates for relation files_join_test (rti 2)
WARNING:  ParadeDB: Extracted search query for files_join_test: uses_search_operator=false
WARNING:  ParadeDB: Extracted 1 outer predicates, 1 inner predicates, 0 join conditions
WARNING:  ParadeDB: Found search predicates - outer: 1, inner: 1, bilateral: true
WARNING:  ParadeDB: Skipping custom join - no search operators found (outer: false, inner: false)
WARNING:  ParadeDB: Join pathlist callback called - jointype: 0, outer relids: ["files_join_test"], inner relids: ["documents_join_test"]
WARNING:  ParadeDB: Both sides are base relations - proceeding with standard join
WARNING:  ParadeDB: Found BM25 index for relation files_join_test (rti 2)
WARNING:  ParadeDB: Checked relations ["files_join_test"] for BM25 indexes, found: true
WARNING:  ParadeDB: Found BM25 index for relation documents_join_test (rti 1)
WARNING:  ParadeDB: Checked relations ["documents_join_test"] for BM25 indexes, found: true
WARNING:  ParadeDB: Join feasibility check - outer has BM25: true, inner has BM25: true
WARNING:  ParadeDB: Analyzing join search predicates
WARNING:  ParadeDB: Analyzing 1 base restriction clauses for relation
WARNING:  ParadeDB: Extracting predicates for relation files_join_test (rti 2)
WARNING:  ParadeDB: Extracted search query for files_join_test: uses_search_operator=false
WARNING:  ParadeDB: Analyzing 1 base restriction clauses for relation
WARNING:  ParadeDB: Extracting predicates for relation documents_join_test (rti 1)
WARNING:  ParadeDB: Extracted search query for documents_join_test: uses_search_operator=false
WARNING:  ParadeDB: Extracted 1 outer predicates, 1 inner predicates, 0 join conditions
WARNING:  ParadeDB: Found search predicates - outer: 1, inner: 1, bilateral: true
WARNING:  ParadeDB: Skipping custom join - no search operators found (outer: false, inner: false)
 id |   title    | filename  
----+------------+-----------
  1 | Document 1 | file1.txt
(1 row)

-- Test 3: Search on only one side (unilateral join)
SELECT d.id, d.title, f.filename
FROM documents_join_test d  
JOIN files_join_test f ON d.id = f.document_id
WHERE d.content @@@ 'science';
WARNING:  ParadeDB: Join pathlist callback called - jointype: 0, outer relids: ["documents_join_test"], inner relids: ["files_join_test"]
WARNING:  ParadeDB: Both sides are base relations - proceeding with standard join
WARNING:  ParadeDB: Found BM25 index for relation documents_join_test (rti 1)
WARNING:  ParadeDB: Checked relations ["documents_join_test"] for BM25 indexes, found: true
WARNING:  ParadeDB: Found BM25 index for relation files_join_test (rti 2)
WARNING:  ParadeDB: Checked relations ["files_join_test"] for BM25 indexes, found: true
WARNING:  ParadeDB: Join feasibility check - outer has BM25: true, inner has BM25: true
WARNING:  ParadeDB: Analyzing join search predicates
WARNING:  ParadeDB: Found 1 join restriction clauses
WARNING:  ParadeDB: Analyzing join clause of type T_OpExpr
WARNING:  ParadeDB: Analyzing 1 base restriction clauses for relation
WARNING:  ParadeDB: Extracting predicates for relation documents_join_test (rti 1)
WARNING:  ParadeDB: Extracted search query for documents_join_test: uses_search_operator=true
WARNING:  ParadeDB: Extracted 1 outer predicates, 0 inner predicates, 0 join conditions
WARNING:  ParadeDB: Found search predicates - outer: 1, inner: 0, bilateral: false
WARNING:  ParadeDB: Join is feasible based on composite analysis: BothBaseRelations
WARNING:  ParadeDB: Outer predicate for documents_join_test - uses_search: true
WARNING:  ParadeDB: Unilateral search detected - proceeding with custom join path
WARNING:  ParadeDB: Storing join relation OIDs - outer: ["documents_join_test"], inner: ["files_join_test"]
WARNING:  ParadeDB: Join path estimates - rows: 1, startup_cost: 100.00, total_cost: 100.01
WARNING:  ParadeDB: Created custom join path, adding to joinrel
WARNING:  ParadeDB: Join pathlist callback called - jointype: 0, outer relids: ["files_join_test"], inner relids: ["documents_join_test"]
WARNING:  ParadeDB: Both sides are base relations - proceeding with standard join
WARNING:  ParadeDB: Found BM25 index for relation files_join_test (rti 2)
WARNING:  ParadeDB: Checked relations ["files_join_test"] for BM25 indexes, found: true
WARNING:  ParadeDB: Found BM25 index for relation documents_join_test (rti 1)
WARNING:  ParadeDB: Checked relations ["documents_join_test"] for BM25 indexes, found: true
WARNING:  ParadeDB: Join feasibility check - outer has BM25: true, inner has BM25: true
WARNING:  ParadeDB: Analyzing join search predicates
WARNING:  ParadeDB: Found 1 join restriction clauses
WARNING:  ParadeDB: Analyzing join clause of type T_OpExpr
WARNING:  ParadeDB: Analyzing 1 base restriction clauses for relation
WARNING:  ParadeDB: Extracting predicates for relation documents_join_test (rti 1)
WARNING:  ParadeDB: Extracted search query for documents_join_test: uses_search_operator=true
WARNING:  ParadeDB: Extracted 0 outer predicates, 1 inner predicates, 0 join conditions
WARNING:  ParadeDB: Found search predicates - outer: 0, inner: 1, bilateral: false
WARNING:  ParadeDB: Join is feasible based on composite analysis: BothBaseRelations
WARNING:  ParadeDB: Inner predicate for documents_join_test - uses_search: true
WARNING:  ParadeDB: Unilateral search detected - proceeding with custom join path
WARNING:  ParadeDB: Storing join relation OIDs - outer: ["files_join_test"], inner: ["documents_join_test"]
WARNING:  ParadeDB: Join path estimates - rows: 1, startup_cost: 100.00, total_cost: 100.01
WARNING:  ParadeDB: Created custom join path, adding to joinrel
WARNING:  ParadeDB: Planning custom join path with scanrelid = 0
WARNING:  ParadeDB: Join target list has 3 entries
WARNING:  ParadeDB: Mapped join variable varno=1, varattno=1 to 'join_attr_1'
WARNING:  ParadeDB: Mapped join variable varno=1, varattno=2 to 'join_attr_2'
WARNING:  ParadeDB: Mapped join variable varno=2, varattno=3 to 'join_attr_3'
WARNING:  ParadeDB: Set custom scan target list for join node
WARNING:  ParadeDB: Creating custom scan state for join node (scanrelid = 0)
WARNING:  ParadeDB: Extracted search predicates from private data - outer: 1, inner: 0, bilateral: false
WARNING:  ParadeDB: Stored outer relation OIDs: ["documents_join_test"]
WARNING:  ParadeDB: Stored inner relation OIDs: ["files_join_test"]
WARNING:  ParadeDB: Storing 3 variable mappings from planning phase
WARNING:  ParadeDB: Planning-time mapping: varno=1, attno=1 -> 'join_attr_1'
WARNING:  ParadeDB: Planning-time mapping: varno=1, attno=2 -> 'join_attr_2'
WARNING:  ParadeDB: Planning-time mapping: varno=2, attno=3 -> 'join_attr_3'
WARNING:  ParadeDB: Beginning custom scan for join node
WARNING:  ParadeDB: Initializing join execution (simplified)
WARNING:  ParadeDB: Using stored search predicates - outer: 1, inner: 0, bilateral: false
WARNING:  ParadeDB: Join execution initialization complete
WARNING:  ParadeDB: Executing join step
WARNING:  ParadeDB: Starting join execution - initializing search
WARNING:  ParadeDB: Initializing search execution for join
WARNING:  ParadeDB: Retrieved search predicates from join state - outer: 1, inner: 0
WARNING:  ParadeDB: Initializing search readers for join relations
WARNING:  ParadeDB: Opening search reader for outer relation documents_join_test
WARNING:  ParadeDB: Successfully opened search reader for documents_join_test
WARNING:  ParadeDB: Initialized 1 search readers
WARNING:  ParadeDB: Executing real searches on join relations
WARNING:  ParadeDB: Executing search on outer relation documents_join_test
WARNING:  ParadeDB: Executing real BM25 search on relation documents_join_test
WARNING:  ParadeDB: Real search on documents_join_test returned 1 results
WARNING:  ParadeDB: Found 1 results for outer relation documents_join_test
WARNING:  ParadeDB: No inner search results, using default result
WARNING:  ParadeDB: Completed real search execution - outer: 1, inner: 1
WARNING:  ParadeDB: Executing join step
WARNING:  ParadeDB: Executing outer search
WARNING:  ParadeDB: Executing search on outer relation
WARNING:  ParadeDB: Outer search completed - 1 results
WARNING:  ParadeDB: Executing join step
WARNING:  ParadeDB: Executing inner search
WARNING:  ParadeDB: Executing search on inner relation
WARNING:  ParadeDB: Inner search completed - 1 results
WARNING:  ParadeDB: Executing join step
WARNING:  ParadeDB: Performing join matching
WARNING:  ParadeDB: Matching and returning next tuple with join condition evaluation
WARNING:  ParadeDB: Using stored relation OIDs from join state - outer: documents_join_test, inner: files_join_test
WARNING:  ParadeDB: Fetching column 'id' from relation documents_join_test with CTID 2
WARNING:  ParadeDB: Fetched column 'id' (attno 1) = Some("2")
WARNING:  ParadeDB: Fetching column 'document_id' from relation files_join_test with CTID 1
WARNING:  ParadeDB: Fetched column 'document_id' (attno 2) = Some("1")
WARNING:  ParadeDB: Join condition evaluation: 2 (documents_join_test.id) = 1 (files_join_test.document_id) -> false
WARNING:  ParadeDB: Evaluating join condition for outer[0] (ctid 2) × inner[0] (ctid 1) = false
WARNING:  ParadeDB: Join condition not satisfied - advancing to next combination
WARNING:  ParadeDB: Join matching complete - total matches: 0
WARNING:  ParadeDB: Cleaning up join execution
WARNING:  ParadeDB: Cleaning up join execution state
WARNING:  ParadeDB: ===== JOIN EXECUTION STATISTICS =====
WARNING:  ParadeDB: Search Results - Outer: 1, Inner: 1, Total Combinations: 1
WARNING:  ParadeDB: Join Processing - Matches: 0, Returned: 0, Success Rate: 0.0%
WARNING:  ParadeDB: Heap Tuple Access - Attempts: 0, Successes: 0, Success Rate: 0.0%
WARNING:  ParadeDB: Cleaned up 1 search readers
WARNING:  ParadeDB: Cleared 1 outer and 1 inner search results
WARNING:  ParadeDB: ===== END JOIN EXECUTION STATISTICS =====
WARNING:  ParadeDB: Join execution cleanup complete
 id | title | filename 
----+-------+----------
(0 rows)

-- Test 4: 3-way join with bilateral search (documents + files)
SELECT d.id, d.title, f.filename, a.author_name
FROM documents_join_test d
JOIN files_join_test f ON d.id = f.document_id
JOIN authors_join_test a ON d.id = a.document_id
WHERE d.content @@@ 'technology' AND f.content @@@ 'file';
WARNING:  ParadeDB: Join pathlist callback called - jointype: 0, outer relids: ["documents_join_test"], inner relids: ["files_join_test"]
WARNING:  ParadeDB: Both sides are base relations - proceeding with standard join
WARNING:  ParadeDB: Found BM25 index for relation documents_join_test (rti 1)
WARNING:  ParadeDB: Checked relations ["documents_join_test"] for BM25 indexes, found: true
WARNING:  ParadeDB: Found BM25 index for relation files_join_test (rti 2)
WARNING:  ParadeDB: Checked relations ["files_join_test"] for BM25 indexes, found: true
WARNING:  ParadeDB: Join feasibility check - outer has BM25: true, inner has BM25: true
WARNING:  ParadeDB: Analyzing join search predicates
WARNING:  ParadeDB: Found 1 join restriction clauses
WARNING:  ParadeDB: Analyzing join clause of type T_OpExpr
WARNING:  ParadeDB: Analyzing 1 base restriction clauses for relation
WARNING:  ParadeDB: Extracting predicates for relation documents_join_test (rti 1)
WARNING:  ParadeDB: Extracted search query for documents_join_test: uses_search_operator=true
WARNING:  ParadeDB: Analyzing 1 base restriction clauses for relation
WARNING:  ParadeDB: Extracting predicates for relation files_join_test (rti 2)
WARNING:  ParadeDB: Extracted search query for files_join_test: uses_search_operator=true
WARNING:  ParadeDB: Extracted 1 outer predicates, 1 inner predicates, 0 join conditions
WARNING:  ParadeDB: Found search predicates - outer: 1, inner: 1, bilateral: true
WARNING:  ParadeDB: Join is feasible based on composite analysis: BothBaseRelations
WARNING:  ParadeDB: Outer predicate for documents_join_test - uses_search: true
WARNING:  ParadeDB: Inner predicate for files_join_test - uses_search: true
WARNING:  ParadeDB: Bilateral search detected - proceeding with custom join path
WARNING:  ParadeDB: Storing join relation OIDs - outer: ["documents_join_test"], inner: ["files_join_test"]
WARNING:  ParadeDB: Join path estimates - rows: 1, startup_cost: 100.00, total_cost: 100.01
WARNING:  ParadeDB: Created custom join path, adding to joinrel
WARNING:  ParadeDB: Join pathlist callback called - jointype: 0, outer relids: ["files_join_test"], inner relids: ["documents_join_test"]
WARNING:  ParadeDB: Both sides are base relations - proceeding with standard join
WARNING:  ParadeDB: Found BM25 index for relation files_join_test (rti 2)
WARNING:  ParadeDB: Checked relations ["files_join_test"] for BM25 indexes, found: true
WARNING:  ParadeDB: Found BM25 index for relation documents_join_test (rti 1)
WARNING:  ParadeDB: Checked relations ["documents_join_test"] for BM25 indexes, found: true
WARNING:  ParadeDB: Join feasibility check - outer has BM25: true, inner has BM25: true
WARNING:  ParadeDB: Analyzing join search predicates
WARNING:  ParadeDB: Found 1 join restriction clauses
WARNING:  ParadeDB: Analyzing join clause of type T_OpExpr
WARNING:  ParadeDB: Analyzing 1 base restriction clauses for relation
WARNING:  ParadeDB: Extracting predicates for relation files_join_test (rti 2)
WARNING:  ParadeDB: Extracted search query for files_join_test: uses_search_operator=true
WARNING:  ParadeDB: Analyzing 1 base restriction clauses for relation
WARNING:  ParadeDB: Extracting predicates for relation documents_join_test (rti 1)
WARNING:  ParadeDB: Extracted search query for documents_join_test: uses_search_operator=true
WARNING:  ParadeDB: Extracted 1 outer predicates, 1 inner predicates, 0 join conditions
WARNING:  ParadeDB: Found search predicates - outer: 1, inner: 1, bilateral: true
WARNING:  ParadeDB: Join is feasible based on composite analysis: BothBaseRelations
WARNING:  ParadeDB: Outer predicate for files_join_test - uses_search: true
WARNING:  ParadeDB: Inner predicate for documents_join_test - uses_search: true
WARNING:  ParadeDB: Bilateral search detected - proceeding with custom join path
WARNING:  ParadeDB: Storing join relation OIDs - outer: ["files_join_test"], inner: ["documents_join_test"]
WARNING:  ParadeDB: Join path estimates - rows: 1, startup_cost: 100.00, total_cost: 100.01
WARNING:  ParadeDB: Created custom join path, adding to joinrel
WARNING:  ParadeDB: Join pathlist callback called - jointype: 0, outer relids: ["documents_join_test"], inner relids: ["authors_join_test"]
WARNING:  ParadeDB: Both sides are base relations - proceeding with standard join
WARNING:  ParadeDB: Found BM25 index for relation documents_join_test (rti 1)
WARNING:  ParadeDB: Checked relations ["documents_join_test"] for BM25 indexes, found: true
WARNING:  ParadeDB: Found BM25 index for relation authors_join_test (rti 4)
WARNING:  ParadeDB: Checked relations ["authors_join_test"] for BM25 indexes, found: true
WARNING:  ParadeDB: Join feasibility check - outer has BM25: true, inner has BM25: true
WARNING:  ParadeDB: Analyzing join search predicates
WARNING:  ParadeDB: Found 1 join restriction clauses
WARNING:  ParadeDB: Analyzing join clause of type T_OpExpr
WARNING:  ParadeDB: Analyzing 1 base restriction clauses for relation
WARNING:  ParadeDB: Extracting predicates for relation documents_join_test (rti 1)
WARNING:  ParadeDB: Extracted search query for documents_join_test: uses_search_operator=true
WARNING:  ParadeDB: Extracted 1 outer predicates, 0 inner predicates, 0 join conditions
WARNING:  ParadeDB: Found search predicates - outer: 1, inner: 0, bilateral: false
WARNING:  ParadeDB: Join is feasible based on composite analysis: BothBaseRelations
WARNING:  ParadeDB: Outer predicate for documents_join_test - uses_search: true
WARNING:  ParadeDB: Unilateral search detected - proceeding with custom join path
WARNING:  ParadeDB: Storing join relation OIDs - outer: ["documents_join_test"], inner: ["authors_join_test"]
WARNING:  ParadeDB: Join path estimates - rows: 1, startup_cost: 100.00, total_cost: 100.01
WARNING:  ParadeDB: Created custom join path, adding to joinrel
WARNING:  ParadeDB: Join pathlist callback called - jointype: 0, outer relids: ["authors_join_test"], inner relids: ["documents_join_test"]
WARNING:  ParadeDB: Both sides are base relations - proceeding with standard join
WARNING:  ParadeDB: Found BM25 index for relation authors_join_test (rti 4)
WARNING:  ParadeDB: Checked relations ["authors_join_test"] for BM25 indexes, found: true
WARNING:  ParadeDB: Found BM25 index for relation documents_join_test (rti 1)
WARNING:  ParadeDB: Checked relations ["documents_join_test"] for BM25 indexes, found: true
WARNING:  ParadeDB: Join feasibility check - outer has BM25: true, inner has BM25: true
WARNING:  ParadeDB: Analyzing join search predicates
WARNING:  ParadeDB: Found 1 join restriction clauses
WARNING:  ParadeDB: Analyzing join clause of type T_OpExpr
WARNING:  ParadeDB: Analyzing 1 base restriction clauses for relation
WARNING:  ParadeDB: Extracting predicates for relation documents_join_test (rti 1)
WARNING:  ParadeDB: Extracted search query for documents_join_test: uses_search_operator=true
WARNING:  ParadeDB: Extracted 0 outer predicates, 1 inner predicates, 0 join conditions
WARNING:  ParadeDB: Found search predicates - outer: 0, inner: 1, bilateral: false
WARNING:  ParadeDB: Join is feasible based on composite analysis: BothBaseRelations
WARNING:  ParadeDB: Inner predicate for documents_join_test - uses_search: true
WARNING:  ParadeDB: Unilateral search detected - proceeding with custom join path
WARNING:  ParadeDB: Storing join relation OIDs - outer: ["authors_join_test"], inner: ["documents_join_test"]
WARNING:  ParadeDB: Join path estimates - rows: 1, startup_cost: 100.00, total_cost: 100.01
WARNING:  ParadeDB: Created custom join path, adding to joinrel
WARNING:  ParadeDB: Join pathlist callback called - jointype: 0, outer relids: ["files_join_test"], inner relids: ["authors_join_test"]
WARNING:  ParadeDB: Both sides are base relations - proceeding with standard join
WARNING:  ParadeDB: Found BM25 index for relation files_join_test (rti 2)
WARNING:  ParadeDB: Checked relations ["files_join_test"] for BM25 indexes, found: true
WARNING:  ParadeDB: Found BM25 index for relation authors_join_test (rti 4)
WARNING:  ParadeDB: Checked relations ["authors_join_test"] for BM25 indexes, found: true
WARNING:  ParadeDB: Join feasibility check - outer has BM25: true, inner has BM25: true
WARNING:  ParadeDB: Analyzing join search predicates
WARNING:  ParadeDB: Found 1 join restriction clauses
WARNING:  ParadeDB: Analyzing join clause of type T_OpExpr
WARNING:  ParadeDB: Analyzing 1 base restriction clauses for relation
WARNING:  ParadeDB: Extracting predicates for relation files_join_test (rti 2)
WARNING:  ParadeDB: Extracted search query for files_join_test: uses_search_operator=true
WARNING:  ParadeDB: Extracted 1 outer predicates, 0 inner predicates, 0 join conditions
WARNING:  ParadeDB: Found search predicates - outer: 1, inner: 0, bilateral: false
WARNING:  ParadeDB: Join is feasible based on composite analysis: BothBaseRelations
WARNING:  ParadeDB: Outer predicate for files_join_test - uses_search: true
WARNING:  ParadeDB: Unilateral search detected - proceeding with custom join path
WARNING:  ParadeDB: Storing join relation OIDs - outer: ["files_join_test"], inner: ["authors_join_test"]
WARNING:  ParadeDB: Join path estimates - rows: 1, startup_cost: 100.00, total_cost: 100.01
WARNING:  ParadeDB: Created custom join path, adding to joinrel
WARNING:  ParadeDB: Join pathlist callback called - jointype: 0, outer relids: ["authors_join_test"], inner relids: ["files_join_test"]
WARNING:  ParadeDB: Both sides are base relations - proceeding with standard join
WARNING:  ParadeDB: Found BM25 index for relation authors_join_test (rti 4)
WARNING:  ParadeDB: Checked relations ["authors_join_test"] for BM25 indexes, found: true
WARNING:  ParadeDB: Found BM25 index for relation files_join_test (rti 2)
WARNING:  ParadeDB: Checked relations ["files_join_test"] for BM25 indexes, found: true
WARNING:  ParadeDB: Join feasibility check - outer has BM25: true, inner has BM25: true
WARNING:  ParadeDB: Analyzing join search predicates
WARNING:  ParadeDB: Found 1 join restriction clauses
WARNING:  ParadeDB: Analyzing join clause of type T_OpExpr
WARNING:  ParadeDB: Analyzing 1 base restriction clauses for relation
WARNING:  ParadeDB: Extracting predicates for relation files_join_test (rti 2)
WARNING:  ParadeDB: Extracted search query for files_join_test: uses_search_operator=true
WARNING:  ParadeDB: Extracted 0 outer predicates, 1 inner predicates, 0 join conditions
WARNING:  ParadeDB: Found search predicates - outer: 0, inner: 1, bilateral: false
WARNING:  ParadeDB: Join is feasible based on composite analysis: BothBaseRelations
WARNING:  ParadeDB: Inner predicate for files_join_test - uses_search: true
WARNING:  ParadeDB: Unilateral search detected - proceeding with custom join path
WARNING:  ParadeDB: Storing join relation OIDs - outer: ["authors_join_test"], inner: ["files_join_test"]
WARNING:  ParadeDB: Join path estimates - rows: 1, startup_cost: 100.00, total_cost: 100.01
WARNING:  ParadeDB: Created custom join path, adding to joinrel
WARNING:  ParadeDB: Join pathlist callback called - jointype: 0, outer relids: ["documents_join_test", "files_join_test"], inner relids: ["authors_join_test"]
WARNING:  ParadeDB: Outer side is composite, inner is base - checking if we can handle this
WARNING:  ParadeDB: Found BM25 index for relation authors_join_test (rti 4)
WARNING:  ParadeDB: Checked relations ["authors_join_test"] for BM25 indexes, found: true
WARNING:  ParadeDB: Composite join - outer is composite, checking inner for BM25: true
WARNING:  ParadeDB: Join feasibility check - outer has BM25: false, inner has BM25: true
WARNING:  ParadeDB: Analyzing join search predicates
WARNING:  ParadeDB: Found 1 join restriction clauses
WARNING:  ParadeDB: Analyzing join clause of type T_OpExpr
WARNING:  ParadeDB: Extracted 0 outer predicates, 0 inner predicates, 0 join conditions
WARNING:  ParadeDB: No search predicates found in join - skipping custom join
WARNING:  ParadeDB: Join pathlist callback called - jointype: 0, outer relids: ["authors_join_test"], inner relids: ["documents_join_test", "files_join_test"]
WARNING:  ParadeDB: Outer side is base, inner is composite - checking if we can handle this
WARNING:  ParadeDB: Found BM25 index for relation authors_join_test (rti 4)
WARNING:  ParadeDB: Checked relations ["authors_join_test"] for BM25 indexes, found: true
WARNING:  ParadeDB: Composite join - inner is composite, checking outer for BM25: true
WARNING:  ParadeDB: Join feasibility check - outer has BM25: true, inner has BM25: false
WARNING:  ParadeDB: Analyzing join search predicates
WARNING:  ParadeDB: Found 1 join restriction clauses
WARNING:  ParadeDB: Analyzing join clause of type T_OpExpr
WARNING:  ParadeDB: Extracted 0 outer predicates, 0 inner predicates, 0 join conditions
WARNING:  ParadeDB: No search predicates found in join - skipping custom join
WARNING:  ParadeDB: Join pathlist callback called - jointype: 0, outer relids: ["documents_join_test", "authors_join_test"], inner relids: ["files_join_test"]
WARNING:  ParadeDB: Outer side is composite, inner is base - checking if we can handle this
WARNING:  ParadeDB: Found BM25 index for relation files_join_test (rti 2)
WARNING:  ParadeDB: Checked relations ["files_join_test"] for BM25 indexes, found: true
WARNING:  ParadeDB: Composite join - outer is composite, checking inner for BM25: true
WARNING:  ParadeDB: Join feasibility check - outer has BM25: false, inner has BM25: true
WARNING:  ParadeDB: Analyzing join search predicates
WARNING:  ParadeDB: Found 1 join restriction clauses
WARNING:  ParadeDB: Analyzing join clause of type T_OpExpr
WARNING:  ParadeDB: Analyzing 1 base restriction clauses for relation
WARNING:  ParadeDB: Extracting predicates for relation files_join_test (rti 2)
WARNING:  ParadeDB: Extracted search query for files_join_test: uses_search_operator=true
WARNING:  ParadeDB: Extracted 0 outer predicates, 1 inner predicates, 0 join conditions
WARNING:  ParadeDB: Found search predicates - outer: 0, inner: 1, bilateral: false
WARNING:  ParadeDB: Join is feasible based on composite analysis: OuterComposite
WARNING:  ParadeDB: Inner predicate for files_join_test - uses_search: true
WARNING:  ParadeDB: Unilateral search detected - proceeding with custom join path
WARNING:  ParadeDB: Storing join relation OIDs - outer: ["documents_join_test", "authors_join_test"], inner: ["files_join_test"]
WARNING:  ParadeDB: Storing composite join info - composite_side: Outer, base_has_search: true, composite_has_search: false
WARNING:  ParadeDB: Join path estimates - rows: 1, startup_cost: 100.00, total_cost: 100.01
WARNING:  ParadeDB: Created custom join path, adding to joinrel
WARNING:  ParadeDB: Join pathlist callback called - jointype: 0, outer relids: ["files_join_test"], inner relids: ["documents_join_test", "authors_join_test"]
WARNING:  ParadeDB: Outer side is base, inner is composite - checking if we can handle this
WARNING:  ParadeDB: Found BM25 index for relation files_join_test (rti 2)
WARNING:  ParadeDB: Checked relations ["files_join_test"] for BM25 indexes, found: true
WARNING:  ParadeDB: Composite join - inner is composite, checking outer for BM25: true
WARNING:  ParadeDB: Join feasibility check - outer has BM25: true, inner has BM25: false
WARNING:  ParadeDB: Analyzing join search predicates
WARNING:  ParadeDB: Found 1 join restriction clauses
WARNING:  ParadeDB: Analyzing join clause of type T_OpExpr
WARNING:  ParadeDB: Analyzing 1 base restriction clauses for relation
WARNING:  ParadeDB: Extracting predicates for relation files_join_test (rti 2)
WARNING:  ParadeDB: Extracted search query for files_join_test: uses_search_operator=true
WARNING:  ParadeDB: Extracted 1 outer predicates, 0 inner predicates, 0 join conditions
WARNING:  ParadeDB: Found search predicates - outer: 1, inner: 0, bilateral: false
WARNING:  ParadeDB: Join is feasible based on composite analysis: InnerComposite
WARNING:  ParadeDB: Outer predicate for files_join_test - uses_search: true
WARNING:  ParadeDB: Unilateral search detected - proceeding with custom join path
WARNING:  ParadeDB: Storing join relation OIDs - outer: ["files_join_test"], inner: ["documents_join_test", "authors_join_test"]
WARNING:  ParadeDB: Storing composite join info - composite_side: Inner, base_has_search: true, composite_has_search: false
WARNING:  ParadeDB: Join path estimates - rows: 1, startup_cost: 100.00, total_cost: 100.01
WARNING:  ParadeDB: Created custom join path, adding to joinrel
WARNING:  ParadeDB: Join pathlist callback called - jointype: 0, outer relids: ["files_join_test", "authors_join_test"], inner relids: ["documents_join_test"]
WARNING:  ParadeDB: Outer side is composite, inner is base - checking if we can handle this
WARNING:  ParadeDB: Found BM25 index for relation documents_join_test (rti 1)
WARNING:  ParadeDB: Checked relations ["documents_join_test"] for BM25 indexes, found: true
WARNING:  ParadeDB: Composite join - outer is composite, checking inner for BM25: true
WARNING:  ParadeDB: Join feasibility check - outer has BM25: false, inner has BM25: true
WARNING:  ParadeDB: Analyzing join search predicates
WARNING:  ParadeDB: Found 1 join restriction clauses
WARNING:  ParadeDB: Analyzing join clause of type T_OpExpr
WARNING:  ParadeDB: Analyzing 1 base restriction clauses for relation
WARNING:  ParadeDB: Extracting predicates for relation documents_join_test (rti 1)
WARNING:  ParadeDB: Extracted search query for documents_join_test: uses_search_operator=true
WARNING:  ParadeDB: Extracted 0 outer predicates, 1 inner predicates, 0 join conditions
WARNING:  ParadeDB: Found search predicates - outer: 0, inner: 1, bilateral: false
WARNING:  ParadeDB: Join is feasible based on composite analysis: OuterComposite
WARNING:  ParadeDB: Inner predicate for documents_join_test - uses_search: true
WARNING:  ParadeDB: Unilateral search detected - proceeding with custom join path
WARNING:  ParadeDB: Storing join relation OIDs - outer: ["files_join_test", "authors_join_test"], inner: ["documents_join_test"]
WARNING:  ParadeDB: Storing composite join info - composite_side: Outer, base_has_search: true, composite_has_search: false
WARNING:  ParadeDB: Join path estimates - rows: 1, startup_cost: 100.00, total_cost: 100.01
WARNING:  ParadeDB: Created custom join path, adding to joinrel
WARNING:  ParadeDB: Join pathlist callback called - jointype: 0, outer relids: ["documents_join_test"], inner relids: ["files_join_test", "authors_join_test"]
WARNING:  ParadeDB: Outer side is base, inner is composite - checking if we can handle this
WARNING:  ParadeDB: Found BM25 index for relation documents_join_test (rti 1)
WARNING:  ParadeDB: Checked relations ["documents_join_test"] for BM25 indexes, found: true
WARNING:  ParadeDB: Composite join - inner is composite, checking outer for BM25: true
WARNING:  ParadeDB: Join feasibility check - outer has BM25: true, inner has BM25: false
WARNING:  ParadeDB: Analyzing join search predicates
WARNING:  ParadeDB: Found 1 join restriction clauses
WARNING:  ParadeDB: Analyzing join clause of type T_OpExpr
WARNING:  ParadeDB: Analyzing 1 base restriction clauses for relation
WARNING:  ParadeDB: Extracting predicates for relation documents_join_test (rti 1)
WARNING:  ParadeDB: Extracted search query for documents_join_test: uses_search_operator=true
WARNING:  ParadeDB: Extracted 1 outer predicates, 0 inner predicates, 0 join conditions
WARNING:  ParadeDB: Found search predicates - outer: 1, inner: 0, bilateral: false
WARNING:  ParadeDB: Join is feasible based on composite analysis: InnerComposite
WARNING:  ParadeDB: Outer predicate for documents_join_test - uses_search: true
WARNING:  ParadeDB: Unilateral search detected - proceeding with custom join path
WARNING:  ParadeDB: Storing join relation OIDs - outer: ["documents_join_test"], inner: ["files_join_test", "authors_join_test"]
WARNING:  ParadeDB: Storing composite join info - composite_side: Inner, base_has_search: true, composite_has_search: false
WARNING:  ParadeDB: Join path estimates - rows: 1, startup_cost: 100.00, total_cost: 100.01
WARNING:  ParadeDB: Created custom join path, adding to joinrel
WARNING:  ParadeDB: Planning custom join path with scanrelid = 0
WARNING:  ParadeDB: Join target list has 4 entries
WARNING:  ParadeDB: Mapped join variable varno=1, varattno=1 to 'join_attr_1'
WARNING:  ParadeDB: Mapped join variable varno=1, varattno=2 to 'join_attr_2'
WARNING:  ParadeDB: Mapped join variable varno=2, varattno=3 to 'join_attr_3'
WARNING:  ParadeDB: Mapped join variable varno=4, varattno=3 to 'join_attr_4'
WARNING:  ParadeDB: Set custom scan target list for join node
WARNING:  ParadeDB: Creating custom scan state for join node (scanrelid = 0)
WARNING:  ParadeDB: Extracted search predicates from private data - outer: 0, inner: 1, bilateral: false
WARNING:  ParadeDB: Stored outer relation OIDs: ["documents_join_test", "authors_join_test"]
WARNING:  ParadeDB: Stored inner relation OIDs: ["files_join_test"]
WARNING:  ParadeDB: Storing 4 variable mappings from planning phase
WARNING:  ParadeDB: Planning-time mapping: varno=1, attno=1 -> 'join_attr_1'
WARNING:  ParadeDB: Planning-time mapping: varno=1, attno=2 -> 'join_attr_2'
WARNING:  ParadeDB: Planning-time mapping: varno=2, attno=3 -> 'join_attr_3'
WARNING:  ParadeDB: Planning-time mapping: varno=4, attno=3 -> 'join_attr_4'
WARNING:  ParadeDB: Storing composite join info - composite_side: Outer, base_has_search: true, composite_has_search: false
WARNING:  ParadeDB: Beginning custom scan for join node
WARNING:  ParadeDB: Initializing join execution (simplified)
WARNING:  ParadeDB: Using stored search predicates - outer: 0, inner: 1, bilateral: false
WARNING:  ParadeDB: Join execution initialization complete
WARNING:  ParadeDB: Executing join step
WARNING:  ParadeDB: Starting join execution - initializing search
WARNING:  ParadeDB: Initializing search execution for join
WARNING:  ParadeDB: Retrieved search predicates from join state - outer: 0, inner: 1
WARNING:  ParadeDB: Initializing search readers for join relations
WARNING:  ParadeDB: Opening search reader for inner relation files_join_test
WARNING:  ParadeDB: Successfully opened search reader for files_join_test
WARNING:  ParadeDB: Initialized 1 search readers
WARNING:  ParadeDB: Executing real searches on join relations
WARNING:  ParadeDB: Executing search on inner relation files_join_test
WARNING:  ParadeDB: Executing real BM25 search on relation files_join_test
WARNING:  ParadeDB: Real search on files_join_test returned 3 results
WARNING:  ParadeDB: Found 3 results for inner relation files_join_test
WARNING:  ParadeDB: No outer search results, using default result
WARNING:  ParadeDB: Completed real search execution - outer: 1, inner: 3
WARNING:  ParadeDB: Executing join step
WARNING:  ParadeDB: Executing outer search
WARNING:  ParadeDB: Executing search on outer relation
WARNING:  ParadeDB: Outer search completed - 1 results
WARNING:  ParadeDB: Executing join step
WARNING:  ParadeDB: Executing inner search
WARNING:  ParadeDB: Executing search on inner relation
WARNING:  ParadeDB: Inner search completed - 3 results
WARNING:  ParadeDB: Executing join step
WARNING:  ParadeDB: Performing join matching
WARNING:  ParadeDB: Matching and returning next tuple with join condition evaluation
WARNING:  ParadeDB: Using stored relation OIDs from join state - outer: documents_join_test, inner: files_join_test
WARNING:  ParadeDB: Fetching column 'id' from relation documents_join_test with CTID 1
WARNING:  ParadeDB: Fetched column 'id' (attno 1) = Some("1")
WARNING:  ParadeDB: Fetching column 'document_id' from relation files_join_test with CTID 1
WARNING:  ParadeDB: Fetched column 'document_id' (attno 2) = Some("1")
WARNING:  ParadeDB: Join condition evaluation: 1 (documents_join_test.id) = 1 (files_join_test.document_id) -> true
WARNING:  ParadeDB: Evaluating join condition for outer[0] (ctid 1) × inner[0] (ctid 1) = true
WARNING:  ParadeDB: Join condition satisfied - creating result tuple for outer[0] × inner[0]
WARNING:  ParadeDB: Creating join result tuple for outer[0], inner[0]
WARNING:  ParadeDB: Creating result tuple with 4 attributes
WARNING:  ParadeDB: Using stored relation OIDs from join state - outer: documents_join_test, inner: files_join_test
WARNING:  ParadeDB: Fetching real heap tuple values from relations documents_join_test and files_join_test
WARNING:  ParadeDB: Using stored relation OIDs from join state - outer: documents_join_test, inner: files_join_test
WARNING:  ParadeDB: Detected relations from predicates - outer: 'documents_join_test', inner: 'files_join_test'
WARNING:  ParadeDB: Fetching all columns with names from relation documents_join_test with CTID 1
WARNING:  ParadeDB: documents_join_test column 'id' = '1'
WARNING:  ParadeDB: documents_join_test column 'title' = 'Document 1'
WARNING:  ParadeDB: documents_join_test column 'content' = 'This is the first document about technology'
WARNING:  ParadeDB: Successfully fetched 3 columns from documents_join_test relation
WARNING:  ParadeDB: Fetching all columns with names from relation files_join_test with CTID 1
WARNING:  ParadeDB: files_join_test column 'id' = '1'
WARNING:  ParadeDB: files_join_test column 'document_id' = '1'
WARNING:  ParadeDB: files_join_test column 'filename' = 'file1.txt'
WARNING:  ParadeDB: files_join_test column 'content' = 'Technology file content'
WARNING:  ParadeDB: Successfully fetched 4 columns from files_join_test relation
WARNING:  ParadeDB: Fetched 3 columns from outer relation, 4 from inner relation
WARNING:  ParadeDB: Analyzing 4 target entries using execution-time varno/attno mapping: [(1, Some((Ok("{VAR :varno -3 :varattno 1 :vartype 23 :vartypmod -1 :varcollid 0 :varnullingrels (b) :varlevelsup 0 :varnosyn 1 :varattnosyn 1 :location -1}"),))), (2, Some((Ok("{VAR :varno -3 :varattno 2 :vartype 25 :vartypmod -1 :varcollid 100 :varnullingrels (b) :varlevelsup 0 :varnosyn 1 :varattnosyn 2 :location -1}"),))), (3, Some((Ok("{VAR :varno -3 :varattno 3 :vartype 25 :vartypmod -1 :varcollid 100 :varnullingrels (b) :varlevelsup 0 :varnosyn 2 :varattnosyn 3 :location -1}"),))), (4, Some((Ok("{VAR :varno -3 :varattno 4 :vartype 25 :vartypmod -1 :varcollid 100 :varnullingrels (b) :varlevelsup 0 :varnosyn 4 :varattnosyn 3 :location -1}"),)))]
WARNING:  ParadeDB: Mapped varno 4294967293 to outer relation documents_join_test
WARNING:  ParadeDB: Built execution-time varno mapping with 1 entries: [(4294967293, "documents_join_test")]
WARNING:  ParadeDB: Analyzing target entry 1 (resno: 1)
WARNING:  ParadeDB: Found Var in target entry 1 - varno: -3, attno: 1, varnosyn: 1, varattnosyn: 1
WARNING:  ParadeDB: Variable references INDEX/intermediate result, using varnosyn: 1, varattnosyn: 1
WARNING:  ParadeDB: Mapping original variable varnosyn: 1, varattnosyn: 1 to relation
WARNING:  ParadeDB: Using stored relation OIDs from join state - outer: documents_join_test, inner: files_join_test
WARNING:  ParadeDB: Resolved varnosyn 1 to relation documents_join_test
WARNING:  ParadeDB: varnosyn 1 resolved to relation documents_join_test, attno 1
WARNING:  ParadeDB: Relation documents_join_test attno 1 -> column name 'id'
WARNING:  ParadeDB: Target entry 1 mapped to: RelationColumn(documents_join_test,id)
WARNING:  ParadeDB: Analyzing target entry 2 (resno: 2)
WARNING:  ParadeDB: Found Var in target entry 2 - varno: -3, attno: 2, varnosyn: 1, varattnosyn: 2
WARNING:  ParadeDB: Variable references INDEX/intermediate result, using varnosyn: 1, varattnosyn: 2
WARNING:  ParadeDB: Mapping original variable varnosyn: 1, varattnosyn: 2 to relation
WARNING:  ParadeDB: Using stored relation OIDs from join state - outer: documents_join_test, inner: files_join_test
WARNING:  ParadeDB: Resolved varnosyn 1 to relation documents_join_test
WARNING:  ParadeDB: varnosyn 1 resolved to relation documents_join_test, attno 2
WARNING:  ParadeDB: Relation documents_join_test attno 2 -> column name 'title'
WARNING:  ParadeDB: Target entry 2 mapped to: RelationColumn(documents_join_test,title)
WARNING:  ParadeDB: Analyzing target entry 3 (resno: 3)
WARNING:  ParadeDB: Found Var in target entry 3 - varno: -3, attno: 3, varnosyn: 2, varattnosyn: 3
WARNING:  ParadeDB: Variable references INDEX/intermediate result, using varnosyn: 2, varattnosyn: 3
WARNING:  ParadeDB: Mapping original variable varnosyn: 2, varattnosyn: 3 to relation
WARNING:  ParadeDB: Using stored relation OIDs from join state - outer: documents_join_test, inner: files_join_test
WARNING:  ParadeDB: Resolved varnosyn 2 to relation files_join_test
WARNING:  ParadeDB: varnosyn 2 resolved to relation files_join_test, attno 3
WARNING:  ParadeDB: Relation files_join_test attno 3 -> column name 'filename'
WARNING:  ParadeDB: Target entry 3 mapped to: RelationColumn(files_join_test,filename)
WARNING:  ParadeDB: Analyzing target entry 4 (resno: 4)
WARNING:  ParadeDB: Found Var in target entry 4 - varno: -3, attno: 4, varnosyn: 4, varattnosyn: 3
WARNING:  ParadeDB: Variable references INDEX/intermediate result, using varnosyn: 4, varattnosyn: 3
WARNING:  ParadeDB: Mapping original variable varnosyn: 4, varattnosyn: 3 to relation
WARNING:  ParadeDB: Using stored relation OIDs from join state - outer: documents_join_test, inner: files_join_test
WARNING:  ParadeDB: Resolved varnosyn 4 to relation authors_join_test
WARNING:  ParadeDB: varnosyn 4 resolved to relation authors_join_test, attno 3
WARNING:  ParadeDB: Relation authors_join_test attno 3 -> column name 'author_name'
WARNING:  ParadeDB: Target entry 4 mapped to: RelationColumn(authors_join_test,author_name)
WARNING:  ParadeDB: Fetching from third relation 118085 (authors_join_test), column 'author_name'
WARNING:  ParadeDB: Fetching column 'author_name' from relation authors_join_test with CTID 1
WARNING:  ParadeDB: Fetched column 'author_name' (attno 3) = Some("John Smith")
WARNING:  ParadeDB: Mapped 4 out of 4 column values: [Some("1"), Some("Document 1"), Some("file1.txt"), Some("John Smith")]
WARNING:  ParadeDB: Converting '1' to integer 1
WARNING:  ParadeDB: Created join result tuple with real heap data: [Some("1"), Some("Document 1"), Some("file1.txt"), Some("John Smith")]
WARNING:  ParadeDB: Executing join step
WARNING:  ParadeDB: Performing join matching
WARNING:  ParadeDB: Matching and returning next tuple with join condition evaluation
WARNING:  ParadeDB: Using stored relation OIDs from join state - outer: documents_join_test, inner: files_join_test
WARNING:  ParadeDB: Fetching column 'id' from relation documents_join_test with CTID 1
WARNING:  ParadeDB: Fetched column 'id' (attno 1) = Some("1")
WARNING:  ParadeDB: Fetching column 'document_id' from relation files_join_test with CTID 2
WARNING:  ParadeDB: Fetched column 'document_id' (attno 2) = Some("2")
WARNING:  ParadeDB: Join condition evaluation: 1 (documents_join_test.id) = 2 (files_join_test.document_id) -> false
WARNING:  ParadeDB: Evaluating join condition for outer[0] (ctid 1) × inner[1] (ctid 2) = false
WARNING:  ParadeDB: Join condition not satisfied - advancing to next combination
WARNING:  ParadeDB: Using stored relation OIDs from join state - outer: documents_join_test, inner: files_join_test
WARNING:  ParadeDB: Fetching column 'id' from relation documents_join_test with CTID 1
WARNING:  ParadeDB: Fetched column 'id' (attno 1) = Some("1")
WARNING:  ParadeDB: Fetching column 'document_id' from relation files_join_test with CTID 3
WARNING:  ParadeDB: Fetched column 'document_id' (attno 2) = Some("3")
WARNING:  ParadeDB: Join condition evaluation: 1 (documents_join_test.id) = 3 (files_join_test.document_id) -> false
WARNING:  ParadeDB: Evaluating join condition for outer[0] (ctid 1) × inner[2] (ctid 3) = false
WARNING:  ParadeDB: Join condition not satisfied - advancing to next combination
WARNING:  ParadeDB: Join matching complete - total matches: 1
WARNING:  ParadeDB: Cleaning up join execution
WARNING:  ParadeDB: Cleaning up join execution state
WARNING:  ParadeDB: ===== JOIN EXECUTION STATISTICS =====
WARNING:  ParadeDB: Search Results - Outer: 1, Inner: 3, Total Combinations: 3
WARNING:  ParadeDB: Join Processing - Matches: 1, Returned: 1, Success Rate: 33.3%
WARNING:  ParadeDB: Heap Tuple Access - Attempts: 2, Successes: 4, Success Rate: 200.0%
WARNING:  ParadeDB: Cleaned up 1 search readers
WARNING:  ParadeDB: Cleared 1 outer and 3 inner search results
WARNING:  ParadeDB: ===== END JOIN EXECUTION STATISTICS =====
WARNING:  ParadeDB: Join execution cleanup complete
 id |   title    | filename  | author_name 
----+------------+-----------+-------------
  1 | Document 1 | file1.txt | John Smith
(1 row)

-- Test 5: 3-way join with trilateral search (all three tables)
SELECT d.id, d.title, f.filename, a.author_name
FROM documents_join_test d
JOIN files_join_test f ON d.id = f.document_id
JOIN authors_join_test a ON d.id = a.document_id
WHERE d.content @@@ 'science' AND f.content @@@ 'file' AND a.bio @@@ 'research';
WARNING:  ParadeDB: Join pathlist callback called - jointype: 0, outer relids: ["documents_join_test"], inner relids: ["files_join_test"]
WARNING:  ParadeDB: Both sides are base relations - proceeding with standard join
WARNING:  ParadeDB: Found BM25 index for relation documents_join_test (rti 1)
WARNING:  ParadeDB: Checked relations ["documents_join_test"] for BM25 indexes, found: true
WARNING:  ParadeDB: Found BM25 index for relation files_join_test (rti 2)
WARNING:  ParadeDB: Checked relations ["files_join_test"] for BM25 indexes, found: true
WARNING:  ParadeDB: Join feasibility check - outer has BM25: true, inner has BM25: true
WARNING:  ParadeDB: Analyzing join search predicates
WARNING:  ParadeDB: Found 1 join restriction clauses
WARNING:  ParadeDB: Analyzing join clause of type T_OpExpr
WARNING:  ParadeDB: Analyzing 1 base restriction clauses for relation
WARNING:  ParadeDB: Extracting predicates for relation documents_join_test (rti 1)
WARNING:  ParadeDB: Extracted search query for documents_join_test: uses_search_operator=true
WARNING:  ParadeDB: Analyzing 1 base restriction clauses for relation
WARNING:  ParadeDB: Extracting predicates for relation files_join_test (rti 2)
WARNING:  ParadeDB: Extracted search query for files_join_test: uses_search_operator=true
WARNING:  ParadeDB: Extracted 1 outer predicates, 1 inner predicates, 0 join conditions
WARNING:  ParadeDB: Found search predicates - outer: 1, inner: 1, bilateral: true
WARNING:  ParadeDB: Join is feasible based on composite analysis: BothBaseRelations
WARNING:  ParadeDB: Outer predicate for documents_join_test - uses_search: true
WARNING:  ParadeDB: Inner predicate for files_join_test - uses_search: true
WARNING:  ParadeDB: Bilateral search detected - proceeding with custom join path
WARNING:  ParadeDB: Storing join relation OIDs - outer: ["documents_join_test"], inner: ["files_join_test"]
WARNING:  ParadeDB: Join path estimates - rows: 1, startup_cost: 100.00, total_cost: 100.01
WARNING:  ParadeDB: Created custom join path, adding to joinrel
WARNING:  ParadeDB: Join pathlist callback called - jointype: 0, outer relids: ["files_join_test"], inner relids: ["documents_join_test"]
WARNING:  ParadeDB: Both sides are base relations - proceeding with standard join
WARNING:  ParadeDB: Found BM25 index for relation files_join_test (rti 2)
WARNING:  ParadeDB: Checked relations ["files_join_test"] for BM25 indexes, found: true
WARNING:  ParadeDB: Found BM25 index for relation documents_join_test (rti 1)
WARNING:  ParadeDB: Checked relations ["documents_join_test"] for BM25 indexes, found: true
WARNING:  ParadeDB: Join feasibility check - outer has BM25: true, inner has BM25: true
WARNING:  ParadeDB: Analyzing join search predicates
WARNING:  ParadeDB: Found 1 join restriction clauses
WARNING:  ParadeDB: Analyzing join clause of type T_OpExpr
WARNING:  ParadeDB: Analyzing 1 base restriction clauses for relation
WARNING:  ParadeDB: Extracting predicates for relation files_join_test (rti 2)
WARNING:  ParadeDB: Extracted search query for files_join_test: uses_search_operator=true
WARNING:  ParadeDB: Analyzing 1 base restriction clauses for relation
WARNING:  ParadeDB: Extracting predicates for relation documents_join_test (rti 1)
WARNING:  ParadeDB: Extracted search query for documents_join_test: uses_search_operator=true
WARNING:  ParadeDB: Extracted 1 outer predicates, 1 inner predicates, 0 join conditions
WARNING:  ParadeDB: Found search predicates - outer: 1, inner: 1, bilateral: true
WARNING:  ParadeDB: Join is feasible based on composite analysis: BothBaseRelations
WARNING:  ParadeDB: Outer predicate for files_join_test - uses_search: true
WARNING:  ParadeDB: Inner predicate for documents_join_test - uses_search: true
WARNING:  ParadeDB: Bilateral search detected - proceeding with custom join path
WARNING:  ParadeDB: Storing join relation OIDs - outer: ["files_join_test"], inner: ["documents_join_test"]
WARNING:  ParadeDB: Join path estimates - rows: 1, startup_cost: 100.00, total_cost: 100.01
WARNING:  ParadeDB: Created custom join path, adding to joinrel
WARNING:  ParadeDB: Join pathlist callback called - jointype: 0, outer relids: ["documents_join_test"], inner relids: ["authors_join_test"]
WARNING:  ParadeDB: Both sides are base relations - proceeding with standard join
WARNING:  ParadeDB: Found BM25 index for relation documents_join_test (rti 1)
WARNING:  ParadeDB: Checked relations ["documents_join_test"] for BM25 indexes, found: true
WARNING:  ParadeDB: Found BM25 index for relation authors_join_test (rti 4)
WARNING:  ParadeDB: Checked relations ["authors_join_test"] for BM25 indexes, found: true
WARNING:  ParadeDB: Join feasibility check - outer has BM25: true, inner has BM25: true
WARNING:  ParadeDB: Analyzing join search predicates
WARNING:  ParadeDB: Found 1 join restriction clauses
WARNING:  ParadeDB: Analyzing join clause of type T_OpExpr
WARNING:  ParadeDB: Analyzing 1 base restriction clauses for relation
WARNING:  ParadeDB: Extracting predicates for relation documents_join_test (rti 1)
WARNING:  ParadeDB: Extracted search query for documents_join_test: uses_search_operator=true
WARNING:  ParadeDB: Analyzing 1 base restriction clauses for relation
WARNING:  ParadeDB: Extracting predicates for relation authors_join_test (rti 4)
WARNING:  ParadeDB: Extracted search query for authors_join_test: uses_search_operator=true
WARNING:  ParadeDB: Extracted 1 outer predicates, 1 inner predicates, 0 join conditions
WARNING:  ParadeDB: Found search predicates - outer: 1, inner: 1, bilateral: true
WARNING:  ParadeDB: Join is feasible based on composite analysis: BothBaseRelations
WARNING:  ParadeDB: Outer predicate for documents_join_test - uses_search: true
WARNING:  ParadeDB: Inner predicate for authors_join_test - uses_search: true
WARNING:  ParadeDB: Bilateral search detected - proceeding with custom join path
WARNING:  ParadeDB: Storing join relation OIDs - outer: ["documents_join_test"], inner: ["authors_join_test"]
WARNING:  ParadeDB: Join path estimates - rows: 1, startup_cost: 100.00, total_cost: 100.01
WARNING:  ParadeDB: Created custom join path, adding to joinrel
WARNING:  ParadeDB: Join pathlist callback called - jointype: 0, outer relids: ["authors_join_test"], inner relids: ["documents_join_test"]
WARNING:  ParadeDB: Both sides are base relations - proceeding with standard join
WARNING:  ParadeDB: Found BM25 index for relation authors_join_test (rti 4)
WARNING:  ParadeDB: Checked relations ["authors_join_test"] for BM25 indexes, found: true
WARNING:  ParadeDB: Found BM25 index for relation documents_join_test (rti 1)
WARNING:  ParadeDB: Checked relations ["documents_join_test"] for BM25 indexes, found: true
WARNING:  ParadeDB: Join feasibility check - outer has BM25: true, inner has BM25: true
WARNING:  ParadeDB: Analyzing join search predicates
WARNING:  ParadeDB: Found 1 join restriction clauses
WARNING:  ParadeDB: Analyzing join clause of type T_OpExpr
WARNING:  ParadeDB: Analyzing 1 base restriction clauses for relation
WARNING:  ParadeDB: Extracting predicates for relation authors_join_test (rti 4)
WARNING:  ParadeDB: Extracted search query for authors_join_test: uses_search_operator=true
WARNING:  ParadeDB: Analyzing 1 base restriction clauses for relation
WARNING:  ParadeDB: Extracting predicates for relation documents_join_test (rti 1)
WARNING:  ParadeDB: Extracted search query for documents_join_test: uses_search_operator=true
WARNING:  ParadeDB: Extracted 1 outer predicates, 1 inner predicates, 0 join conditions
WARNING:  ParadeDB: Found search predicates - outer: 1, inner: 1, bilateral: true
WARNING:  ParadeDB: Join is feasible based on composite analysis: BothBaseRelations
WARNING:  ParadeDB: Outer predicate for authors_join_test - uses_search: true
WARNING:  ParadeDB: Inner predicate for documents_join_test - uses_search: true
WARNING:  ParadeDB: Bilateral search detected - proceeding with custom join path
WARNING:  ParadeDB: Storing join relation OIDs - outer: ["authors_join_test"], inner: ["documents_join_test"]
WARNING:  ParadeDB: Join path estimates - rows: 1, startup_cost: 100.00, total_cost: 100.01
WARNING:  ParadeDB: Created custom join path, adding to joinrel
WARNING:  ParadeDB: Join pathlist callback called - jointype: 0, outer relids: ["files_join_test"], inner relids: ["authors_join_test"]
WARNING:  ParadeDB: Both sides are base relations - proceeding with standard join
WARNING:  ParadeDB: Found BM25 index for relation files_join_test (rti 2)
WARNING:  ParadeDB: Checked relations ["files_join_test"] for BM25 indexes, found: true
WARNING:  ParadeDB: Found BM25 index for relation authors_join_test (rti 4)
WARNING:  ParadeDB: Checked relations ["authors_join_test"] for BM25 indexes, found: true
WARNING:  ParadeDB: Join feasibility check - outer has BM25: true, inner has BM25: true
WARNING:  ParadeDB: Analyzing join search predicates
WARNING:  ParadeDB: Found 1 join restriction clauses
WARNING:  ParadeDB: Analyzing join clause of type T_OpExpr
WARNING:  ParadeDB: Analyzing 1 base restriction clauses for relation
WARNING:  ParadeDB: Extracting predicates for relation files_join_test (rti 2)
WARNING:  ParadeDB: Extracted search query for files_join_test: uses_search_operator=true
WARNING:  ParadeDB: Analyzing 1 base restriction clauses for relation
WARNING:  ParadeDB: Extracting predicates for relation authors_join_test (rti 4)
WARNING:  ParadeDB: Extracted search query for authors_join_test: uses_search_operator=true
WARNING:  ParadeDB: Extracted 1 outer predicates, 1 inner predicates, 0 join conditions
WARNING:  ParadeDB: Found search predicates - outer: 1, inner: 1, bilateral: true
WARNING:  ParadeDB: Join is feasible based on composite analysis: BothBaseRelations
WARNING:  ParadeDB: Outer predicate for files_join_test - uses_search: true
WARNING:  ParadeDB: Inner predicate for authors_join_test - uses_search: true
WARNING:  ParadeDB: Bilateral search detected - proceeding with custom join path
WARNING:  ParadeDB: Storing join relation OIDs - outer: ["files_join_test"], inner: ["authors_join_test"]
WARNING:  ParadeDB: Join path estimates - rows: 1, startup_cost: 100.00, total_cost: 100.01
WARNING:  ParadeDB: Created custom join path, adding to joinrel
WARNING:  ParadeDB: Join pathlist callback called - jointype: 0, outer relids: ["authors_join_test"], inner relids: ["files_join_test"]
WARNING:  ParadeDB: Both sides are base relations - proceeding with standard join
WARNING:  ParadeDB: Found BM25 index for relation authors_join_test (rti 4)
WARNING:  ParadeDB: Checked relations ["authors_join_test"] for BM25 indexes, found: true
WARNING:  ParadeDB: Found BM25 index for relation files_join_test (rti 2)
WARNING:  ParadeDB: Checked relations ["files_join_test"] for BM25 indexes, found: true
WARNING:  ParadeDB: Join feasibility check - outer has BM25: true, inner has BM25: true
WARNING:  ParadeDB: Analyzing join search predicates
WARNING:  ParadeDB: Found 1 join restriction clauses
WARNING:  ParadeDB: Analyzing join clause of type T_OpExpr
WARNING:  ParadeDB: Analyzing 1 base restriction clauses for relation
WARNING:  ParadeDB: Extracting predicates for relation authors_join_test (rti 4)
WARNING:  ParadeDB: Extracted search query for authors_join_test: uses_search_operator=true
WARNING:  ParadeDB: Analyzing 1 base restriction clauses for relation
WARNING:  ParadeDB: Extracting predicates for relation files_join_test (rti 2)
WARNING:  ParadeDB: Extracted search query for files_join_test: uses_search_operator=true
WARNING:  ParadeDB: Extracted 1 outer predicates, 1 inner predicates, 0 join conditions
WARNING:  ParadeDB: Found search predicates - outer: 1, inner: 1, bilateral: true
WARNING:  ParadeDB: Join is feasible based on composite analysis: BothBaseRelations
WARNING:  ParadeDB: Outer predicate for authors_join_test - uses_search: true
WARNING:  ParadeDB: Inner predicate for files_join_test - uses_search: true
WARNING:  ParadeDB: Bilateral search detected - proceeding with custom join path
WARNING:  ParadeDB: Storing join relation OIDs - outer: ["authors_join_test"], inner: ["files_join_test"]
WARNING:  ParadeDB: Join path estimates - rows: 1, startup_cost: 100.00, total_cost: 100.01
WARNING:  ParadeDB: Created custom join path, adding to joinrel
WARNING:  ParadeDB: Join pathlist callback called - jointype: 0, outer relids: ["documents_join_test", "files_join_test"], inner relids: ["authors_join_test"]
WARNING:  ParadeDB: Outer side is composite, inner is base - checking if we can handle this
WARNING:  ParadeDB: Found BM25 index for relation authors_join_test (rti 4)
WARNING:  ParadeDB: Checked relations ["authors_join_test"] for BM25 indexes, found: true
WARNING:  ParadeDB: Composite join - outer is composite, checking inner for BM25: true
WARNING:  ParadeDB: Join feasibility check - outer has BM25: false, inner has BM25: true
WARNING:  ParadeDB: Analyzing join search predicates
WARNING:  ParadeDB: Found 1 join restriction clauses
WARNING:  ParadeDB: Analyzing join clause of type T_OpExpr
WARNING:  ParadeDB: Analyzing 1 base restriction clauses for relation
WARNING:  ParadeDB: Extracting predicates for relation authors_join_test (rti 4)
WARNING:  ParadeDB: Extracted search query for authors_join_test: uses_search_operator=true
WARNING:  ParadeDB: Extracted 0 outer predicates, 1 inner predicates, 0 join conditions
WARNING:  ParadeDB: Found search predicates - outer: 0, inner: 1, bilateral: false
WARNING:  ParadeDB: Join is feasible based on composite analysis: OuterComposite
WARNING:  ParadeDB: Inner predicate for authors_join_test - uses_search: true
WARNING:  ParadeDB: Unilateral search detected - proceeding with custom join path
WARNING:  ParadeDB: Storing join relation OIDs - outer: ["documents_join_test", "files_join_test"], inner: ["authors_join_test"]
WARNING:  ParadeDB: Storing composite join info - composite_side: Outer, base_has_search: true, composite_has_search: false
WARNING:  ParadeDB: Join path estimates - rows: 1, startup_cost: 100.00, total_cost: 100.01
WARNING:  ParadeDB: Created custom join path, adding to joinrel
WARNING:  ParadeDB: Join pathlist callback called - jointype: 0, outer relids: ["authors_join_test"], inner relids: ["documents_join_test", "files_join_test"]
WARNING:  ParadeDB: Outer side is base, inner is composite - checking if we can handle this
WARNING:  ParadeDB: Found BM25 index for relation authors_join_test (rti 4)
WARNING:  ParadeDB: Checked relations ["authors_join_test"] for BM25 indexes, found: true
WARNING:  ParadeDB: Composite join - inner is composite, checking outer for BM25: true
WARNING:  ParadeDB: Join feasibility check - outer has BM25: true, inner has BM25: false
WARNING:  ParadeDB: Analyzing join search predicates
WARNING:  ParadeDB: Found 1 join restriction clauses
WARNING:  ParadeDB: Analyzing join clause of type T_OpExpr
WARNING:  ParadeDB: Analyzing 1 base restriction clauses for relation
WARNING:  ParadeDB: Extracting predicates for relation authors_join_test (rti 4)
WARNING:  ParadeDB: Extracted search query for authors_join_test: uses_search_operator=true
WARNING:  ParadeDB: Extracted 1 outer predicates, 0 inner predicates, 0 join conditions
WARNING:  ParadeDB: Found search predicates - outer: 1, inner: 0, bilateral: false
WARNING:  ParadeDB: Join is feasible based on composite analysis: InnerComposite
WARNING:  ParadeDB: Outer predicate for authors_join_test - uses_search: true
WARNING:  ParadeDB: Unilateral search detected - proceeding with custom join path
WARNING:  ParadeDB: Storing join relation OIDs - outer: ["authors_join_test"], inner: ["documents_join_test", "files_join_test"]
WARNING:  ParadeDB: Storing composite join info - composite_side: Inner, base_has_search: true, composite_has_search: false
WARNING:  ParadeDB: Join path estimates - rows: 1, startup_cost: 100.00, total_cost: 100.01
WARNING:  ParadeDB: Created custom join path, adding to joinrel
WARNING:  ParadeDB: Join pathlist callback called - jointype: 0, outer relids: ["documents_join_test", "authors_join_test"], inner relids: ["files_join_test"]
WARNING:  ParadeDB: Outer side is composite, inner is base - checking if we can handle this
WARNING:  ParadeDB: Found BM25 index for relation files_join_test (rti 2)
WARNING:  ParadeDB: Checked relations ["files_join_test"] for BM25 indexes, found: true
WARNING:  ParadeDB: Composite join - outer is composite, checking inner for BM25: true
WARNING:  ParadeDB: Join feasibility check - outer has BM25: false, inner has BM25: true
WARNING:  ParadeDB: Analyzing join search predicates
WARNING:  ParadeDB: Found 1 join restriction clauses
WARNING:  ParadeDB: Analyzing join clause of type T_OpExpr
WARNING:  ParadeDB: Analyzing 1 base restriction clauses for relation
WARNING:  ParadeDB: Extracting predicates for relation files_join_test (rti 2)
WARNING:  ParadeDB: Extracted search query for files_join_test: uses_search_operator=true
WARNING:  ParadeDB: Extracted 0 outer predicates, 1 inner predicates, 0 join conditions
WARNING:  ParadeDB: Found search predicates - outer: 0, inner: 1, bilateral: false
WARNING:  ParadeDB: Join is feasible based on composite analysis: OuterComposite
WARNING:  ParadeDB: Inner predicate for files_join_test - uses_search: true
WARNING:  ParadeDB: Unilateral search detected - proceeding with custom join path
WARNING:  ParadeDB: Storing join relation OIDs - outer: ["documents_join_test", "authors_join_test"], inner: ["files_join_test"]
WARNING:  ParadeDB: Storing composite join info - composite_side: Outer, base_has_search: true, composite_has_search: false
WARNING:  ParadeDB: Join path estimates - rows: 1, startup_cost: 100.00, total_cost: 100.01
WARNING:  ParadeDB: Created custom join path, adding to joinrel
WARNING:  ParadeDB: Join pathlist callback called - jointype: 0, outer relids: ["files_join_test"], inner relids: ["documents_join_test", "authors_join_test"]
WARNING:  ParadeDB: Outer side is base, inner is composite - checking if we can handle this
WARNING:  ParadeDB: Found BM25 index for relation files_join_test (rti 2)
WARNING:  ParadeDB: Checked relations ["files_join_test"] for BM25 indexes, found: true
WARNING:  ParadeDB: Composite join - inner is composite, checking outer for BM25: true
WARNING:  ParadeDB: Join feasibility check - outer has BM25: true, inner has BM25: false
WARNING:  ParadeDB: Analyzing join search predicates
WARNING:  ParadeDB: Found 1 join restriction clauses
WARNING:  ParadeDB: Analyzing join clause of type T_OpExpr
WARNING:  ParadeDB: Analyzing 1 base restriction clauses for relation
WARNING:  ParadeDB: Extracting predicates for relation files_join_test (rti 2)
WARNING:  ParadeDB: Extracted search query for files_join_test: uses_search_operator=true
WARNING:  ParadeDB: Extracted 1 outer predicates, 0 inner predicates, 0 join conditions
WARNING:  ParadeDB: Found search predicates - outer: 1, inner: 0, bilateral: false
WARNING:  ParadeDB: Join is feasible based on composite analysis: InnerComposite
WARNING:  ParadeDB: Outer predicate for files_join_test - uses_search: true
WARNING:  ParadeDB: Unilateral search detected - proceeding with custom join path
WARNING:  ParadeDB: Storing join relation OIDs - outer: ["files_join_test"], inner: ["documents_join_test", "authors_join_test"]
WARNING:  ParadeDB: Storing composite join info - composite_side: Inner, base_has_search: true, composite_has_search: false
WARNING:  ParadeDB: Join path estimates - rows: 1, startup_cost: 100.00, total_cost: 100.01
WARNING:  ParadeDB: Created custom join path, adding to joinrel
WARNING:  ParadeDB: Join pathlist callback called - jointype: 0, outer relids: ["files_join_test", "authors_join_test"], inner relids: ["documents_join_test"]
WARNING:  ParadeDB: Outer side is composite, inner is base - checking if we can handle this
WARNING:  ParadeDB: Found BM25 index for relation documents_join_test (rti 1)
WARNING:  ParadeDB: Checked relations ["documents_join_test"] for BM25 indexes, found: true
WARNING:  ParadeDB: Composite join - outer is composite, checking inner for BM25: true
WARNING:  ParadeDB: Join feasibility check - outer has BM25: false, inner has BM25: true
WARNING:  ParadeDB: Analyzing join search predicates
WARNING:  ParadeDB: Found 1 join restriction clauses
WARNING:  ParadeDB: Analyzing join clause of type T_OpExpr
WARNING:  ParadeDB: Analyzing 1 base restriction clauses for relation
WARNING:  ParadeDB: Extracting predicates for relation documents_join_test (rti 1)
WARNING:  ParadeDB: Extracted search query for documents_join_test: uses_search_operator=true
WARNING:  ParadeDB: Extracted 0 outer predicates, 1 inner predicates, 0 join conditions
WARNING:  ParadeDB: Found search predicates - outer: 0, inner: 1, bilateral: false
WARNING:  ParadeDB: Join is feasible based on composite analysis: OuterComposite
WARNING:  ParadeDB: Inner predicate for documents_join_test - uses_search: true
WARNING:  ParadeDB: Unilateral search detected - proceeding with custom join path
WARNING:  ParadeDB: Storing join relation OIDs - outer: ["files_join_test", "authors_join_test"], inner: ["documents_join_test"]
WARNING:  ParadeDB: Storing composite join info - composite_side: Outer, base_has_search: true, composite_has_search: false
WARNING:  ParadeDB: Join path estimates - rows: 1, startup_cost: 100.00, total_cost: 100.01
WARNING:  ParadeDB: Created custom join path, adding to joinrel
WARNING:  ParadeDB: Join pathlist callback called - jointype: 0, outer relids: ["documents_join_test"], inner relids: ["files_join_test", "authors_join_test"]
WARNING:  ParadeDB: Outer side is base, inner is composite - checking if we can handle this
WARNING:  ParadeDB: Found BM25 index for relation documents_join_test (rti 1)
WARNING:  ParadeDB: Checked relations ["documents_join_test"] for BM25 indexes, found: true
WARNING:  ParadeDB: Composite join - inner is composite, checking outer for BM25: true
WARNING:  ParadeDB: Join feasibility check - outer has BM25: true, inner has BM25: false
WARNING:  ParadeDB: Analyzing join search predicates
WARNING:  ParadeDB: Found 1 join restriction clauses
WARNING:  ParadeDB: Analyzing join clause of type T_OpExpr
WARNING:  ParadeDB: Analyzing 1 base restriction clauses for relation
WARNING:  ParadeDB: Extracting predicates for relation documents_join_test (rti 1)
WARNING:  ParadeDB: Extracted search query for documents_join_test: uses_search_operator=true
WARNING:  ParadeDB: Extracted 1 outer predicates, 0 inner predicates, 0 join conditions
WARNING:  ParadeDB: Found search predicates - outer: 1, inner: 0, bilateral: false
WARNING:  ParadeDB: Join is feasible based on composite analysis: InnerComposite
WARNING:  ParadeDB: Outer predicate for documents_join_test - uses_search: true
WARNING:  ParadeDB: Unilateral search detected - proceeding with custom join path
WARNING:  ParadeDB: Storing join relation OIDs - outer: ["documents_join_test"], inner: ["files_join_test", "authors_join_test"]
WARNING:  ParadeDB: Storing composite join info - composite_side: Inner, base_has_search: true, composite_has_search: false
WARNING:  ParadeDB: Join path estimates - rows: 1, startup_cost: 100.00, total_cost: 100.01
WARNING:  ParadeDB: Created custom join path, adding to joinrel
WARNING:  ParadeDB: Planning custom join path with scanrelid = 0
WARNING:  ParadeDB: Join target list has 4 entries
WARNING:  ParadeDB: Mapped join variable varno=1, varattno=1 to 'join_attr_1'
WARNING:  ParadeDB: Mapped join variable varno=1, varattno=2 to 'join_attr_2'
WARNING:  ParadeDB: Mapped join variable varno=2, varattno=3 to 'join_attr_3'
WARNING:  ParadeDB: Mapped join variable varno=4, varattno=3 to 'join_attr_4'
WARNING:  ParadeDB: Set custom scan target list for join node
WARNING:  ParadeDB: Creating custom scan state for join node (scanrelid = 0)
WARNING:  ParadeDB: Extracted search predicates from private data - outer: 0, inner: 1, bilateral: false
WARNING:  ParadeDB: Stored outer relation OIDs: ["documents_join_test", "files_join_test"]
WARNING:  ParadeDB: Stored inner relation OIDs: ["authors_join_test"]
WARNING:  ParadeDB: Storing 4 variable mappings from planning phase
WARNING:  ParadeDB: Planning-time mapping: varno=1, attno=1 -> 'join_attr_1'
WARNING:  ParadeDB: Planning-time mapping: varno=1, attno=2 -> 'join_attr_2'
WARNING:  ParadeDB: Planning-time mapping: varno=2, attno=3 -> 'join_attr_3'
WARNING:  ParadeDB: Planning-time mapping: varno=4, attno=3 -> 'join_attr_4'
WARNING:  ParadeDB: Storing composite join info - composite_side: Outer, base_has_search: true, composite_has_search: false
WARNING:  ParadeDB: Beginning custom scan for join node
WARNING:  ParadeDB: Initializing join execution (simplified)
WARNING:  ParadeDB: Using stored search predicates - outer: 0, inner: 1, bilateral: false
WARNING:  ParadeDB: Join execution initialization complete
WARNING:  ParadeDB: Executing join step
WARNING:  ParadeDB: Starting join execution - initializing search
WARNING:  ParadeDB: Initializing search execution for join
WARNING:  ParadeDB: Retrieved search predicates from join state - outer: 0, inner: 1
WARNING:  ParadeDB: Initializing search readers for join relations
WARNING:  ParadeDB: Opening search reader for inner relation authors_join_test
WARNING:  ParadeDB: Successfully opened search reader for authors_join_test
WARNING:  ParadeDB: Initialized 1 search readers
WARNING:  ParadeDB: Executing real searches on join relations
WARNING:  ParadeDB: Executing search on inner relation authors_join_test
WARNING:  ParadeDB: Executing real BM25 search on relation authors_join_test
WARNING:  ParadeDB: Real search on authors_join_test returned 2 results
WARNING:  ParadeDB: Found 2 results for inner relation authors_join_test
WARNING:  ParadeDB: No outer search results, using default result
WARNING:  ParadeDB: Completed real search execution - outer: 1, inner: 2
WARNING:  ParadeDB: Executing join step
WARNING:  ParadeDB: Executing outer search
WARNING:  ParadeDB: Executing search on outer relation
WARNING:  ParadeDB: Outer search completed - 1 results
WARNING:  ParadeDB: Executing join step
WARNING:  ParadeDB: Executing inner search
WARNING:  ParadeDB: Executing search on inner relation
WARNING:  ParadeDB: Inner search completed - 2 results
WARNING:  ParadeDB: Executing join step
WARNING:  ParadeDB: Performing join matching
WARNING:  ParadeDB: Matching and returning next tuple with join condition evaluation
WARNING:  ParadeDB: Using stored relation OIDs from join state - outer: documents_join_test, inner: authors_join_test
WARNING:  ParadeDB: Fetching column 'id' from relation documents_join_test with CTID 1
WARNING:  ParadeDB: Fetched column 'id' (attno 1) = Some("1")
WARNING:  ParadeDB: Fetching column 'document_id' from relation authors_join_test with CTID 2
WARNING:  ParadeDB: Fetched column 'document_id' (attno 2) = Some("2")
WARNING:  ParadeDB: Join condition evaluation: 1 (documents_join_test.id) = 2 (authors_join_test.document_id) -> false
WARNING:  ParadeDB: Evaluating join condition for outer[0] (ctid 1) × inner[0] (ctid 2) = false
WARNING:  ParadeDB: Join condition not satisfied - advancing to next combination
WARNING:  ParadeDB: Using stored relation OIDs from join state - outer: documents_join_test, inner: authors_join_test
WARNING:  ParadeDB: Fetching column 'id' from relation documents_join_test with CTID 1
WARNING:  ParadeDB: Fetched column 'id' (attno 1) = Some("1")
WARNING:  ParadeDB: Fetching column 'document_id' from relation authors_join_test with CTID 3
WARNING:  ParadeDB: Fetched column 'document_id' (attno 2) = Some("3")
WARNING:  ParadeDB: Join condition evaluation: 1 (documents_join_test.id) = 3 (authors_join_test.document_id) -> false
WARNING:  ParadeDB: Evaluating join condition for outer[0] (ctid 1) × inner[1] (ctid 3) = false
WARNING:  ParadeDB: Join condition not satisfied - advancing to next combination
WARNING:  ParadeDB: Join matching complete - total matches: 0
WARNING:  ParadeDB: Cleaning up join execution
WARNING:  ParadeDB: Cleaning up join execution state
WARNING:  ParadeDB: ===== JOIN EXECUTION STATISTICS =====
WARNING:  ParadeDB: Search Results - Outer: 1, Inner: 2, Total Combinations: 2
WARNING:  ParadeDB: Join Processing - Matches: 0, Returned: 0, Success Rate: 0.0%
WARNING:  ParadeDB: Heap Tuple Access - Attempts: 0, Successes: 0, Success Rate: 0.0%
WARNING:  ParadeDB: Cleaned up 1 search readers
WARNING:  ParadeDB: Cleared 1 outer and 2 inner search results
WARNING:  ParadeDB: ===== END JOIN EXECUTION STATISTICS =====
WARNING:  ParadeDB: Join execution cleanup complete
 id | title | filename | author_name 
----+-------+----------+-------------
(0 rows)

-- Test 6: 3-way join with unilateral search (only documents)
SELECT d.id, d.title, f.filename, a.author_name
FROM documents_join_test d
JOIN files_join_test f ON d.id = f.document_id
JOIN authors_join_test a ON d.id = a.document_id
WHERE d.content @@@ 'research';
WARNING:  ParadeDB: Join pathlist callback called - jointype: 0, outer relids: ["documents_join_test"], inner relids: ["files_join_test"]
WARNING:  ParadeDB: Both sides are base relations - proceeding with standard join
WARNING:  ParadeDB: Found BM25 index for relation documents_join_test (rti 1)
WARNING:  ParadeDB: Checked relations ["documents_join_test"] for BM25 indexes, found: true
WARNING:  ParadeDB: Found BM25 index for relation files_join_test (rti 2)
WARNING:  ParadeDB: Checked relations ["files_join_test"] for BM25 indexes, found: true
WARNING:  ParadeDB: Join feasibility check - outer has BM25: true, inner has BM25: true
WARNING:  ParadeDB: Analyzing join search predicates
WARNING:  ParadeDB: Found 1 join restriction clauses
WARNING:  ParadeDB: Analyzing join clause of type T_OpExpr
WARNING:  ParadeDB: Analyzing 1 base restriction clauses for relation
WARNING:  ParadeDB: Extracting predicates for relation documents_join_test (rti 1)
WARNING:  ParadeDB: Extracted search query for documents_join_test: uses_search_operator=true
WARNING:  ParadeDB: Extracted 1 outer predicates, 0 inner predicates, 0 join conditions
WARNING:  ParadeDB: Found search predicates - outer: 1, inner: 0, bilateral: false
WARNING:  ParadeDB: Join is feasible based on composite analysis: BothBaseRelations
WARNING:  ParadeDB: Outer predicate for documents_join_test - uses_search: true
WARNING:  ParadeDB: Unilateral search detected - proceeding with custom join path
WARNING:  ParadeDB: Storing join relation OIDs - outer: ["documents_join_test"], inner: ["files_join_test"]
WARNING:  ParadeDB: Join path estimates - rows: 1, startup_cost: 100.00, total_cost: 100.01
WARNING:  ParadeDB: Created custom join path, adding to joinrel
WARNING:  ParadeDB: Join pathlist callback called - jointype: 0, outer relids: ["files_join_test"], inner relids: ["documents_join_test"]
WARNING:  ParadeDB: Both sides are base relations - proceeding with standard join
WARNING:  ParadeDB: Found BM25 index for relation files_join_test (rti 2)
WARNING:  ParadeDB: Checked relations ["files_join_test"] for BM25 indexes, found: true
WARNING:  ParadeDB: Found BM25 index for relation documents_join_test (rti 1)
WARNING:  ParadeDB: Checked relations ["documents_join_test"] for BM25 indexes, found: true
WARNING:  ParadeDB: Join feasibility check - outer has BM25: true, inner has BM25: true
WARNING:  ParadeDB: Analyzing join search predicates
WARNING:  ParadeDB: Found 1 join restriction clauses
WARNING:  ParadeDB: Analyzing join clause of type T_OpExpr
WARNING:  ParadeDB: Analyzing 1 base restriction clauses for relation
WARNING:  ParadeDB: Extracting predicates for relation documents_join_test (rti 1)
WARNING:  ParadeDB: Extracted search query for documents_join_test: uses_search_operator=true
WARNING:  ParadeDB: Extracted 0 outer predicates, 1 inner predicates, 0 join conditions
WARNING:  ParadeDB: Found search predicates - outer: 0, inner: 1, bilateral: false
WARNING:  ParadeDB: Join is feasible based on composite analysis: BothBaseRelations
WARNING:  ParadeDB: Inner predicate for documents_join_test - uses_search: true
WARNING:  ParadeDB: Unilateral search detected - proceeding with custom join path
WARNING:  ParadeDB: Storing join relation OIDs - outer: ["files_join_test"], inner: ["documents_join_test"]
WARNING:  ParadeDB: Join path estimates - rows: 1, startup_cost: 100.00, total_cost: 100.01
WARNING:  ParadeDB: Created custom join path, adding to joinrel
WARNING:  ParadeDB: Join pathlist callback called - jointype: 0, outer relids: ["documents_join_test"], inner relids: ["authors_join_test"]
WARNING:  ParadeDB: Both sides are base relations - proceeding with standard join
WARNING:  ParadeDB: Found BM25 index for relation documents_join_test (rti 1)
WARNING:  ParadeDB: Checked relations ["documents_join_test"] for BM25 indexes, found: true
WARNING:  ParadeDB: Found BM25 index for relation authors_join_test (rti 4)
WARNING:  ParadeDB: Checked relations ["authors_join_test"] for BM25 indexes, found: true
WARNING:  ParadeDB: Join feasibility check - outer has BM25: true, inner has BM25: true
WARNING:  ParadeDB: Analyzing join search predicates
WARNING:  ParadeDB: Found 1 join restriction clauses
WARNING:  ParadeDB: Analyzing join clause of type T_OpExpr
WARNING:  ParadeDB: Analyzing 1 base restriction clauses for relation
WARNING:  ParadeDB: Extracting predicates for relation documents_join_test (rti 1)
WARNING:  ParadeDB: Extracted search query for documents_join_test: uses_search_operator=true
WARNING:  ParadeDB: Extracted 1 outer predicates, 0 inner predicates, 0 join conditions
WARNING:  ParadeDB: Found search predicates - outer: 1, inner: 0, bilateral: false
WARNING:  ParadeDB: Join is feasible based on composite analysis: BothBaseRelations
WARNING:  ParadeDB: Outer predicate for documents_join_test - uses_search: true
WARNING:  ParadeDB: Unilateral search detected - proceeding with custom join path
WARNING:  ParadeDB: Storing join relation OIDs - outer: ["documents_join_test"], inner: ["authors_join_test"]
WARNING:  ParadeDB: Join path estimates - rows: 1, startup_cost: 100.00, total_cost: 100.01
WARNING:  ParadeDB: Created custom join path, adding to joinrel
WARNING:  ParadeDB: Join pathlist callback called - jointype: 0, outer relids: ["authors_join_test"], inner relids: ["documents_join_test"]
WARNING:  ParadeDB: Both sides are base relations - proceeding with standard join
WARNING:  ParadeDB: Found BM25 index for relation authors_join_test (rti 4)
WARNING:  ParadeDB: Checked relations ["authors_join_test"] for BM25 indexes, found: true
WARNING:  ParadeDB: Found BM25 index for relation documents_join_test (rti 1)
WARNING:  ParadeDB: Checked relations ["documents_join_test"] for BM25 indexes, found: true
WARNING:  ParadeDB: Join feasibility check - outer has BM25: true, inner has BM25: true
WARNING:  ParadeDB: Analyzing join search predicates
WARNING:  ParadeDB: Found 1 join restriction clauses
WARNING:  ParadeDB: Analyzing join clause of type T_OpExpr
WARNING:  ParadeDB: Analyzing 1 base restriction clauses for relation
WARNING:  ParadeDB: Extracting predicates for relation documents_join_test (rti 1)
WARNING:  ParadeDB: Extracted search query for documents_join_test: uses_search_operator=true
WARNING:  ParadeDB: Extracted 0 outer predicates, 1 inner predicates, 0 join conditions
WARNING:  ParadeDB: Found search predicates - outer: 0, inner: 1, bilateral: false
WARNING:  ParadeDB: Join is feasible based on composite analysis: BothBaseRelations
WARNING:  ParadeDB: Inner predicate for documents_join_test - uses_search: true
WARNING:  ParadeDB: Unilateral search detected - proceeding with custom join path
WARNING:  ParadeDB: Storing join relation OIDs - outer: ["authors_join_test"], inner: ["documents_join_test"]
WARNING:  ParadeDB: Join path estimates - rows: 1, startup_cost: 100.00, total_cost: 100.01
WARNING:  ParadeDB: Created custom join path, adding to joinrel
WARNING:  ParadeDB: Join pathlist callback called - jointype: 0, outer relids: ["files_join_test"], inner relids: ["authors_join_test"]
WARNING:  ParadeDB: Both sides are base relations - proceeding with standard join
WARNING:  ParadeDB: Found BM25 index for relation files_join_test (rti 2)
WARNING:  ParadeDB: Checked relations ["files_join_test"] for BM25 indexes, found: true
WARNING:  ParadeDB: Found BM25 index for relation authors_join_test (rti 4)
WARNING:  ParadeDB: Checked relations ["authors_join_test"] for BM25 indexes, found: true
WARNING:  ParadeDB: Join feasibility check - outer has BM25: true, inner has BM25: true
WARNING:  ParadeDB: Analyzing join search predicates
WARNING:  ParadeDB: Found 1 join restriction clauses
WARNING:  ParadeDB: Analyzing join clause of type T_OpExpr
WARNING:  ParadeDB: Extracted 0 outer predicates, 0 inner predicates, 0 join conditions
WARNING:  ParadeDB: No search predicates found in join - skipping custom join
WARNING:  ParadeDB: Join pathlist callback called - jointype: 0, outer relids: ["authors_join_test"], inner relids: ["files_join_test"]
WARNING:  ParadeDB: Both sides are base relations - proceeding with standard join
WARNING:  ParadeDB: Found BM25 index for relation authors_join_test (rti 4)
WARNING:  ParadeDB: Checked relations ["authors_join_test"] for BM25 indexes, found: true
WARNING:  ParadeDB: Found BM25 index for relation files_join_test (rti 2)
WARNING:  ParadeDB: Checked relations ["files_join_test"] for BM25 indexes, found: true
WARNING:  ParadeDB: Join feasibility check - outer has BM25: true, inner has BM25: true
WARNING:  ParadeDB: Analyzing join search predicates
WARNING:  ParadeDB: Found 1 join restriction clauses
WARNING:  ParadeDB: Analyzing join clause of type T_OpExpr
WARNING:  ParadeDB: Extracted 0 outer predicates, 0 inner predicates, 0 join conditions
WARNING:  ParadeDB: No search predicates found in join - skipping custom join
WARNING:  ParadeDB: Join pathlist callback called - jointype: 0, outer relids: ["documents_join_test", "files_join_test"], inner relids: ["authors_join_test"]
WARNING:  ParadeDB: Outer side is composite, inner is base - checking if we can handle this
WARNING:  ParadeDB: Found BM25 index for relation authors_join_test (rti 4)
WARNING:  ParadeDB: Checked relations ["authors_join_test"] for BM25 indexes, found: true
WARNING:  ParadeDB: Composite join - outer is composite, checking inner for BM25: true
WARNING:  ParadeDB: Join feasibility check - outer has BM25: false, inner has BM25: true
WARNING:  ParadeDB: Analyzing join search predicates
WARNING:  ParadeDB: Found 1 join restriction clauses
WARNING:  ParadeDB: Analyzing join clause of type T_OpExpr
WARNING:  ParadeDB: Extracted 0 outer predicates, 0 inner predicates, 0 join conditions
WARNING:  ParadeDB: No search predicates found in join - skipping custom join
WARNING:  ParadeDB: Join pathlist callback called - jointype: 0, outer relids: ["authors_join_test"], inner relids: ["documents_join_test", "files_join_test"]
WARNING:  ParadeDB: Outer side is base, inner is composite - checking if we can handle this
WARNING:  ParadeDB: Found BM25 index for relation authors_join_test (rti 4)
WARNING:  ParadeDB: Checked relations ["authors_join_test"] for BM25 indexes, found: true
WARNING:  ParadeDB: Composite join - inner is composite, checking outer for BM25: true
WARNING:  ParadeDB: Join feasibility check - outer has BM25: true, inner has BM25: false
WARNING:  ParadeDB: Analyzing join search predicates
WARNING:  ParadeDB: Found 1 join restriction clauses
WARNING:  ParadeDB: Analyzing join clause of type T_OpExpr
WARNING:  ParadeDB: Extracted 0 outer predicates, 0 inner predicates, 0 join conditions
WARNING:  ParadeDB: No search predicates found in join - skipping custom join
WARNING:  ParadeDB: Join pathlist callback called - jointype: 0, outer relids: ["documents_join_test", "authors_join_test"], inner relids: ["files_join_test"]
WARNING:  ParadeDB: Outer side is composite, inner is base - checking if we can handle this
WARNING:  ParadeDB: Found BM25 index for relation files_join_test (rti 2)
WARNING:  ParadeDB: Checked relations ["files_join_test"] for BM25 indexes, found: true
WARNING:  ParadeDB: Composite join - outer is composite, checking inner for BM25: true
WARNING:  ParadeDB: Join feasibility check - outer has BM25: false, inner has BM25: true
WARNING:  ParadeDB: Analyzing join search predicates
WARNING:  ParadeDB: Found 1 join restriction clauses
WARNING:  ParadeDB: Analyzing join clause of type T_OpExpr
WARNING:  ParadeDB: Extracted 0 outer predicates, 0 inner predicates, 0 join conditions
WARNING:  ParadeDB: No search predicates found in join - skipping custom join
WARNING:  ParadeDB: Join pathlist callback called - jointype: 0, outer relids: ["files_join_test"], inner relids: ["documents_join_test", "authors_join_test"]
WARNING:  ParadeDB: Outer side is base, inner is composite - checking if we can handle this
WARNING:  ParadeDB: Found BM25 index for relation files_join_test (rti 2)
WARNING:  ParadeDB: Checked relations ["files_join_test"] for BM25 indexes, found: true
WARNING:  ParadeDB: Composite join - inner is composite, checking outer for BM25: true
WARNING:  ParadeDB: Join feasibility check - outer has BM25: true, inner has BM25: false
WARNING:  ParadeDB: Analyzing join search predicates
WARNING:  ParadeDB: Found 1 join restriction clauses
WARNING:  ParadeDB: Analyzing join clause of type T_OpExpr
WARNING:  ParadeDB: Extracted 0 outer predicates, 0 inner predicates, 0 join conditions
WARNING:  ParadeDB: No search predicates found in join - skipping custom join
WARNING:  ParadeDB: Join pathlist callback called - jointype: 0, outer relids: ["files_join_test", "authors_join_test"], inner relids: ["documents_join_test"]
WARNING:  ParadeDB: Outer side is composite, inner is base - checking if we can handle this
WARNING:  ParadeDB: Found BM25 index for relation documents_join_test (rti 1)
WARNING:  ParadeDB: Checked relations ["documents_join_test"] for BM25 indexes, found: true
WARNING:  ParadeDB: Composite join - outer is composite, checking inner for BM25: true
WARNING:  ParadeDB: Join feasibility check - outer has BM25: false, inner has BM25: true
WARNING:  ParadeDB: Analyzing join search predicates
WARNING:  ParadeDB: Found 1 join restriction clauses
WARNING:  ParadeDB: Analyzing join clause of type T_OpExpr
WARNING:  ParadeDB: Analyzing 1 base restriction clauses for relation
WARNING:  ParadeDB: Extracting predicates for relation documents_join_test (rti 1)
WARNING:  ParadeDB: Extracted search query for documents_join_test: uses_search_operator=true
WARNING:  ParadeDB: Extracted 0 outer predicates, 1 inner predicates, 0 join conditions
WARNING:  ParadeDB: Found search predicates - outer: 0, inner: 1, bilateral: false
WARNING:  ParadeDB: Join is feasible based on composite analysis: OuterComposite
WARNING:  ParadeDB: Inner predicate for documents_join_test - uses_search: true
WARNING:  ParadeDB: Unilateral search detected - proceeding with custom join path
WARNING:  ParadeDB: Storing join relation OIDs - outer: ["files_join_test", "authors_join_test"], inner: ["documents_join_test"]
WARNING:  ParadeDB: Storing composite join info - composite_side: Outer, base_has_search: true, composite_has_search: false
WARNING:  ParadeDB: Join path estimates - rows: 1, startup_cost: 100.00, total_cost: 100.01
WARNING:  ParadeDB: Created custom join path, adding to joinrel
WARNING:  ParadeDB: Join pathlist callback called - jointype: 0, outer relids: ["documents_join_test"], inner relids: ["files_join_test", "authors_join_test"]
WARNING:  ParadeDB: Outer side is base, inner is composite - checking if we can handle this
WARNING:  ParadeDB: Found BM25 index for relation documents_join_test (rti 1)
WARNING:  ParadeDB: Checked relations ["documents_join_test"] for BM25 indexes, found: true
WARNING:  ParadeDB: Composite join - inner is composite, checking outer for BM25: true
WARNING:  ParadeDB: Join feasibility check - outer has BM25: true, inner has BM25: false
WARNING:  ParadeDB: Analyzing join search predicates
WARNING:  ParadeDB: Found 1 join restriction clauses
WARNING:  ParadeDB: Analyzing join clause of type T_OpExpr
WARNING:  ParadeDB: Analyzing 1 base restriction clauses for relation
WARNING:  ParadeDB: Extracting predicates for relation documents_join_test (rti 1)
WARNING:  ParadeDB: Extracted search query for documents_join_test: uses_search_operator=true
WARNING:  ParadeDB: Extracted 1 outer predicates, 0 inner predicates, 0 join conditions
WARNING:  ParadeDB: Found search predicates - outer: 1, inner: 0, bilateral: false
WARNING:  ParadeDB: Join is feasible based on composite analysis: InnerComposite
WARNING:  ParadeDB: Outer predicate for documents_join_test - uses_search: true
WARNING:  ParadeDB: Unilateral search detected - proceeding with custom join path
WARNING:  ParadeDB: Storing join relation OIDs - outer: ["documents_join_test"], inner: ["files_join_test", "authors_join_test"]
WARNING:  ParadeDB: Storing composite join info - composite_side: Inner, base_has_search: true, composite_has_search: false
WARNING:  ParadeDB: Join path estimates - rows: 1, startup_cost: 100.00, total_cost: 100.01
WARNING:  ParadeDB: Created custom join path, adding to joinrel
WARNING:  ParadeDB: Planning custom join path with scanrelid = 0
WARNING:  ParadeDB: Join target list has 4 entries
WARNING:  ParadeDB: Mapped join variable varno=1, varattno=1 to 'join_attr_1'
WARNING:  ParadeDB: Mapped join variable varno=1, varattno=2 to 'join_attr_2'
WARNING:  ParadeDB: Mapped join variable varno=2, varattno=3 to 'join_attr_3'
WARNING:  ParadeDB: Mapped join variable varno=4, varattno=3 to 'join_attr_4'
WARNING:  ParadeDB: Set custom scan target list for join node
WARNING:  ParadeDB: Creating custom scan state for join node (scanrelid = 0)
WARNING:  ParadeDB: Extracted search predicates from private data - outer: 0, inner: 1, bilateral: false
WARNING:  ParadeDB: Stored outer relation OIDs: ["files_join_test", "authors_join_test"]
WARNING:  ParadeDB: Stored inner relation OIDs: ["documents_join_test"]
WARNING:  ParadeDB: Storing 4 variable mappings from planning phase
WARNING:  ParadeDB: Planning-time mapping: varno=1, attno=1 -> 'join_attr_1'
WARNING:  ParadeDB: Planning-time mapping: varno=1, attno=2 -> 'join_attr_2'
WARNING:  ParadeDB: Planning-time mapping: varno=2, attno=3 -> 'join_attr_3'
WARNING:  ParadeDB: Planning-time mapping: varno=4, attno=3 -> 'join_attr_4'
WARNING:  ParadeDB: Storing composite join info - composite_side: Outer, base_has_search: true, composite_has_search: false
WARNING:  ParadeDB: Beginning custom scan for join node
WARNING:  ParadeDB: Initializing join execution (simplified)
WARNING:  ParadeDB: Using stored search predicates - outer: 0, inner: 1, bilateral: false
WARNING:  ParadeDB: Join execution initialization complete
WARNING:  ParadeDB: Executing join step
WARNING:  ParadeDB: Starting join execution - initializing search
WARNING:  ParadeDB: Initializing search execution for join
WARNING:  ParadeDB: Retrieved search predicates from join state - outer: 0, inner: 1
WARNING:  ParadeDB: Initializing search readers for join relations
WARNING:  ParadeDB: Opening search reader for inner relation documents_join_test
WARNING:  ParadeDB: Successfully opened search reader for documents_join_test
WARNING:  ParadeDB: Initialized 1 search readers
WARNING:  ParadeDB: Executing real searches on join relations
WARNING:  ParadeDB: Executing search on inner relation documents_join_test
WARNING:  ParadeDB: Executing real BM25 search on relation documents_join_test
WARNING:  ParadeDB: Real search on documents_join_test returned 1 results
WARNING:  ParadeDB: Found 1 results for inner relation documents_join_test
WARNING:  ParadeDB: No outer search results, using default result
WARNING:  ParadeDB: Completed real search execution - outer: 1, inner: 1
WARNING:  ParadeDB: Executing join step
WARNING:  ParadeDB: Executing outer search
WARNING:  ParadeDB: Executing search on outer relation
WARNING:  ParadeDB: Outer search completed - 1 results
WARNING:  ParadeDB: Executing join step
WARNING:  ParadeDB: Executing inner search
WARNING:  ParadeDB: Executing search on inner relation
WARNING:  ParadeDB: Inner search completed - 1 results
WARNING:  ParadeDB: Executing join step
WARNING:  ParadeDB: Performing join matching
WARNING:  ParadeDB: Matching and returning next tuple with join condition evaluation
WARNING:  ParadeDB: Using stored relation OIDs from join state - outer: files_join_test, inner: documents_join_test
WARNING:  ParadeDB: Fetching column 'document_id' from relation files_join_test with CTID 1
WARNING:  ParadeDB: Fetched column 'document_id' (attno 2) = Some("1")
WARNING:  ParadeDB: Fetching column 'id' from relation documents_join_test with CTID 3
WARNING:  ParadeDB: Fetched column 'id' (attno 1) = Some("3")
WARNING:  ParadeDB: Join condition evaluation: 1 (files_join_test.document_id) = 3 (documents_join_test.id) -> false
WARNING:  ParadeDB: Evaluating join condition for outer[0] (ctid 1) × inner[0] (ctid 3) = false
WARNING:  ParadeDB: Join condition not satisfied - advancing to next combination
WARNING:  ParadeDB: Join matching complete - total matches: 0
WARNING:  ParadeDB: Cleaning up join execution
WARNING:  ParadeDB: Cleaning up join execution state
WARNING:  ParadeDB: ===== JOIN EXECUTION STATISTICS =====
WARNING:  ParadeDB: Search Results - Outer: 1, Inner: 1, Total Combinations: 1
WARNING:  ParadeDB: Join Processing - Matches: 0, Returned: 0, Success Rate: 0.0%
WARNING:  ParadeDB: Heap Tuple Access - Attempts: 0, Successes: 0, Success Rate: 0.0%
WARNING:  ParadeDB: Cleaned up 1 search readers
WARNING:  ParadeDB: Cleared 1 outer and 1 inner search results
WARNING:  ParadeDB: ===== END JOIN EXECUTION STATISTICS =====
WARNING:  ParadeDB: Join execution cleanup complete
 id | title | filename | author_name 
----+-------+----------+-------------
(0 rows)

-- Cleanup
DROP TABLE documents_join_test CASCADE;
DROP TABLE files_join_test CASCADE;
DROP TABLE authors_join_test CASCADE;
RESET paradedb.enable_custom_join;
