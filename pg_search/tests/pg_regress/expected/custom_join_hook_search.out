-- Test search integration in custom joins
-- This test focuses on validating search predicate extraction and execution
-- Create the extension first
CREATE EXTENSION IF NOT EXISTS pg_search;
-- Enable the custom join feature
SET paradedb.enable_custom_join = true;
-- Create test tables with more realistic data
CREATE TABLE products (
    id SERIAL PRIMARY KEY,
    name TEXT,
    description TEXT,
    category TEXT
);
CREATE TABLE reviews (
    id SERIAL PRIMARY KEY,
    product_id INTEGER,
    reviewer_name TEXT,
    review_text TEXT,
    rating INTEGER
);
-- Insert test data with search-friendly content
INSERT INTO products (name, description, category) VALUES 
    ('Laptop Pro', 'High-performance laptop with advanced features for professionals', 'Electronics'),
    ('Wireless Mouse', 'Ergonomic wireless mouse with precision tracking', 'Electronics'),
    ('Coffee Maker', 'Automatic coffee maker with programmable settings', 'Kitchen'),
    ('Running Shoes', 'Lightweight running shoes with excellent cushioning', 'Sports'),
    ('Smartphone X', 'Latest smartphone with cutting-edge technology', 'Electronics');
INSERT INTO reviews (product_id, reviewer_name, review_text, rating) VALUES 
    (1, 'John Doe', 'Excellent laptop with amazing performance and battery life', 5),
    (1, 'Jane Smith', 'Great for professional work, highly recommended', 4),
    (2, 'Bob Wilson', 'Perfect wireless mouse, very responsive and comfortable', 5),
    (3, 'Alice Brown', 'Makes excellent coffee every morning, love the programmable features', 4),
    (4, 'Charlie Davis', 'Best running shoes I have ever owned, great cushioning', 5),
    (5, 'Eva Martinez', 'Amazing smartphone with incredible camera and performance', 5);
-- Create BM25 indexes
CREATE INDEX products_search_idx ON products USING bm25 (
    id,
    name,
    description,
    category
) WITH (
    key_field = 'id',
    text_fields = '{"name": {"tokenizer": {"type": "default"}}, "description": {"tokenizer": {"type": "default"}}, "category": {"tokenizer": {"type": "default"}}}'
);
CREATE INDEX reviews_search_idx ON reviews USING bm25 (
    id,
    product_id,
    reviewer_name,
    review_text,
    rating
) WITH (
    key_field = 'id',
    numeric_fields = '{"product_id": {"fast": true}, "rating": {"fast": true}}',
    text_fields = '{"reviewer_name": {"tokenizer": {"type": "default"}}, "review_text": {"tokenizer": {"type": "default"}}}'
);
-- Test 1: Bilateral search join (both sides have search predicates)
-- This should trigger our custom join with real search predicates
SELECT p.name, r.reviewer_name, r.review_text
FROM products p
JOIN reviews r ON p.id = r.product_id
WHERE p.description @@@ 'performance' AND r.review_text @@@ 'excellent';
WARNING:  ParadeDB: Join pathlist callback called - jointype: 0, outer relids: ["products"], inner relids: ["reviews"]
WARNING:  ParadeDB: Found BM25 index for relation products (rti 1)
WARNING:  ParadeDB: Checked relations ["products"] for BM25 indexes, found: true
WARNING:  ParadeDB: Found BM25 index for relation reviews (rti 2)
WARNING:  ParadeDB: Checked relations ["reviews"] for BM25 indexes, found: true
WARNING:  ParadeDB: Join feasibility check - outer has BM25: true, inner has BM25: true
WARNING:  ParadeDB: Analyzing join search predicates
WARNING:  ParadeDB: Found 1 join restriction clauses
WARNING:  ParadeDB: Analyzing join clause of type T_OpExpr
WARNING:  ParadeDB: Analyzing 1 base restriction clauses for relation
WARNING:  ParadeDB: Extracting predicates for relation products (rti 1)
WARNING:  ParadeDB: Extracted search query for products: uses_search_operator=true
WARNING:  ParadeDB: Analyzing 1 base restriction clauses for relation
WARNING:  ParadeDB: Extracting predicates for relation reviews (rti 2)
WARNING:  ParadeDB: Extracted search query for reviews: uses_search_operator=true
WARNING:  ParadeDB: Extracted 1 outer predicates, 1 inner predicates, 0 join conditions
WARNING:  ParadeDB: Found search predicates - outer: 1, inner: 1, bilateral: true
WARNING:  ParadeDB: Join is feasible - outer feasible: true, inner feasible: true
WARNING:  ParadeDB: Outer predicate for products - uses_search: true
WARNING:  ParadeDB: Inner predicate for reviews - uses_search: true
WARNING:  ParadeDB: Bilateral search detected - proceeding with custom join path
WARNING:  ParadeDB: Storing join relation OIDs - outer: ["products"], inner: ["reviews"]
WARNING:  ParadeDB: Join path estimates - rows: 1, startup_cost: 100.00, total_cost: 100.01
WARNING:  ParadeDB: Created custom join path, adding to joinrel
WARNING:  ParadeDB: Join pathlist callback called - jointype: 0, outer relids: ["reviews"], inner relids: ["products"]
WARNING:  ParadeDB: Found BM25 index for relation reviews (rti 2)
WARNING:  ParadeDB: Checked relations ["reviews"] for BM25 indexes, found: true
WARNING:  ParadeDB: Found BM25 index for relation products (rti 1)
WARNING:  ParadeDB: Checked relations ["products"] for BM25 indexes, found: true
WARNING:  ParadeDB: Join feasibility check - outer has BM25: true, inner has BM25: true
WARNING:  ParadeDB: Analyzing join search predicates
WARNING:  ParadeDB: Found 1 join restriction clauses
WARNING:  ParadeDB: Analyzing join clause of type T_OpExpr
WARNING:  ParadeDB: Analyzing 1 base restriction clauses for relation
WARNING:  ParadeDB: Extracting predicates for relation reviews (rti 2)
WARNING:  ParadeDB: Extracted search query for reviews: uses_search_operator=true
WARNING:  ParadeDB: Analyzing 1 base restriction clauses for relation
WARNING:  ParadeDB: Extracting predicates for relation products (rti 1)
WARNING:  ParadeDB: Extracted search query for products: uses_search_operator=true
WARNING:  ParadeDB: Extracted 1 outer predicates, 1 inner predicates, 0 join conditions
WARNING:  ParadeDB: Found search predicates - outer: 1, inner: 1, bilateral: true
WARNING:  ParadeDB: Join is feasible - outer feasible: true, inner feasible: true
WARNING:  ParadeDB: Outer predicate for reviews - uses_search: true
WARNING:  ParadeDB: Inner predicate for products - uses_search: true
WARNING:  ParadeDB: Bilateral search detected - proceeding with custom join path
WARNING:  ParadeDB: Storing join relation OIDs - outer: ["reviews"], inner: ["products"]
WARNING:  ParadeDB: Join path estimates - rows: 1, startup_cost: 100.00, total_cost: 100.01
WARNING:  ParadeDB: Created custom join path, adding to joinrel
WARNING:  ParadeDB: Planning custom join path with scanrelid = 0
WARNING:  ParadeDB: Join target list has 3 entries
WARNING:  ParadeDB: Mapped join variable varno=1, varattno=2 to 'join_attr_1'
WARNING:  ParadeDB: Mapped join variable varno=2, varattno=3 to 'join_attr_2'
WARNING:  ParadeDB: Mapped join variable varno=2, varattno=4 to 'join_attr_3'
WARNING:  ParadeDB: Set custom scan target list for join node
WARNING:  ParadeDB: Creating custom scan state for join node (scanrelid = 0)
WARNING:  ParadeDB: Extracted search predicates from private data - outer: 1, inner: 1, bilateral: true
WARNING:  ParadeDB: Stored outer relation OID: products
WARNING:  ParadeDB: Stored inner relation OID: reviews
WARNING:  ParadeDB: Storing 3 variable mappings from planning phase
WARNING:  ParadeDB: Planning-time mapping: varno=1, attno=2 -> 'join_attr_1'
WARNING:  ParadeDB: Planning-time mapping: varno=2, attno=3 -> 'join_attr_2'
WARNING:  ParadeDB: Planning-time mapping: varno=2, attno=4 -> 'join_attr_3'
WARNING:  ParadeDB: Beginning custom scan for join node
WARNING:  ParadeDB: Initializing join execution (simplified)
WARNING:  ParadeDB: Using stored search predicates - outer: 1, inner: 1, bilateral: true
WARNING:  ParadeDB: Join execution initialization complete
WARNING:  ParadeDB: Executing join step
WARNING:  ParadeDB: Starting join execution - initializing search
WARNING:  ParadeDB: Initializing search execution for join
WARNING:  ParadeDB: Retrieved search predicates from join state - outer: 1, inner: 1
WARNING:  ParadeDB: Initializing search readers for join relations
WARNING:  ParadeDB: Opening search reader for outer relation products
WARNING:  ParadeDB: Successfully opened search reader for products
WARNING:  ParadeDB: Opening search reader for inner relation reviews
WARNING:  ParadeDB: Successfully opened search reader for reviews
WARNING:  ParadeDB: Initialized 2 search readers
WARNING:  ParadeDB: Executing real searches on join relations
WARNING:  ParadeDB: Executing search on outer relation products
WARNING:  ParadeDB: Executing real BM25 search on relation products
WARNING:  ParadeDB: Real search on products returned 1 results
WARNING:  ParadeDB: Found 1 results for outer relation products
WARNING:  ParadeDB: Executing search on inner relation reviews
WARNING:  ParadeDB: Executing real BM25 search on relation reviews
WARNING:  ParadeDB: Real search on reviews returned 2 results
WARNING:  ParadeDB: Found 2 results for inner relation reviews
WARNING:  ParadeDB: Completed real search execution - outer: 1, inner: 2
WARNING:  ParadeDB: Executing join step
WARNING:  ParadeDB: Executing outer search
WARNING:  ParadeDB: Executing search on outer relation
WARNING:  ParadeDB: Outer search completed - 1 results
WARNING:  ParadeDB: Executing join step
WARNING:  ParadeDB: Executing inner search
WARNING:  ParadeDB: Executing search on inner relation
WARNING:  ParadeDB: Inner search completed - 2 results
WARNING:  ParadeDB: Executing join step
WARNING:  ParadeDB: Performing join matching
WARNING:  ParadeDB: Matching and returning next tuple
WARNING:  ParadeDB: Standard join matching for base relations
WARNING:  ParadeDB: Processing join match [1/1] × [1/2]
WARNING:  ParadeDB: Creating join result tuple for outer[0], inner[0]
WARNING:  ParadeDB: Creating result tuple with 3 attributes
WARNING:  ParadeDB: Using stored relation OIDs from join state - outer: products, inner: reviews
WARNING:  ParadeDB: Fetching real heap tuple values from relations products and reviews
WARNING:  ParadeDB: Using stored relation OIDs from join state - outer: products, inner: reviews
WARNING:  ParadeDB: Detected relations from predicates - outer: 'products', inner: 'reviews'
WARNING:  ParadeDB: Fetching all columns with names from relation products with CTID 1
WARNING:  ParadeDB: products column 'id' = '1'
WARNING:  ParadeDB: products column 'name' = 'Laptop Pro'
WARNING:  ParadeDB: products column 'description' = 'High-performance laptop with advanced features for professionals'
WARNING:  ParadeDB: products column 'category' = 'Electronics'
WARNING:  ParadeDB: Successfully fetched 4 columns from products relation
WARNING:  ParadeDB: Fetching all columns with names from relation reviews with CTID 1
WARNING:  ParadeDB: reviews column 'id' = '1'
WARNING:  ParadeDB: reviews column 'product_id' = '1'
WARNING:  ParadeDB: reviews column 'reviewer_name' = 'John Doe'
WARNING:  ParadeDB: reviews column 'review_text' = 'Excellent laptop with amazing performance and battery life'
WARNING:  ParadeDB: reviews column 'rating' = '5'
WARNING:  ParadeDB: Successfully fetched 5 columns from reviews relation
WARNING:  ParadeDB: Fetched 4 columns from outer relation, 5 from inner relation
WARNING:  ParadeDB: PLAN: Ok("{CUSTOMSCAN :scan.plan.startup_cost 100 :scan.plan.total_cost 100.01 :scan.plan.plan_rows 1 :scan.plan.plan_width 96 :scan.plan.parallel_aware false :scan.plan.parallel_safe false :scan.plan.async_capable false :scan.plan.plan_node_id 0 :scan.plan.targetlist ({TARGETENTRY :expr {VAR :varno -3 :varattno 1 :vartype 25 :vartypmod -1 :varcollid 100 :varnullingrels (b) :varlevelsup 0 :varnosyn 1 :varattnosyn 2 :location -1} :resno 1 :resname name :ressortgroupref 0 :resorigtbl 114278 :resorigcol 2 :resjunk false} {TARGETENTRY :expr {VAR :varno -3 :varattno 2 :vartype 25 :vartypmod -1 :varcollid 100 :varnullingrels (b) :varlevelsup 0 :varnosyn 2 :varattnosyn 3 :location -1} :resno 2 :resname reviewer_name :ressortgroupref 0 :resorigtbl 114287 :resorigcol 3 :resjunk false} {TARGETENTRY :expr {VAR :varno -3 :varattno 3 :vartype 25 :vartypmod -1 :varcollid 100 :varnullingrels (b) :varlevelsup 0 :varnosyn 2 :varattnosyn 4 :location -1} :resno 3 :resname review_text :ressortgroupref 0 :resorigtbl 114287 :resorigcol 4 :resjunk false}) :scan.plan.qual <> :scan.plan.lefttree <> :scan.plan.righttree <> :scan.plan.initPlan <> :scan.plan.extParam (b) :scan.plan.allParam (b) :scan.scanrelid 0 :flags 4 :custom_plans <> :custom_exprs <> :custom_private (\"\\{\"heaprelid\":null,\"indexrelid\":null,\"range_table_index\":null,\"query\":null,\"limit\":null,\"segment_count\":0,\"sort_field\":null,\"sort_direction\":null,\"exec_method_type\":\"Normal\",\"var_attname_lookup\":[[\"1,2\",\"join_attr_1\"],[\"2,3\",\"join_attr_2\"],[\"2,4\",\"join_attr_3\"]],\"target_list_len\":3,\"planned_which_fast_fields\":null,\"referenced_columns_count\":0,\"join_search_predicates\":\\{\"outer_predicates\":[\\{\"rti\":1,\"relid\":114278,\"relname\":\"products\",\"query\":\\{\"with_index\":\\{\"oid\":114295,\"query\":\\{\"parse_with_field\":\\{\"field\":\"description\",\"query_string\":\"performance\",\"lenient\":null,\"conjunction_mode\":null\\}\\}\\}\\},\"uses_search_operator\":true\\}],\"inner_predicates\":[\\{\"rti\":2,\"relid\":114287,\"relname\":\"reviews\",\"query\":\\{\"with_index\":\\{\"oid\":114296,\"query\":\\{\"parse_with_field\":\\{\"field\":\"review_text\",\"query_string\":\"excellent\",\"lenient\":null,\"conjunction_mode\":null\\}\\}\\}\\},\"uses_search_operator\":true\\}],\"join_conditions\":[]\\},\"join_outer_relid\":114278,\"join_inner_relid\":114287\\}\") :custom_scan_tlist ({TARGETENTRY :expr {VAR :varno 1 :varattno 2 :vartype 25 :vartypmod -1 :varcollid 100 :varnullingrels (b) :varlevelsup 0 :varnosyn 1 :varattnosyn 2 :location -1} :resno 1 :resname name :ressortgroupref 0 :resorigtbl 114278 :resorigcol 2 :resjunk false} {TARGETENTRY :expr {VAR :varno 2 :varattno 3 :vartype 25 :vartypmod -1 :varcollid 100 :varnullingrels (b) :varlevelsup 0 :varnosyn 2 :varattnosyn 3 :location -1} :resno 2 :resname reviewer_name :ressortgroupref 0 :resorigtbl 114287 :resorigcol 3 :resjunk false} {TARGETENTRY :expr {VAR :varno 2 :varattno 4 :vartype 25 :vartypmod -1 :varcollid 100 :varnullingrels (b) :varlevelsup 0 :varnosyn 2 :varattnosyn 4 :location -1} :resno 3 :resname review_text :ressortgroupref 0 :resorigtbl 114287 :resorigcol 4 :resjunk false}) :custom_relids (b 1 2) :methods ParadeDB\\ Scan}")
WARNING:  ParadeDB: Analyzing 3 target entries using execution-time varno/attno mapping: [(1, Some((Ok("{VAR :varno -3 :varattno 1 :vartype 25 :vartypmod -1 :varcollid 100 :varnullingrels (b) :varlevelsup 0 :varnosyn 1 :varattnosyn 2 :location -1}"),))), (2, Some((Ok("{VAR :varno -3 :varattno 2 :vartype 25 :vartypmod -1 :varcollid 100 :varnullingrels (b) :varlevelsup 0 :varnosyn 2 :varattnosyn 3 :location -1}"),))), (3, Some((Ok("{VAR :varno -3 :varattno 3 :vartype 25 :vartypmod -1 :varcollid 100 :varnullingrels (b) :varlevelsup 0 :varnosyn 2 :varattnosyn 4 :location -1}"),)))]
WARNING:  ParadeDB: Mapped varno 4294967293 to outer relation products
WARNING:  ParadeDB: Built execution-time varno mapping with 1 entries: [(4294967293, "products")]
WARNING:  ParadeDB: Analyzing target entry 1 (resno: 1)
WARNING:  ParadeDB: Found Var in target entry 1 - varno: -3, attno: 1, varnosyn: 1, varattnosyn: 2
WARNING:  ParadeDB: Variable references INDEX/intermediate result, using varnosyn: 1, varattnosyn: 2
WARNING:  ParadeDB: Mapping original variable varnosyn: 1, varattnosyn: 2 to relation
WARNING:  ParadeDB: Using stored relation OIDs from join state - outer: products, inner: reviews
WARNING:  ParadeDB: varnosyn 1 mapped to outer relation products (attno 2)
WARNING:  ParadeDB: Relation products attno 2 -> column name 'name'
WARNING:  ParadeDB: Target entry 1 mapped to: RelationColumn { relid: 114278, column_name: "name" }
WARNING:  ParadeDB: Analyzing target entry 2 (resno: 2)
WARNING:  ParadeDB: Found Var in target entry 2 - varno: -3, attno: 2, varnosyn: 2, varattnosyn: 3
WARNING:  ParadeDB: Variable references INDEX/intermediate result, using varnosyn: 2, varattnosyn: 3
WARNING:  ParadeDB: Mapping original variable varnosyn: 2, varattnosyn: 3 to relation
WARNING:  ParadeDB: Using stored relation OIDs from join state - outer: products, inner: reviews
WARNING:  ParadeDB: varnosyn 2 mapped to inner relation reviews (attno 3)
WARNING:  ParadeDB: Relation reviews attno 3 -> column name 'reviewer_name'
WARNING:  ParadeDB: Target entry 2 mapped to: RelationColumn { relid: 114287, column_name: "reviewer_name" }
WARNING:  ParadeDB: Analyzing target entry 3 (resno: 3)
WARNING:  ParadeDB: Found Var in target entry 3 - varno: -3, attno: 3, varnosyn: 2, varattnosyn: 4
WARNING:  ParadeDB: Variable references INDEX/intermediate result, using varnosyn: 2, varattnosyn: 4
WARNING:  ParadeDB: Mapping original variable varnosyn: 2, varattnosyn: 4 to relation
WARNING:  ParadeDB: Using stored relation OIDs from join state - outer: products, inner: reviews
WARNING:  ParadeDB: varnosyn 2 mapped to inner relation reviews (attno 4)
WARNING:  ParadeDB: Relation reviews attno 4 -> column name 'review_text'
WARNING:  ParadeDB: Target entry 3 mapped to: RelationColumn { relid: 114287, column_name: "review_text" }
WARNING:  ParadeDB: Mapped 3 out of 3 column values: [Some("Laptop Pro"), Some("John Doe"), Some("Excellent laptop with amazing performance and battery life")]
WARNING:  ParadeDB: Created join result tuple with real heap data: [Some("Laptop Pro"), Some("John Doe"), Some("Excellent laptop with amazing performance and battery life")]
WARNING:  ParadeDB: Executing join step
WARNING:  ParadeDB: Performing join matching
WARNING:  ParadeDB: Matching and returning next tuple
WARNING:  ParadeDB: Standard join matching for base relations
WARNING:  ParadeDB: Processing join match [1/1] × [2/2]
WARNING:  ParadeDB: Creating join result tuple for outer[0], inner[1]
WARNING:  ParadeDB: Creating result tuple with 3 attributes
WARNING:  ParadeDB: Using stored relation OIDs from join state - outer: products, inner: reviews
WARNING:  ParadeDB: Fetching real heap tuple values from relations products and reviews
WARNING:  ParadeDB: Using stored relation OIDs from join state - outer: products, inner: reviews
WARNING:  ParadeDB: Detected relations from predicates - outer: 'products', inner: 'reviews'
WARNING:  ParadeDB: Fetching all columns with names from relation products with CTID 1
WARNING:  ParadeDB: products column 'id' = '1'
WARNING:  ParadeDB: products column 'name' = 'Laptop Pro'
WARNING:  ParadeDB: products column 'description' = 'High-performance laptop with advanced features for professionals'
WARNING:  ParadeDB: products column 'category' = 'Electronics'
WARNING:  ParadeDB: Successfully fetched 4 columns from products relation
WARNING:  ParadeDB: Fetching all columns with names from relation reviews with CTID 4
WARNING:  ParadeDB: reviews column 'id' = '4'
WARNING:  ParadeDB: reviews column 'product_id' = '3'
WARNING:  ParadeDB: reviews column 'reviewer_name' = 'Alice Brown'
WARNING:  ParadeDB: reviews column 'review_text' = 'Makes excellent coffee every morning, love the programmable features'
WARNING:  ParadeDB: reviews column 'rating' = '4'
WARNING:  ParadeDB: Successfully fetched 5 columns from reviews relation
WARNING:  ParadeDB: Fetched 4 columns from outer relation, 5 from inner relation
WARNING:  ParadeDB: PLAN: Ok("{CUSTOMSCAN :scan.plan.startup_cost 100 :scan.plan.total_cost 100.01 :scan.plan.plan_rows 1 :scan.plan.plan_width 96 :scan.plan.parallel_aware false :scan.plan.parallel_safe false :scan.plan.async_capable false :scan.plan.plan_node_id 0 :scan.plan.targetlist ({TARGETENTRY :expr {VAR :varno -3 :varattno 1 :vartype 25 :vartypmod -1 :varcollid 100 :varnullingrels (b) :varlevelsup 0 :varnosyn 1 :varattnosyn 2 :location -1} :resno 1 :resname name :ressortgroupref 0 :resorigtbl 114278 :resorigcol 2 :resjunk false} {TARGETENTRY :expr {VAR :varno -3 :varattno 2 :vartype 25 :vartypmod -1 :varcollid 100 :varnullingrels (b) :varlevelsup 0 :varnosyn 2 :varattnosyn 3 :location -1} :resno 2 :resname reviewer_name :ressortgroupref 0 :resorigtbl 114287 :resorigcol 3 :resjunk false} {TARGETENTRY :expr {VAR :varno -3 :varattno 3 :vartype 25 :vartypmod -1 :varcollid 100 :varnullingrels (b) :varlevelsup 0 :varnosyn 2 :varattnosyn 4 :location -1} :resno 3 :resname review_text :ressortgroupref 0 :resorigtbl 114287 :resorigcol 4 :resjunk false}) :scan.plan.qual <> :scan.plan.lefttree <> :scan.plan.righttree <> :scan.plan.initPlan <> :scan.plan.extParam (b) :scan.plan.allParam (b) :scan.scanrelid 0 :flags 4 :custom_plans <> :custom_exprs <> :custom_private (\"\\{\"heaprelid\":null,\"indexrelid\":null,\"range_table_index\":null,\"query\":null,\"limit\":null,\"segment_count\":0,\"sort_field\":null,\"sort_direction\":null,\"exec_method_type\":\"Normal\",\"var_attname_lookup\":[[\"1,2\",\"join_attr_1\"],[\"2,3\",\"join_attr_2\"],[\"2,4\",\"join_attr_3\"]],\"target_list_len\":3,\"planned_which_fast_fields\":null,\"referenced_columns_count\":0,\"join_search_predicates\":\\{\"outer_predicates\":[\\{\"rti\":1,\"relid\":114278,\"relname\":\"products\",\"query\":\\{\"with_index\":\\{\"oid\":114295,\"query\":\\{\"parse_with_field\":\\{\"field\":\"description\",\"query_string\":\"performance\",\"lenient\":null,\"conjunction_mode\":null\\}\\}\\}\\},\"uses_search_operator\":true\\}],\"inner_predicates\":[\\{\"rti\":2,\"relid\":114287,\"relname\":\"reviews\",\"query\":\\{\"with_index\":\\{\"oid\":114296,\"query\":\\{\"parse_with_field\":\\{\"field\":\"review_text\",\"query_string\":\"excellent\",\"lenient\":null,\"conjunction_mode\":null\\}\\}\\}\\},\"uses_search_operator\":true\\}],\"join_conditions\":[]\\},\"join_outer_relid\":114278,\"join_inner_relid\":114287\\}\") :custom_scan_tlist ({TARGETENTRY :expr {VAR :varno 1 :varattno 2 :vartype 25 :vartypmod -1 :varcollid 100 :varnullingrels (b) :varlevelsup 0 :varnosyn 1 :varattnosyn 2 :location -1} :resno 1 :resname name :ressortgroupref 0 :resorigtbl 114278 :resorigcol 2 :resjunk false} {TARGETENTRY :expr {VAR :varno 2 :varattno 3 :vartype 25 :vartypmod -1 :varcollid 100 :varnullingrels (b) :varlevelsup 0 :varnosyn 2 :varattnosyn 3 :location -1} :resno 2 :resname reviewer_name :ressortgroupref 0 :resorigtbl 114287 :resorigcol 3 :resjunk false} {TARGETENTRY :expr {VAR :varno 2 :varattno 4 :vartype 25 :vartypmod -1 :varcollid 100 :varnullingrels (b) :varlevelsup 0 :varnosyn 2 :varattnosyn 4 :location -1} :resno 3 :resname review_text :ressortgroupref 0 :resorigtbl 114287 :resorigcol 4 :resjunk false}) :custom_relids (b 1 2) :methods ParadeDB\\ Scan}")
WARNING:  ParadeDB: Analyzing 3 target entries using execution-time varno/attno mapping: [(1, Some((Ok("{VAR :varno -3 :varattno 1 :vartype 25 :vartypmod -1 :varcollid 100 :varnullingrels (b) :varlevelsup 0 :varnosyn 1 :varattnosyn 2 :location -1}"),))), (2, Some((Ok("{VAR :varno -3 :varattno 2 :vartype 25 :vartypmod -1 :varcollid 100 :varnullingrels (b) :varlevelsup 0 :varnosyn 2 :varattnosyn 3 :location -1}"),))), (3, Some((Ok("{VAR :varno -3 :varattno 3 :vartype 25 :vartypmod -1 :varcollid 100 :varnullingrels (b) :varlevelsup 0 :varnosyn 2 :varattnosyn 4 :location -1}"),)))]
WARNING:  ParadeDB: Mapped varno 4294967293 to outer relation products
WARNING:  ParadeDB: Built execution-time varno mapping with 1 entries: [(4294967293, "products")]
WARNING:  ParadeDB: Analyzing target entry 1 (resno: 1)
WARNING:  ParadeDB: Found Var in target entry 1 - varno: -3, attno: 1, varnosyn: 1, varattnosyn: 2
WARNING:  ParadeDB: Variable references INDEX/intermediate result, using varnosyn: 1, varattnosyn: 2
WARNING:  ParadeDB: Mapping original variable varnosyn: 1, varattnosyn: 2 to relation
WARNING:  ParadeDB: Using stored relation OIDs from join state - outer: products, inner: reviews
WARNING:  ParadeDB: varnosyn 1 mapped to outer relation products (attno 2)
WARNING:  ParadeDB: Relation products attno 2 -> column name 'name'
WARNING:  ParadeDB: Target entry 1 mapped to: RelationColumn { relid: 114278, column_name: "name" }
WARNING:  ParadeDB: Analyzing target entry 2 (resno: 2)
WARNING:  ParadeDB: Found Var in target entry 2 - varno: -3, attno: 2, varnosyn: 2, varattnosyn: 3
WARNING:  ParadeDB: Variable references INDEX/intermediate result, using varnosyn: 2, varattnosyn: 3
WARNING:  ParadeDB: Mapping original variable varnosyn: 2, varattnosyn: 3 to relation
WARNING:  ParadeDB: Using stored relation OIDs from join state - outer: products, inner: reviews
WARNING:  ParadeDB: varnosyn 2 mapped to inner relation reviews (attno 3)
WARNING:  ParadeDB: Relation reviews attno 3 -> column name 'reviewer_name'
WARNING:  ParadeDB: Target entry 2 mapped to: RelationColumn { relid: 114287, column_name: "reviewer_name" }
WARNING:  ParadeDB: Analyzing target entry 3 (resno: 3)
WARNING:  ParadeDB: Found Var in target entry 3 - varno: -3, attno: 3, varnosyn: 2, varattnosyn: 4
WARNING:  ParadeDB: Variable references INDEX/intermediate result, using varnosyn: 2, varattnosyn: 4
WARNING:  ParadeDB: Mapping original variable varnosyn: 2, varattnosyn: 4 to relation
WARNING:  ParadeDB: Using stored relation OIDs from join state - outer: products, inner: reviews
WARNING:  ParadeDB: varnosyn 2 mapped to inner relation reviews (attno 4)
WARNING:  ParadeDB: Relation reviews attno 4 -> column name 'review_text'
WARNING:  ParadeDB: Target entry 3 mapped to: RelationColumn { relid: 114287, column_name: "review_text" }
WARNING:  ParadeDB: Mapped 3 out of 3 column values: [Some("Laptop Pro"), Some("Alice Brown"), Some("Makes excellent coffee every morning, love the programmable features")]
WARNING:  ParadeDB: Created join result tuple with real heap data: [Some("Laptop Pro"), Some("Alice Brown"), Some("Makes excellent coffee every morning, love the programmable features")]
WARNING:  ParadeDB: Executing join step
WARNING:  ParadeDB: Performing join matching
WARNING:  ParadeDB: Matching and returning next tuple
WARNING:  ParadeDB: Standard join matching for base relations
WARNING:  ParadeDB: Join matching complete - total matches: 2
WARNING:  ParadeDB: Cleaning up join execution
WARNING:  ParadeDB: Cleaning up join execution state
WARNING:  ParadeDB: ===== JOIN EXECUTION STATISTICS =====
WARNING:  ParadeDB: Search Results - Outer: 1, Inner: 2, Total Combinations: 2
WARNING:  ParadeDB: Join Processing - Matches: 2, Returned: 2, Success Rate: 100.0%
WARNING:  ParadeDB: Heap Tuple Access - Attempts: 4, Successes: 6, Success Rate: 150.0%
WARNING:  ParadeDB: Cleaned up 2 search readers
WARNING:  ParadeDB: Cleared 1 outer and 2 inner search results
WARNING:  ParadeDB: ===== END JOIN EXECUTION STATISTICS =====
WARNING:  ParadeDB: Join execution cleanup complete
    name    | reviewer_name |                             review_text                              
------------+---------------+----------------------------------------------------------------------
 Laptop Pro | John Doe      | Excellent laptop with amazing performance and battery life
 Laptop Pro | Alice Brown   | Makes excellent coffee every morning, love the programmable features
(2 rows)

-- Test 2: Single-sided search join (only one side has search predicate)
SELECT p.name, r.reviewer_name, r.rating
FROM products p
JOIN reviews r ON p.id = r.product_id
WHERE p.category @@@ 'Electronics';
WARNING:  ParadeDB: Join pathlist callback called - jointype: 0, outer relids: ["products"], inner relids: ["reviews"]
WARNING:  ParadeDB: Found BM25 index for relation products (rti 1)
WARNING:  ParadeDB: Checked relations ["products"] for BM25 indexes, found: true
WARNING:  ParadeDB: Found BM25 index for relation reviews (rti 2)
WARNING:  ParadeDB: Checked relations ["reviews"] for BM25 indexes, found: true
WARNING:  ParadeDB: Join feasibility check - outer has BM25: true, inner has BM25: true
WARNING:  ParadeDB: Analyzing join search predicates
WARNING:  ParadeDB: Found 1 join restriction clauses
WARNING:  ParadeDB: Analyzing join clause of type T_OpExpr
WARNING:  ParadeDB: Analyzing 1 base restriction clauses for relation
WARNING:  ParadeDB: Extracting predicates for relation products (rti 1)
WARNING:  ParadeDB: Extracted search query for products: uses_search_operator=true
WARNING:  ParadeDB: Extracted 1 outer predicates, 0 inner predicates, 0 join conditions
WARNING:  ParadeDB: Found search predicates - outer: 1, inner: 0, bilateral: false
WARNING:  ParadeDB: Join is feasible - outer feasible: true, inner feasible: false
WARNING:  ParadeDB: Outer predicate for products - uses_search: true
WARNING:  ParadeDB: Unilateral search detected - proceeding with custom join path
WARNING:  ParadeDB: Storing join relation OIDs - outer: ["products"], inner: ["reviews"]
WARNING:  ParadeDB: Join path estimates - rows: 2, startup_cost: 100.00, total_cost: 100.02
WARNING:  ParadeDB: Created custom join path, adding to joinrel
WARNING:  ParadeDB: Join pathlist callback called - jointype: 0, outer relids: ["reviews"], inner relids: ["products"]
WARNING:  ParadeDB: Found BM25 index for relation reviews (rti 2)
WARNING:  ParadeDB: Checked relations ["reviews"] for BM25 indexes, found: true
WARNING:  ParadeDB: Found BM25 index for relation products (rti 1)
WARNING:  ParadeDB: Checked relations ["products"] for BM25 indexes, found: true
WARNING:  ParadeDB: Join feasibility check - outer has BM25: true, inner has BM25: true
WARNING:  ParadeDB: Analyzing join search predicates
WARNING:  ParadeDB: Found 1 join restriction clauses
WARNING:  ParadeDB: Analyzing join clause of type T_OpExpr
WARNING:  ParadeDB: Analyzing 1 base restriction clauses for relation
WARNING:  ParadeDB: Extracting predicates for relation products (rti 1)
WARNING:  ParadeDB: Extracted search query for products: uses_search_operator=true
WARNING:  ParadeDB: Extracted 0 outer predicates, 1 inner predicates, 0 join conditions
WARNING:  ParadeDB: Found search predicates - outer: 0, inner: 1, bilateral: false
WARNING:  ParadeDB: Join is feasible - outer feasible: false, inner feasible: true
WARNING:  ParadeDB: Inner predicate for products - uses_search: true
WARNING:  ParadeDB: Unilateral search detected - proceeding with custom join path
WARNING:  ParadeDB: Storing join relation OIDs - outer: ["reviews"], inner: ["products"]
WARNING:  ParadeDB: Join path estimates - rows: 2, startup_cost: 100.00, total_cost: 100.02
WARNING:  ParadeDB: Created custom join path, adding to joinrel
WARNING:  ParadeDB: Planning custom join path with scanrelid = 0
WARNING:  ParadeDB: Join target list has 3 entries
WARNING:  ParadeDB: Mapped join variable varno=1, varattno=2 to 'join_attr_1'
WARNING:  ParadeDB: Mapped join variable varno=2, varattno=3 to 'join_attr_2'
WARNING:  ParadeDB: Mapped join variable varno=2, varattno=5 to 'join_attr_3'
WARNING:  ParadeDB: Set custom scan target list for join node
WARNING:  ParadeDB: Creating custom scan state for join node (scanrelid = 0)
WARNING:  ParadeDB: Extracted search predicates from private data - outer: 1, inner: 0, bilateral: false
WARNING:  ParadeDB: Stored outer relation OID: products
WARNING:  ParadeDB: Stored inner relation OID: reviews
WARNING:  ParadeDB: Storing 3 variable mappings from planning phase
WARNING:  ParadeDB: Planning-time mapping: varno=1, attno=2 -> 'join_attr_1'
WARNING:  ParadeDB: Planning-time mapping: varno=2, attno=3 -> 'join_attr_2'
WARNING:  ParadeDB: Planning-time mapping: varno=2, attno=5 -> 'join_attr_3'
WARNING:  ParadeDB: Beginning custom scan for join node
WARNING:  ParadeDB: Initializing join execution (simplified)
WARNING:  ParadeDB: Using stored search predicates - outer: 1, inner: 0, bilateral: false
WARNING:  ParadeDB: Join execution initialization complete
WARNING:  ParadeDB: Executing join step
WARNING:  ParadeDB: Starting join execution - initializing search
WARNING:  ParadeDB: Initializing search execution for join
WARNING:  ParadeDB: Retrieved search predicates from join state - outer: 1, inner: 0
WARNING:  ParadeDB: Initializing search readers for join relations
WARNING:  ParadeDB: Opening search reader for outer relation products
WARNING:  ParadeDB: Successfully opened search reader for products
WARNING:  ParadeDB: Initialized 1 search readers
WARNING:  ParadeDB: Executing real searches on join relations
WARNING:  ParadeDB: Executing search on outer relation products
WARNING:  ParadeDB: Executing real BM25 search on relation products
WARNING:  ParadeDB: Real search on products returned 3 results
WARNING:  ParadeDB: Found 3 results for outer relation products
WARNING:  ParadeDB: No inner search results, using default result
WARNING:  ParadeDB: Completed real search execution - outer: 3, inner: 1
WARNING:  ParadeDB: Executing join step
WARNING:  ParadeDB: Executing outer search
WARNING:  ParadeDB: Executing search on outer relation
WARNING:  ParadeDB: Outer search completed - 3 results
WARNING:  ParadeDB: Executing join step
WARNING:  ParadeDB: Executing inner search
WARNING:  ParadeDB: Executing search on inner relation
WARNING:  ParadeDB: Inner search completed - 1 results
WARNING:  ParadeDB: Executing join step
WARNING:  ParadeDB: Performing join matching
WARNING:  ParadeDB: Matching and returning next tuple
WARNING:  ParadeDB: Standard join matching for base relations
WARNING:  ParadeDB: Processing join match [1/3] × [1/1]
WARNING:  ParadeDB: Creating join result tuple for outer[0], inner[0]
WARNING:  ParadeDB: Creating result tuple with 3 attributes
WARNING:  ParadeDB: Using stored relation OIDs from join state - outer: products, inner: reviews
WARNING:  ParadeDB: Fetching real heap tuple values from relations products and reviews
WARNING:  ParadeDB: Using stored relation OIDs from join state - outer: products, inner: reviews
WARNING:  ParadeDB: Detected relations from predicates - outer: 'products', inner: 'reviews'
WARNING:  ParadeDB: Fetching all columns with names from relation products with CTID 1
WARNING:  ParadeDB: products column 'id' = '1'
WARNING:  ParadeDB: products column 'name' = 'Laptop Pro'
WARNING:  ParadeDB: products column 'description' = 'High-performance laptop with advanced features for professionals'
WARNING:  ParadeDB: products column 'category' = 'Electronics'
WARNING:  ParadeDB: Successfully fetched 4 columns from products relation
WARNING:  ParadeDB: Fetching all columns with names from relation reviews with CTID 1
WARNING:  ParadeDB: reviews column 'id' = '1'
WARNING:  ParadeDB: reviews column 'product_id' = '1'
WARNING:  ParadeDB: reviews column 'reviewer_name' = 'John Doe'
WARNING:  ParadeDB: reviews column 'review_text' = 'Excellent laptop with amazing performance and battery life'
WARNING:  ParadeDB: reviews column 'rating' = '5'
WARNING:  ParadeDB: Successfully fetched 5 columns from reviews relation
WARNING:  ParadeDB: Fetched 4 columns from outer relation, 5 from inner relation
WARNING:  ParadeDB: PLAN: Ok("{CUSTOMSCAN :scan.plan.startup_cost 100 :scan.plan.total_cost 100.018 :scan.plan.plan_rows 1.8 :scan.plan.plan_width 68 :scan.plan.parallel_aware false :scan.plan.parallel_safe false :scan.plan.async_capable false :scan.plan.plan_node_id 0 :scan.plan.targetlist ({TARGETENTRY :expr {VAR :varno -3 :varattno 1 :vartype 25 :vartypmod -1 :varcollid 100 :varnullingrels (b) :varlevelsup 0 :varnosyn 1 :varattnosyn 2 :location -1} :resno 1 :resname name :ressortgroupref 0 :resorigtbl 114278 :resorigcol 2 :resjunk false} {TARGETENTRY :expr {VAR :varno -3 :varattno 2 :vartype 25 :vartypmod -1 :varcollid 100 :varnullingrels (b) :varlevelsup 0 :varnosyn 2 :varattnosyn 3 :location -1} :resno 2 :resname reviewer_name :ressortgroupref 0 :resorigtbl 114287 :resorigcol 3 :resjunk false} {TARGETENTRY :expr {VAR :varno -3 :varattno 3 :vartype 23 :vartypmod -1 :varcollid 0 :varnullingrels (b) :varlevelsup 0 :varnosyn 2 :varattnosyn 5 :location -1} :resno 3 :resname rating :ressortgroupref 0 :resorigtbl 114287 :resorigcol 5 :resjunk false}) :scan.plan.qual <> :scan.plan.lefttree <> :scan.plan.righttree <> :scan.plan.initPlan <> :scan.plan.extParam (b) :scan.plan.allParam (b) :scan.scanrelid 0 :flags 4 :custom_plans <> :custom_exprs <> :custom_private (\"\\{\"heaprelid\":null,\"indexrelid\":null,\"range_table_index\":null,\"query\":null,\"limit\":null,\"segment_count\":0,\"sort_field\":null,\"sort_direction\":null,\"exec_method_type\":\"Normal\",\"var_attname_lookup\":[[\"1,2\",\"join_attr_1\"],[\"2,3\",\"join_attr_2\"],[\"2,5\",\"join_attr_3\"]],\"target_list_len\":3,\"planned_which_fast_fields\":null,\"referenced_columns_count\":0,\"join_search_predicates\":\\{\"outer_predicates\":[\\{\"rti\":1,\"relid\":114278,\"relname\":\"products\",\"query\":\\{\"with_index\":\\{\"oid\":114295,\"query\":\\{\"parse_with_field\":\\{\"field\":\"category\",\"query_string\":\"Electronics\",\"lenient\":null,\"conjunction_mode\":null\\}\\}\\}\\},\"uses_search_operator\":true\\}],\"inner_predicates\":[],\"join_conditions\":[]\\},\"join_outer_relid\":114278,\"join_inner_relid\":114287\\}\") :custom_scan_tlist ({TARGETENTRY :expr {VAR :varno 1 :varattno 2 :vartype 25 :vartypmod -1 :varcollid 100 :varnullingrels (b) :varlevelsup 0 :varnosyn 1 :varattnosyn 2 :location -1} :resno 1 :resname name :ressortgroupref 0 :resorigtbl 114278 :resorigcol 2 :resjunk false} {TARGETENTRY :expr {VAR :varno 2 :varattno 3 :vartype 25 :vartypmod -1 :varcollid 100 :varnullingrels (b) :varlevelsup 0 :varnosyn 2 :varattnosyn 3 :location -1} :resno 2 :resname reviewer_name :ressortgroupref 0 :resorigtbl 114287 :resorigcol 3 :resjunk false} {TARGETENTRY :expr {VAR :varno 2 :varattno 5 :vartype 23 :vartypmod -1 :varcollid 0 :varnullingrels (b) :varlevelsup 0 :varnosyn 2 :varattnosyn 5 :location -1} :resno 3 :resname rating :ressortgroupref 0 :resorigtbl 114287 :resorigcol 5 :resjunk false}) :custom_relids (b 1 2) :methods ParadeDB\\ Scan}")
WARNING:  ParadeDB: Analyzing 3 target entries using execution-time varno/attno mapping: [(1, Some((Ok("{VAR :varno -3 :varattno 1 :vartype 25 :vartypmod -1 :varcollid 100 :varnullingrels (b) :varlevelsup 0 :varnosyn 1 :varattnosyn 2 :location -1}"),))), (2, Some((Ok("{VAR :varno -3 :varattno 2 :vartype 25 :vartypmod -1 :varcollid 100 :varnullingrels (b) :varlevelsup 0 :varnosyn 2 :varattnosyn 3 :location -1}"),))), (3, Some((Ok("{VAR :varno -3 :varattno 3 :vartype 23 :vartypmod -1 :varcollid 0 :varnullingrels (b) :varlevelsup 0 :varnosyn 2 :varattnosyn 5 :location -1}"),)))]
WARNING:  ParadeDB: Mapped varno 4294967293 to outer relation products
WARNING:  ParadeDB: Built execution-time varno mapping with 1 entries: [(4294967293, "products")]
WARNING:  ParadeDB: Analyzing target entry 1 (resno: 1)
WARNING:  ParadeDB: Found Var in target entry 1 - varno: -3, attno: 1, varnosyn: 1, varattnosyn: 2
WARNING:  ParadeDB: Variable references INDEX/intermediate result, using varnosyn: 1, varattnosyn: 2
WARNING:  ParadeDB: Mapping original variable varnosyn: 1, varattnosyn: 2 to relation
WARNING:  ParadeDB: Using stored relation OIDs from join state - outer: products, inner: reviews
WARNING:  ParadeDB: varnosyn 1 mapped to outer relation products (attno 2)
WARNING:  ParadeDB: Relation products attno 2 -> column name 'name'
WARNING:  ParadeDB: Target entry 1 mapped to: RelationColumn { relid: 114278, column_name: "name" }
WARNING:  ParadeDB: Analyzing target entry 2 (resno: 2)
WARNING:  ParadeDB: Found Var in target entry 2 - varno: -3, attno: 2, varnosyn: 2, varattnosyn: 3
WARNING:  ParadeDB: Variable references INDEX/intermediate result, using varnosyn: 2, varattnosyn: 3
WARNING:  ParadeDB: Mapping original variable varnosyn: 2, varattnosyn: 3 to relation
WARNING:  ParadeDB: Using stored relation OIDs from join state - outer: products, inner: reviews
WARNING:  ParadeDB: varnosyn 2 mapped to inner relation reviews (attno 3)
WARNING:  ParadeDB: Relation reviews attno 3 -> column name 'reviewer_name'
WARNING:  ParadeDB: Target entry 2 mapped to: RelationColumn { relid: 114287, column_name: "reviewer_name" }
WARNING:  ParadeDB: Analyzing target entry 3 (resno: 3)
WARNING:  ParadeDB: Found Var in target entry 3 - varno: -3, attno: 3, varnosyn: 2, varattnosyn: 5
WARNING:  ParadeDB: Variable references INDEX/intermediate result, using varnosyn: 2, varattnosyn: 5
WARNING:  ParadeDB: Mapping original variable varnosyn: 2, varattnosyn: 5 to relation
WARNING:  ParadeDB: Using stored relation OIDs from join state - outer: products, inner: reviews
WARNING:  ParadeDB: varnosyn 2 mapped to inner relation reviews (attno 5)
WARNING:  ParadeDB: Relation reviews attno 5 -> column name 'rating'
WARNING:  ParadeDB: Target entry 3 mapped to: RelationColumn { relid: 114287, column_name: "rating" }
WARNING:  ParadeDB: Mapped 3 out of 3 column values: [Some("Laptop Pro"), Some("John Doe"), Some("5")]
WARNING:  ParadeDB: Created join result tuple with real heap data: [Some("Laptop Pro"), Some("John Doe"), Some("5")]
WARNING:  ParadeDB: Advanced to next outer tuple [2/3]
WARNING:  ParadeDB: Executing join step
WARNING:  ParadeDB: Performing join matching
WARNING:  ParadeDB: Matching and returning next tuple
WARNING:  ParadeDB: Standard join matching for base relations
WARNING:  ParadeDB: Processing join match [2/3] × [1/1]
WARNING:  ParadeDB: Creating join result tuple for outer[1], inner[0]
WARNING:  ParadeDB: Creating result tuple with 3 attributes
WARNING:  ParadeDB: Using stored relation OIDs from join state - outer: products, inner: reviews
WARNING:  ParadeDB: Fetching real heap tuple values from relations products and reviews
WARNING:  ParadeDB: Using stored relation OIDs from join state - outer: products, inner: reviews
WARNING:  ParadeDB: Detected relations from predicates - outer: 'products', inner: 'reviews'
WARNING:  ParadeDB: Fetching all columns with names from relation products with CTID 2
WARNING:  ParadeDB: products column 'id' = '2'
WARNING:  ParadeDB: products column 'name' = 'Wireless Mouse'
WARNING:  ParadeDB: products column 'description' = 'Ergonomic wireless mouse with precision tracking'
WARNING:  ParadeDB: products column 'category' = 'Electronics'
WARNING:  ParadeDB: Successfully fetched 4 columns from products relation
WARNING:  ParadeDB: Fetching all columns with names from relation reviews with CTID 1
WARNING:  ParadeDB: reviews column 'id' = '1'
WARNING:  ParadeDB: reviews column 'product_id' = '1'
WARNING:  ParadeDB: reviews column 'reviewer_name' = 'John Doe'
WARNING:  ParadeDB: reviews column 'review_text' = 'Excellent laptop with amazing performance and battery life'
WARNING:  ParadeDB: reviews column 'rating' = '5'
WARNING:  ParadeDB: Successfully fetched 5 columns from reviews relation
WARNING:  ParadeDB: Fetched 4 columns from outer relation, 5 from inner relation
WARNING:  ParadeDB: PLAN: Ok("{CUSTOMSCAN :scan.plan.startup_cost 100 :scan.plan.total_cost 100.018 :scan.plan.plan_rows 1.8 :scan.plan.plan_width 68 :scan.plan.parallel_aware false :scan.plan.parallel_safe false :scan.plan.async_capable false :scan.plan.plan_node_id 0 :scan.plan.targetlist ({TARGETENTRY :expr {VAR :varno -3 :varattno 1 :vartype 25 :vartypmod -1 :varcollid 100 :varnullingrels (b) :varlevelsup 0 :varnosyn 1 :varattnosyn 2 :location -1} :resno 1 :resname name :ressortgroupref 0 :resorigtbl 114278 :resorigcol 2 :resjunk false} {TARGETENTRY :expr {VAR :varno -3 :varattno 2 :vartype 25 :vartypmod -1 :varcollid 100 :varnullingrels (b) :varlevelsup 0 :varnosyn 2 :varattnosyn 3 :location -1} :resno 2 :resname reviewer_name :ressortgroupref 0 :resorigtbl 114287 :resorigcol 3 :resjunk false} {TARGETENTRY :expr {VAR :varno -3 :varattno 3 :vartype 23 :vartypmod -1 :varcollid 0 :varnullingrels (b) :varlevelsup 0 :varnosyn 2 :varattnosyn 5 :location -1} :resno 3 :resname rating :ressortgroupref 0 :resorigtbl 114287 :resorigcol 5 :resjunk false}) :scan.plan.qual <> :scan.plan.lefttree <> :scan.plan.righttree <> :scan.plan.initPlan <> :scan.plan.extParam (b) :scan.plan.allParam (b) :scan.scanrelid 0 :flags 4 :custom_plans <> :custom_exprs <> :custom_private (\"\\{\"heaprelid\":null,\"indexrelid\":null,\"range_table_index\":null,\"query\":null,\"limit\":null,\"segment_count\":0,\"sort_field\":null,\"sort_direction\":null,\"exec_method_type\":\"Normal\",\"var_attname_lookup\":[[\"1,2\",\"join_attr_1\"],[\"2,3\",\"join_attr_2\"],[\"2,5\",\"join_attr_3\"]],\"target_list_len\":3,\"planned_which_fast_fields\":null,\"referenced_columns_count\":0,\"join_search_predicates\":\\{\"outer_predicates\":[\\{\"rti\":1,\"relid\":114278,\"relname\":\"products\",\"query\":\\{\"with_index\":\\{\"oid\":114295,\"query\":\\{\"parse_with_field\":\\{\"field\":\"category\",\"query_string\":\"Electronics\",\"lenient\":null,\"conjunction_mode\":null\\}\\}\\}\\},\"uses_search_operator\":true\\}],\"inner_predicates\":[],\"join_conditions\":[]\\},\"join_outer_relid\":114278,\"join_inner_relid\":114287\\}\") :custom_scan_tlist ({TARGETENTRY :expr {VAR :varno 1 :varattno 2 :vartype 25 :vartypmod -1 :varcollid 100 :varnullingrels (b) :varlevelsup 0 :varnosyn 1 :varattnosyn 2 :location -1} :resno 1 :resname name :ressortgroupref 0 :resorigtbl 114278 :resorigcol 2 :resjunk false} {TARGETENTRY :expr {VAR :varno 2 :varattno 3 :vartype 25 :vartypmod -1 :varcollid 100 :varnullingrels (b) :varlevelsup 0 :varnosyn 2 :varattnosyn 3 :location -1} :resno 2 :resname reviewer_name :ressortgroupref 0 :resorigtbl 114287 :resorigcol 3 :resjunk false} {TARGETENTRY :expr {VAR :varno 2 :varattno 5 :vartype 23 :vartypmod -1 :varcollid 0 :varnullingrels (b) :varlevelsup 0 :varnosyn 2 :varattnosyn 5 :location -1} :resno 3 :resname rating :ressortgroupref 0 :resorigtbl 114287 :resorigcol 5 :resjunk false}) :custom_relids (b 1 2) :methods ParadeDB\\ Scan}")
WARNING:  ParadeDB: Analyzing 3 target entries using execution-time varno/attno mapping: [(1, Some((Ok("{VAR :varno -3 :varattno 1 :vartype 25 :vartypmod -1 :varcollid 100 :varnullingrels (b) :varlevelsup 0 :varnosyn 1 :varattnosyn 2 :location -1}"),))), (2, Some((Ok("{VAR :varno -3 :varattno 2 :vartype 25 :vartypmod -1 :varcollid 100 :varnullingrels (b) :varlevelsup 0 :varnosyn 2 :varattnosyn 3 :location -1}"),))), (3, Some((Ok("{VAR :varno -3 :varattno 3 :vartype 23 :vartypmod -1 :varcollid 0 :varnullingrels (b) :varlevelsup 0 :varnosyn 2 :varattnosyn 5 :location -1}"),)))]
WARNING:  ParadeDB: Mapped varno 4294967293 to outer relation products
WARNING:  ParadeDB: Built execution-time varno mapping with 1 entries: [(4294967293, "products")]
WARNING:  ParadeDB: Analyzing target entry 1 (resno: 1)
WARNING:  ParadeDB: Found Var in target entry 1 - varno: -3, attno: 1, varnosyn: 1, varattnosyn: 2
WARNING:  ParadeDB: Variable references INDEX/intermediate result, using varnosyn: 1, varattnosyn: 2
WARNING:  ParadeDB: Mapping original variable varnosyn: 1, varattnosyn: 2 to relation
WARNING:  ParadeDB: Using stored relation OIDs from join state - outer: products, inner: reviews
WARNING:  ParadeDB: varnosyn 1 mapped to outer relation products (attno 2)
WARNING:  ParadeDB: Relation products attno 2 -> column name 'name'
WARNING:  ParadeDB: Target entry 1 mapped to: RelationColumn { relid: 114278, column_name: "name" }
WARNING:  ParadeDB: Analyzing target entry 2 (resno: 2)
WARNING:  ParadeDB: Found Var in target entry 2 - varno: -3, attno: 2, varnosyn: 2, varattnosyn: 3
WARNING:  ParadeDB: Variable references INDEX/intermediate result, using varnosyn: 2, varattnosyn: 3
WARNING:  ParadeDB: Mapping original variable varnosyn: 2, varattnosyn: 3 to relation
WARNING:  ParadeDB: Using stored relation OIDs from join state - outer: products, inner: reviews
WARNING:  ParadeDB: varnosyn 2 mapped to inner relation reviews (attno 3)
WARNING:  ParadeDB: Relation reviews attno 3 -> column name 'reviewer_name'
WARNING:  ParadeDB: Target entry 2 mapped to: RelationColumn { relid: 114287, column_name: "reviewer_name" }
WARNING:  ParadeDB: Analyzing target entry 3 (resno: 3)
WARNING:  ParadeDB: Found Var in target entry 3 - varno: -3, attno: 3, varnosyn: 2, varattnosyn: 5
WARNING:  ParadeDB: Variable references INDEX/intermediate result, using varnosyn: 2, varattnosyn: 5
WARNING:  ParadeDB: Mapping original variable varnosyn: 2, varattnosyn: 5 to relation
WARNING:  ParadeDB: Using stored relation OIDs from join state - outer: products, inner: reviews
WARNING:  ParadeDB: varnosyn 2 mapped to inner relation reviews (attno 5)
WARNING:  ParadeDB: Relation reviews attno 5 -> column name 'rating'
WARNING:  ParadeDB: Target entry 3 mapped to: RelationColumn { relid: 114287, column_name: "rating" }
WARNING:  ParadeDB: Mapped 3 out of 3 column values: [Some("Wireless Mouse"), Some("John Doe"), Some("5")]
WARNING:  ParadeDB: Created join result tuple with real heap data: [Some("Wireless Mouse"), Some("John Doe"), Some("5")]
WARNING:  ParadeDB: Advanced to next outer tuple [3/3]
WARNING:  ParadeDB: Executing join step
WARNING:  ParadeDB: Performing join matching
WARNING:  ParadeDB: Matching and returning next tuple
WARNING:  ParadeDB: Standard join matching for base relations
WARNING:  ParadeDB: Processing join match [3/3] × [1/1]
WARNING:  ParadeDB: Creating join result tuple for outer[2], inner[0]
WARNING:  ParadeDB: Creating result tuple with 3 attributes
WARNING:  ParadeDB: Using stored relation OIDs from join state - outer: products, inner: reviews
WARNING:  ParadeDB: Fetching real heap tuple values from relations products and reviews
WARNING:  ParadeDB: Using stored relation OIDs from join state - outer: products, inner: reviews
WARNING:  ParadeDB: Detected relations from predicates - outer: 'products', inner: 'reviews'
WARNING:  ParadeDB: Fetching all columns with names from relation products with CTID 5
WARNING:  ParadeDB: products column 'id' = '5'
WARNING:  ParadeDB: products column 'name' = 'Smartphone X'
WARNING:  ParadeDB: products column 'description' = 'Latest smartphone with cutting-edge technology'
WARNING:  ParadeDB: products column 'category' = 'Electronics'
WARNING:  ParadeDB: Successfully fetched 4 columns from products relation
WARNING:  ParadeDB: Fetching all columns with names from relation reviews with CTID 1
WARNING:  ParadeDB: reviews column 'id' = '1'
WARNING:  ParadeDB: reviews column 'product_id' = '1'
WARNING:  ParadeDB: reviews column 'reviewer_name' = 'John Doe'
WARNING:  ParadeDB: reviews column 'review_text' = 'Excellent laptop with amazing performance and battery life'
WARNING:  ParadeDB: reviews column 'rating' = '5'
WARNING:  ParadeDB: Successfully fetched 5 columns from reviews relation
WARNING:  ParadeDB: Fetched 4 columns from outer relation, 5 from inner relation
WARNING:  ParadeDB: PLAN: Ok("{CUSTOMSCAN :scan.plan.startup_cost 100 :scan.plan.total_cost 100.018 :scan.plan.plan_rows 1.8 :scan.plan.plan_width 68 :scan.plan.parallel_aware false :scan.plan.parallel_safe false :scan.plan.async_capable false :scan.plan.plan_node_id 0 :scan.plan.targetlist ({TARGETENTRY :expr {VAR :varno -3 :varattno 1 :vartype 25 :vartypmod -1 :varcollid 100 :varnullingrels (b) :varlevelsup 0 :varnosyn 1 :varattnosyn 2 :location -1} :resno 1 :resname name :ressortgroupref 0 :resorigtbl 114278 :resorigcol 2 :resjunk false} {TARGETENTRY :expr {VAR :varno -3 :varattno 2 :vartype 25 :vartypmod -1 :varcollid 100 :varnullingrels (b) :varlevelsup 0 :varnosyn 2 :varattnosyn 3 :location -1} :resno 2 :resname reviewer_name :ressortgroupref 0 :resorigtbl 114287 :resorigcol 3 :resjunk false} {TARGETENTRY :expr {VAR :varno -3 :varattno 3 :vartype 23 :vartypmod -1 :varcollid 0 :varnullingrels (b) :varlevelsup 0 :varnosyn 2 :varattnosyn 5 :location -1} :resno 3 :resname rating :ressortgroupref 0 :resorigtbl 114287 :resorigcol 5 :resjunk false}) :scan.plan.qual <> :scan.plan.lefttree <> :scan.plan.righttree <> :scan.plan.initPlan <> :scan.plan.extParam (b) :scan.plan.allParam (b) :scan.scanrelid 0 :flags 4 :custom_plans <> :custom_exprs <> :custom_private (\"\\{\"heaprelid\":null,\"indexrelid\":null,\"range_table_index\":null,\"query\":null,\"limit\":null,\"segment_count\":0,\"sort_field\":null,\"sort_direction\":null,\"exec_method_type\":\"Normal\",\"var_attname_lookup\":[[\"1,2\",\"join_attr_1\"],[\"2,3\",\"join_attr_2\"],[\"2,5\",\"join_attr_3\"]],\"target_list_len\":3,\"planned_which_fast_fields\":null,\"referenced_columns_count\":0,\"join_search_predicates\":\\{\"outer_predicates\":[\\{\"rti\":1,\"relid\":114278,\"relname\":\"products\",\"query\":\\{\"with_index\":\\{\"oid\":114295,\"query\":\\{\"parse_with_field\":\\{\"field\":\"category\",\"query_string\":\"Electronics\",\"lenient\":null,\"conjunction_mode\":null\\}\\}\\}\\},\"uses_search_operator\":true\\}],\"inner_predicates\":[],\"join_conditions\":[]\\},\"join_outer_relid\":114278,\"join_inner_relid\":114287\\}\") :custom_scan_tlist ({TARGETENTRY :expr {VAR :varno 1 :varattno 2 :vartype 25 :vartypmod -1 :varcollid 100 :varnullingrels (b) :varlevelsup 0 :varnosyn 1 :varattnosyn 2 :location -1} :resno 1 :resname name :ressortgroupref 0 :resorigtbl 114278 :resorigcol 2 :resjunk false} {TARGETENTRY :expr {VAR :varno 2 :varattno 3 :vartype 25 :vartypmod -1 :varcollid 100 :varnullingrels (b) :varlevelsup 0 :varnosyn 2 :varattnosyn 3 :location -1} :resno 2 :resname reviewer_name :ressortgroupref 0 :resorigtbl 114287 :resorigcol 3 :resjunk false} {TARGETENTRY :expr {VAR :varno 2 :varattno 5 :vartype 23 :vartypmod -1 :varcollid 0 :varnullingrels (b) :varlevelsup 0 :varnosyn 2 :varattnosyn 5 :location -1} :resno 3 :resname rating :ressortgroupref 0 :resorigtbl 114287 :resorigcol 5 :resjunk false}) :custom_relids (b 1 2) :methods ParadeDB\\ Scan}")
WARNING:  ParadeDB: Analyzing 3 target entries using execution-time varno/attno mapping: [(1, Some((Ok("{VAR :varno -3 :varattno 1 :vartype 25 :vartypmod -1 :varcollid 100 :varnullingrels (b) :varlevelsup 0 :varnosyn 1 :varattnosyn 2 :location -1}"),))), (2, Some((Ok("{VAR :varno -3 :varattno 2 :vartype 25 :vartypmod -1 :varcollid 100 :varnullingrels (b) :varlevelsup 0 :varnosyn 2 :varattnosyn 3 :location -1}"),))), (3, Some((Ok("{VAR :varno -3 :varattno 3 :vartype 23 :vartypmod -1 :varcollid 0 :varnullingrels (b) :varlevelsup 0 :varnosyn 2 :varattnosyn 5 :location -1}"),)))]
WARNING:  ParadeDB: Mapped varno 4294967293 to outer relation products
WARNING:  ParadeDB: Built execution-time varno mapping with 1 entries: [(4294967293, "products")]
WARNING:  ParadeDB: Analyzing target entry 1 (resno: 1)
WARNING:  ParadeDB: Found Var in target entry 1 - varno: -3, attno: 1, varnosyn: 1, varattnosyn: 2
WARNING:  ParadeDB: Variable references INDEX/intermediate result, using varnosyn: 1, varattnosyn: 2
WARNING:  ParadeDB: Mapping original variable varnosyn: 1, varattnosyn: 2 to relation
WARNING:  ParadeDB: Using stored relation OIDs from join state - outer: products, inner: reviews
WARNING:  ParadeDB: varnosyn 1 mapped to outer relation products (attno 2)
WARNING:  ParadeDB: Relation products attno 2 -> column name 'name'
WARNING:  ParadeDB: Target entry 1 mapped to: RelationColumn { relid: 114278, column_name: "name" }
WARNING:  ParadeDB: Analyzing target entry 2 (resno: 2)
WARNING:  ParadeDB: Found Var in target entry 2 - varno: -3, attno: 2, varnosyn: 2, varattnosyn: 3
WARNING:  ParadeDB: Variable references INDEX/intermediate result, using varnosyn: 2, varattnosyn: 3
WARNING:  ParadeDB: Mapping original variable varnosyn: 2, varattnosyn: 3 to relation
WARNING:  ParadeDB: Using stored relation OIDs from join state - outer: products, inner: reviews
WARNING:  ParadeDB: varnosyn 2 mapped to inner relation reviews (attno 3)
WARNING:  ParadeDB: Relation reviews attno 3 -> column name 'reviewer_name'
WARNING:  ParadeDB: Target entry 2 mapped to: RelationColumn { relid: 114287, column_name: "reviewer_name" }
WARNING:  ParadeDB: Analyzing target entry 3 (resno: 3)
WARNING:  ParadeDB: Found Var in target entry 3 - varno: -3, attno: 3, varnosyn: 2, varattnosyn: 5
WARNING:  ParadeDB: Variable references INDEX/intermediate result, using varnosyn: 2, varattnosyn: 5
WARNING:  ParadeDB: Mapping original variable varnosyn: 2, varattnosyn: 5 to relation
WARNING:  ParadeDB: Using stored relation OIDs from join state - outer: products, inner: reviews
WARNING:  ParadeDB: varnosyn 2 mapped to inner relation reviews (attno 5)
WARNING:  ParadeDB: Relation reviews attno 5 -> column name 'rating'
WARNING:  ParadeDB: Target entry 3 mapped to: RelationColumn { relid: 114287, column_name: "rating" }
WARNING:  ParadeDB: Mapped 3 out of 3 column values: [Some("Smartphone X"), Some("John Doe"), Some("5")]
WARNING:  ParadeDB: Created join result tuple with real heap data: [Some("Smartphone X"), Some("John Doe"), Some("5")]
WARNING:  ParadeDB: Executing join step
WARNING:  ParadeDB: Performing join matching
WARNING:  ParadeDB: Matching and returning next tuple
WARNING:  ParadeDB: Standard join matching for base relations
WARNING:  ParadeDB: Join matching complete - total matches: 3
WARNING:  ParadeDB: Cleaning up join execution
WARNING:  ParadeDB: Cleaning up join execution state
WARNING:  ParadeDB: ===== JOIN EXECUTION STATISTICS =====
WARNING:  ParadeDB: Search Results - Outer: 3, Inner: 1, Total Combinations: 3
WARNING:  ParadeDB: Join Processing - Matches: 3, Returned: 3, Success Rate: 100.0%
WARNING:  ParadeDB: Heap Tuple Access - Attempts: 6, Successes: 9, Success Rate: 150.0%
WARNING:  ParadeDB: Cleaned up 1 search readers
WARNING:  ParadeDB: Cleared 3 outer and 1 inner search results
WARNING:  ParadeDB: ===== END JOIN EXECUTION STATISTICS =====
WARNING:  ParadeDB: Join execution cleanup complete
      name      | reviewer_name |   rating   
----------------+---------------+------------
 Laptop Pro     | John Doe      | 1342394832
 Wireless Mouse | John Doe      | 1342403344
 Smartphone X   | John Doe      | 1342422480
(3 rows)

-- Test 3: Complex search with multiple terms
SELECT p.name, p.description, r.review_text
FROM products p
JOIN reviews r ON p.id = r.product_id
WHERE p.description @@@ 'wireless OR smartphone' AND r.review_text @@@ 'amazing OR perfect';
WARNING:  ParadeDB: Join pathlist callback called - jointype: 0, outer relids: ["products"], inner relids: ["reviews"]
WARNING:  ParadeDB: Found BM25 index for relation products (rti 1)
WARNING:  ParadeDB: Checked relations ["products"] for BM25 indexes, found: true
WARNING:  ParadeDB: Found BM25 index for relation reviews (rti 2)
WARNING:  ParadeDB: Checked relations ["reviews"] for BM25 indexes, found: true
WARNING:  ParadeDB: Join feasibility check - outer has BM25: true, inner has BM25: true
WARNING:  ParadeDB: Analyzing join search predicates
WARNING:  ParadeDB: Found 1 join restriction clauses
WARNING:  ParadeDB: Analyzing join clause of type T_OpExpr
WARNING:  ParadeDB: Analyzing 1 base restriction clauses for relation
WARNING:  ParadeDB: Extracting predicates for relation products (rti 1)
WARNING:  ParadeDB: Extracted search query for products: uses_search_operator=true
WARNING:  ParadeDB: Analyzing 1 base restriction clauses for relation
WARNING:  ParadeDB: Extracting predicates for relation reviews (rti 2)
WARNING:  ParadeDB: Extracted search query for reviews: uses_search_operator=true
WARNING:  ParadeDB: Extracted 1 outer predicates, 1 inner predicates, 0 join conditions
WARNING:  ParadeDB: Found search predicates - outer: 1, inner: 1, bilateral: true
WARNING:  ParadeDB: Join is feasible - outer feasible: true, inner feasible: true
WARNING:  ParadeDB: Outer predicate for products - uses_search: true
WARNING:  ParadeDB: Inner predicate for reviews - uses_search: true
WARNING:  ParadeDB: Bilateral search detected - proceeding with custom join path
WARNING:  ParadeDB: Storing join relation OIDs - outer: ["products"], inner: ["reviews"]
WARNING:  ParadeDB: Join path estimates - rows: 1, startup_cost: 100.00, total_cost: 100.01
WARNING:  ParadeDB: Created custom join path, adding to joinrel
WARNING:  ParadeDB: Join pathlist callback called - jointype: 0, outer relids: ["reviews"], inner relids: ["products"]
WARNING:  ParadeDB: Found BM25 index for relation reviews (rti 2)
WARNING:  ParadeDB: Checked relations ["reviews"] for BM25 indexes, found: true
WARNING:  ParadeDB: Found BM25 index for relation products (rti 1)
WARNING:  ParadeDB: Checked relations ["products"] for BM25 indexes, found: true
WARNING:  ParadeDB: Join feasibility check - outer has BM25: true, inner has BM25: true
WARNING:  ParadeDB: Analyzing join search predicates
WARNING:  ParadeDB: Found 1 join restriction clauses
WARNING:  ParadeDB: Analyzing join clause of type T_OpExpr
WARNING:  ParadeDB: Analyzing 1 base restriction clauses for relation
WARNING:  ParadeDB: Extracting predicates for relation reviews (rti 2)
WARNING:  ParadeDB: Extracted search query for reviews: uses_search_operator=true
WARNING:  ParadeDB: Analyzing 1 base restriction clauses for relation
WARNING:  ParadeDB: Extracting predicates for relation products (rti 1)
WARNING:  ParadeDB: Extracted search query for products: uses_search_operator=true
WARNING:  ParadeDB: Extracted 1 outer predicates, 1 inner predicates, 0 join conditions
WARNING:  ParadeDB: Found search predicates - outer: 1, inner: 1, bilateral: true
WARNING:  ParadeDB: Join is feasible - outer feasible: true, inner feasible: true
WARNING:  ParadeDB: Outer predicate for reviews - uses_search: true
WARNING:  ParadeDB: Inner predicate for products - uses_search: true
WARNING:  ParadeDB: Bilateral search detected - proceeding with custom join path
WARNING:  ParadeDB: Storing join relation OIDs - outer: ["reviews"], inner: ["products"]
WARNING:  ParadeDB: Join path estimates - rows: 1, startup_cost: 100.00, total_cost: 100.01
WARNING:  ParadeDB: Created custom join path, adding to joinrel
WARNING:  ParadeDB: Planning custom join path with scanrelid = 0
WARNING:  ParadeDB: Join target list has 3 entries
WARNING:  ParadeDB: Mapped join variable varno=1, varattno=2 to 'join_attr_1'
WARNING:  ParadeDB: Mapped join variable varno=1, varattno=3 to 'join_attr_2'
WARNING:  ParadeDB: Mapped join variable varno=2, varattno=4 to 'join_attr_3'
WARNING:  ParadeDB: Set custom scan target list for join node
WARNING:  ParadeDB: Creating custom scan state for join node (scanrelid = 0)
WARNING:  ParadeDB: Extracted search predicates from private data - outer: 1, inner: 1, bilateral: true
WARNING:  ParadeDB: Stored outer relation OID: products
WARNING:  ParadeDB: Stored inner relation OID: reviews
WARNING:  ParadeDB: Storing 3 variable mappings from planning phase
WARNING:  ParadeDB: Planning-time mapping: varno=1, attno=2 -> 'join_attr_1'
WARNING:  ParadeDB: Planning-time mapping: varno=2, attno=4 -> 'join_attr_3'
WARNING:  ParadeDB: Planning-time mapping: varno=1, attno=3 -> 'join_attr_2'
WARNING:  ParadeDB: Beginning custom scan for join node
WARNING:  ParadeDB: Initializing join execution (simplified)
WARNING:  ParadeDB: Using stored search predicates - outer: 1, inner: 1, bilateral: true
WARNING:  ParadeDB: Join execution initialization complete
WARNING:  ParadeDB: Executing join step
WARNING:  ParadeDB: Starting join execution - initializing search
WARNING:  ParadeDB: Initializing search execution for join
WARNING:  ParadeDB: Retrieved search predicates from join state - outer: 1, inner: 1
WARNING:  ParadeDB: Initializing search readers for join relations
WARNING:  ParadeDB: Opening search reader for outer relation products
WARNING:  ParadeDB: Successfully opened search reader for products
WARNING:  ParadeDB: Opening search reader for inner relation reviews
WARNING:  ParadeDB: Successfully opened search reader for reviews
WARNING:  ParadeDB: Initialized 2 search readers
WARNING:  ParadeDB: Executing real searches on join relations
WARNING:  ParadeDB: Executing search on outer relation products
WARNING:  ParadeDB: Executing real BM25 search on relation products
WARNING:  ParadeDB: Real search on products returned 2 results
WARNING:  ParadeDB: Found 2 results for outer relation products
WARNING:  ParadeDB: Executing search on inner relation reviews
WARNING:  ParadeDB: Executing real BM25 search on relation reviews
WARNING:  ParadeDB: Real search on reviews returned 3 results
WARNING:  ParadeDB: Found 3 results for inner relation reviews
WARNING:  ParadeDB: Completed real search execution - outer: 2, inner: 3
WARNING:  ParadeDB: Executing join step
WARNING:  ParadeDB: Executing outer search
WARNING:  ParadeDB: Executing search on outer relation
WARNING:  ParadeDB: Outer search completed - 2 results
WARNING:  ParadeDB: Executing join step
WARNING:  ParadeDB: Executing inner search
WARNING:  ParadeDB: Executing search on inner relation
WARNING:  ParadeDB: Inner search completed - 3 results
WARNING:  ParadeDB: Executing join step
WARNING:  ParadeDB: Performing join matching
WARNING:  ParadeDB: Matching and returning next tuple
WARNING:  ParadeDB: Standard join matching for base relations
WARNING:  ParadeDB: Processing join match [1/2] × [1/3]
WARNING:  ParadeDB: Creating join result tuple for outer[0], inner[0]
WARNING:  ParadeDB: Creating result tuple with 3 attributes
WARNING:  ParadeDB: Using stored relation OIDs from join state - outer: products, inner: reviews
WARNING:  ParadeDB: Fetching real heap tuple values from relations products and reviews
WARNING:  ParadeDB: Using stored relation OIDs from join state - outer: products, inner: reviews
WARNING:  ParadeDB: Detected relations from predicates - outer: 'products', inner: 'reviews'
WARNING:  ParadeDB: Fetching all columns with names from relation products with CTID 2
WARNING:  ParadeDB: products column 'id' = '2'
WARNING:  ParadeDB: products column 'name' = 'Wireless Mouse'
WARNING:  ParadeDB: products column 'description' = 'Ergonomic wireless mouse with precision tracking'
WARNING:  ParadeDB: products column 'category' = 'Electronics'
WARNING:  ParadeDB: Successfully fetched 4 columns from products relation
WARNING:  ParadeDB: Fetching all columns with names from relation reviews with CTID 1
WARNING:  ParadeDB: reviews column 'id' = '1'
WARNING:  ParadeDB: reviews column 'product_id' = '1'
WARNING:  ParadeDB: reviews column 'reviewer_name' = 'John Doe'
WARNING:  ParadeDB: reviews column 'review_text' = 'Excellent laptop with amazing performance and battery life'
WARNING:  ParadeDB: reviews column 'rating' = '5'
WARNING:  ParadeDB: Successfully fetched 5 columns from reviews relation
WARNING:  ParadeDB: Fetched 4 columns from outer relation, 5 from inner relation
WARNING:  ParadeDB: PLAN: Ok("{CUSTOMSCAN :scan.plan.startup_cost 100 :scan.plan.total_cost 100.01 :scan.plan.plan_rows 1 :scan.plan.plan_width 96 :scan.plan.parallel_aware false :scan.plan.parallel_safe false :scan.plan.async_capable false :scan.plan.plan_node_id 0 :scan.plan.targetlist ({TARGETENTRY :expr {VAR :varno -3 :varattno 1 :vartype 25 :vartypmod -1 :varcollid 100 :varnullingrels (b) :varlevelsup 0 :varnosyn 1 :varattnosyn 2 :location -1} :resno 1 :resname name :ressortgroupref 0 :resorigtbl 114278 :resorigcol 2 :resjunk false} {TARGETENTRY :expr {VAR :varno -3 :varattno 2 :vartype 25 :vartypmod -1 :varcollid 100 :varnullingrels (b) :varlevelsup 0 :varnosyn 1 :varattnosyn 3 :location -1} :resno 2 :resname description :ressortgroupref 0 :resorigtbl 114278 :resorigcol 3 :resjunk false} {TARGETENTRY :expr {VAR :varno -3 :varattno 3 :vartype 25 :vartypmod -1 :varcollid 100 :varnullingrels (b) :varlevelsup 0 :varnosyn 2 :varattnosyn 4 :location -1} :resno 3 :resname review_text :ressortgroupref 0 :resorigtbl 114287 :resorigcol 4 :resjunk false}) :scan.plan.qual <> :scan.plan.lefttree <> :scan.plan.righttree <> :scan.plan.initPlan <> :scan.plan.extParam (b) :scan.plan.allParam (b) :scan.scanrelid 0 :flags 4 :custom_plans <> :custom_exprs <> :custom_private (\"\\{\"heaprelid\":null,\"indexrelid\":null,\"range_table_index\":null,\"query\":null,\"limit\":null,\"segment_count\":0,\"sort_field\":null,\"sort_direction\":null,\"exec_method_type\":\"Normal\",\"var_attname_lookup\":[[\"1,2\",\"join_attr_1\"],[\"2,4\",\"join_attr_3\"],[\"1,3\",\"join_attr_2\"]],\"target_list_len\":3,\"planned_which_fast_fields\":null,\"referenced_columns_count\":0,\"join_search_predicates\":\\{\"outer_predicates\":[\\{\"rti\":1,\"relid\":114278,\"relname\":\"products\",\"query\":\\{\"with_index\":\\{\"oid\":114295,\"query\":\\{\"parse_with_field\":\\{\"field\":\"description\",\"query_string\":\"wireless\\ OR\\ smartphone\",\"lenient\":null,\"conjunction_mode\":null\\}\\}\\}\\},\"uses_search_operator\":true\\}],\"inner_predicates\":[\\{\"rti\":2,\"relid\":114287,\"relname\":\"reviews\",\"query\":\\{\"with_index\":\\{\"oid\":114296,\"query\":\\{\"parse_with_field\":\\{\"field\":\"review_text\",\"query_string\":\"amazing\\ OR\\ perfect\",\"lenient\":null,\"conjunction_mode\":null\\}\\}\\}\\},\"uses_search_operator\":true\\}],\"join_conditions\":[]\\},\"join_outer_relid\":114278,\"join_inner_relid\":114287\\}\") :custom_scan_tlist ({TARGETENTRY :expr {VAR :varno 1 :varattno 2 :vartype 25 :vartypmod -1 :varcollid 100 :varnullingrels (b) :varlevelsup 0 :varnosyn 1 :varattnosyn 2 :location -1} :resno 1 :resname name :ressortgroupref 0 :resorigtbl 114278 :resorigcol 2 :resjunk false} {TARGETENTRY :expr {VAR :varno 1 :varattno 3 :vartype 25 :vartypmod -1 :varcollid 100 :varnullingrels (b) :varlevelsup 0 :varnosyn 1 :varattnosyn 3 :location -1} :resno 2 :resname description :ressortgroupref 0 :resorigtbl 114278 :resorigcol 3 :resjunk false} {TARGETENTRY :expr {VAR :varno 2 :varattno 4 :vartype 25 :vartypmod -1 :varcollid 100 :varnullingrels (b) :varlevelsup 0 :varnosyn 2 :varattnosyn 4 :location -1} :resno 3 :resname review_text :ressortgroupref 0 :resorigtbl 114287 :resorigcol 4 :resjunk false}) :custom_relids (b 1 2) :methods ParadeDB\\ Scan}")
WARNING:  ParadeDB: Analyzing 3 target entries using execution-time varno/attno mapping: [(1, Some((Ok("{VAR :varno -3 :varattno 1 :vartype 25 :vartypmod -1 :varcollid 100 :varnullingrels (b) :varlevelsup 0 :varnosyn 1 :varattnosyn 2 :location -1}"),))), (2, Some((Ok("{VAR :varno -3 :varattno 2 :vartype 25 :vartypmod -1 :varcollid 100 :varnullingrels (b) :varlevelsup 0 :varnosyn 1 :varattnosyn 3 :location -1}"),))), (3, Some((Ok("{VAR :varno -3 :varattno 3 :vartype 25 :vartypmod -1 :varcollid 100 :varnullingrels (b) :varlevelsup 0 :varnosyn 2 :varattnosyn 4 :location -1}"),)))]
WARNING:  ParadeDB: Mapped varno 4294967293 to outer relation products
WARNING:  ParadeDB: Built execution-time varno mapping with 1 entries: [(4294967293, "products")]
WARNING:  ParadeDB: Analyzing target entry 1 (resno: 1)
WARNING:  ParadeDB: Found Var in target entry 1 - varno: -3, attno: 1, varnosyn: 1, varattnosyn: 2
WARNING:  ParadeDB: Variable references INDEX/intermediate result, using varnosyn: 1, varattnosyn: 2
WARNING:  ParadeDB: Mapping original variable varnosyn: 1, varattnosyn: 2 to relation
WARNING:  ParadeDB: Using stored relation OIDs from join state - outer: products, inner: reviews
WARNING:  ParadeDB: varnosyn 1 mapped to outer relation products (attno 2)
WARNING:  ParadeDB: Relation products attno 2 -> column name 'name'
WARNING:  ParadeDB: Target entry 1 mapped to: RelationColumn { relid: 114278, column_name: "name" }
WARNING:  ParadeDB: Analyzing target entry 2 (resno: 2)
WARNING:  ParadeDB: Found Var in target entry 2 - varno: -3, attno: 2, varnosyn: 1, varattnosyn: 3
WARNING:  ParadeDB: Variable references INDEX/intermediate result, using varnosyn: 1, varattnosyn: 3
WARNING:  ParadeDB: Mapping original variable varnosyn: 1, varattnosyn: 3 to relation
WARNING:  ParadeDB: Using stored relation OIDs from join state - outer: products, inner: reviews
WARNING:  ParadeDB: varnosyn 1 mapped to outer relation products (attno 3)
WARNING:  ParadeDB: Relation products attno 3 -> column name 'description'
WARNING:  ParadeDB: Target entry 2 mapped to: RelationColumn { relid: 114278, column_name: "description" }
WARNING:  ParadeDB: Analyzing target entry 3 (resno: 3)
WARNING:  ParadeDB: Found Var in target entry 3 - varno: -3, attno: 3, varnosyn: 2, varattnosyn: 4
WARNING:  ParadeDB: Variable references INDEX/intermediate result, using varnosyn: 2, varattnosyn: 4
WARNING:  ParadeDB: Mapping original variable varnosyn: 2, varattnosyn: 4 to relation
WARNING:  ParadeDB: Using stored relation OIDs from join state - outer: products, inner: reviews
WARNING:  ParadeDB: varnosyn 2 mapped to inner relation reviews (attno 4)
WARNING:  ParadeDB: Relation reviews attno 4 -> column name 'review_text'
WARNING:  ParadeDB: Target entry 3 mapped to: RelationColumn { relid: 114287, column_name: "review_text" }
WARNING:  ParadeDB: Mapped 3 out of 3 column values: [Some("Wireless Mouse"), Some("Ergonomic wireless mouse with precision tracking"), Some("Excellent laptop with amazing performance and battery life")]
WARNING:  ParadeDB: Created join result tuple with real heap data: [Some("Wireless Mouse"), Some("Ergonomic wireless mouse with precision tracking"), Some("Excellent laptop with amazing performance and battery life")]
WARNING:  ParadeDB: Executing join step
WARNING:  ParadeDB: Performing join matching
WARNING:  ParadeDB: Matching and returning next tuple
WARNING:  ParadeDB: Standard join matching for base relations
WARNING:  ParadeDB: Processing join match [1/2] × [2/3]
WARNING:  ParadeDB: Creating join result tuple for outer[0], inner[1]
WARNING:  ParadeDB: Creating result tuple with 3 attributes
WARNING:  ParadeDB: Using stored relation OIDs from join state - outer: products, inner: reviews
WARNING:  ParadeDB: Fetching real heap tuple values from relations products and reviews
WARNING:  ParadeDB: Using stored relation OIDs from join state - outer: products, inner: reviews
WARNING:  ParadeDB: Detected relations from predicates - outer: 'products', inner: 'reviews'
WARNING:  ParadeDB: Fetching all columns with names from relation products with CTID 2
WARNING:  ParadeDB: products column 'id' = '2'
WARNING:  ParadeDB: products column 'name' = 'Wireless Mouse'
WARNING:  ParadeDB: products column 'description' = 'Ergonomic wireless mouse with precision tracking'
WARNING:  ParadeDB: products column 'category' = 'Electronics'
WARNING:  ParadeDB: Successfully fetched 4 columns from products relation
WARNING:  ParadeDB: Fetching all columns with names from relation reviews with CTID 3
WARNING:  ParadeDB: reviews column 'id' = '3'
WARNING:  ParadeDB: reviews column 'product_id' = '2'
WARNING:  ParadeDB: reviews column 'reviewer_name' = 'Bob Wilson'
WARNING:  ParadeDB: reviews column 'review_text' = 'Perfect wireless mouse, very responsive and comfortable'
WARNING:  ParadeDB: reviews column 'rating' = '5'
WARNING:  ParadeDB: Successfully fetched 5 columns from reviews relation
WARNING:  ParadeDB: Fetched 4 columns from outer relation, 5 from inner relation
WARNING:  ParadeDB: PLAN: Ok("{CUSTOMSCAN :scan.plan.startup_cost 100 :scan.plan.total_cost 100.01 :scan.plan.plan_rows 1 :scan.plan.plan_width 96 :scan.plan.parallel_aware false :scan.plan.parallel_safe false :scan.plan.async_capable false :scan.plan.plan_node_id 0 :scan.plan.targetlist ({TARGETENTRY :expr {VAR :varno -3 :varattno 1 :vartype 25 :vartypmod -1 :varcollid 100 :varnullingrels (b) :varlevelsup 0 :varnosyn 1 :varattnosyn 2 :location -1} :resno 1 :resname name :ressortgroupref 0 :resorigtbl 114278 :resorigcol 2 :resjunk false} {TARGETENTRY :expr {VAR :varno -3 :varattno 2 :vartype 25 :vartypmod -1 :varcollid 100 :varnullingrels (b) :varlevelsup 0 :varnosyn 1 :varattnosyn 3 :location -1} :resno 2 :resname description :ressortgroupref 0 :resorigtbl 114278 :resorigcol 3 :resjunk false} {TARGETENTRY :expr {VAR :varno -3 :varattno 3 :vartype 25 :vartypmod -1 :varcollid 100 :varnullingrels (b) :varlevelsup 0 :varnosyn 2 :varattnosyn 4 :location -1} :resno 3 :resname review_text :ressortgroupref 0 :resorigtbl 114287 :resorigcol 4 :resjunk false}) :scan.plan.qual <> :scan.plan.lefttree <> :scan.plan.righttree <> :scan.plan.initPlan <> :scan.plan.extParam (b) :scan.plan.allParam (b) :scan.scanrelid 0 :flags 4 :custom_plans <> :custom_exprs <> :custom_private (\"\\{\"heaprelid\":null,\"indexrelid\":null,\"range_table_index\":null,\"query\":null,\"limit\":null,\"segment_count\":0,\"sort_field\":null,\"sort_direction\":null,\"exec_method_type\":\"Normal\",\"var_attname_lookup\":[[\"1,2\",\"join_attr_1\"],[\"2,4\",\"join_attr_3\"],[\"1,3\",\"join_attr_2\"]],\"target_list_len\":3,\"planned_which_fast_fields\":null,\"referenced_columns_count\":0,\"join_search_predicates\":\\{\"outer_predicates\":[\\{\"rti\":1,\"relid\":114278,\"relname\":\"products\",\"query\":\\{\"with_index\":\\{\"oid\":114295,\"query\":\\{\"parse_with_field\":\\{\"field\":\"description\",\"query_string\":\"wireless\\ OR\\ smartphone\",\"lenient\":null,\"conjunction_mode\":null\\}\\}\\}\\},\"uses_search_operator\":true\\}],\"inner_predicates\":[\\{\"rti\":2,\"relid\":114287,\"relname\":\"reviews\",\"query\":\\{\"with_index\":\\{\"oid\":114296,\"query\":\\{\"parse_with_field\":\\{\"field\":\"review_text\",\"query_string\":\"amazing\\ OR\\ perfect\",\"lenient\":null,\"conjunction_mode\":null\\}\\}\\}\\},\"uses_search_operator\":true\\}],\"join_conditions\":[]\\},\"join_outer_relid\":114278,\"join_inner_relid\":114287\\}\") :custom_scan_tlist ({TARGETENTRY :expr {VAR :varno 1 :varattno 2 :vartype 25 :vartypmod -1 :varcollid 100 :varnullingrels (b) :varlevelsup 0 :varnosyn 1 :varattnosyn 2 :location -1} :resno 1 :resname name :ressortgroupref 0 :resorigtbl 114278 :resorigcol 2 :resjunk false} {TARGETENTRY :expr {VAR :varno 1 :varattno 3 :vartype 25 :vartypmod -1 :varcollid 100 :varnullingrels (b) :varlevelsup 0 :varnosyn 1 :varattnosyn 3 :location -1} :resno 2 :resname description :ressortgroupref 0 :resorigtbl 114278 :resorigcol 3 :resjunk false} {TARGETENTRY :expr {VAR :varno 2 :varattno 4 :vartype 25 :vartypmod -1 :varcollid 100 :varnullingrels (b) :varlevelsup 0 :varnosyn 2 :varattnosyn 4 :location -1} :resno 3 :resname review_text :ressortgroupref 0 :resorigtbl 114287 :resorigcol 4 :resjunk false}) :custom_relids (b 1 2) :methods ParadeDB\\ Scan}")
WARNING:  ParadeDB: Analyzing 3 target entries using execution-time varno/attno mapping: [(1, Some((Ok("{VAR :varno -3 :varattno 1 :vartype 25 :vartypmod -1 :varcollid 100 :varnullingrels (b) :varlevelsup 0 :varnosyn 1 :varattnosyn 2 :location -1}"),))), (2, Some((Ok("{VAR :varno -3 :varattno 2 :vartype 25 :vartypmod -1 :varcollid 100 :varnullingrels (b) :varlevelsup 0 :varnosyn 1 :varattnosyn 3 :location -1}"),))), (3, Some((Ok("{VAR :varno -3 :varattno 3 :vartype 25 :vartypmod -1 :varcollid 100 :varnullingrels (b) :varlevelsup 0 :varnosyn 2 :varattnosyn 4 :location -1}"),)))]
WARNING:  ParadeDB: Mapped varno 4294967293 to outer relation products
WARNING:  ParadeDB: Built execution-time varno mapping with 1 entries: [(4294967293, "products")]
WARNING:  ParadeDB: Analyzing target entry 1 (resno: 1)
WARNING:  ParadeDB: Found Var in target entry 1 - varno: -3, attno: 1, varnosyn: 1, varattnosyn: 2
WARNING:  ParadeDB: Variable references INDEX/intermediate result, using varnosyn: 1, varattnosyn: 2
WARNING:  ParadeDB: Mapping original variable varnosyn: 1, varattnosyn: 2 to relation
WARNING:  ParadeDB: Using stored relation OIDs from join state - outer: products, inner: reviews
WARNING:  ParadeDB: varnosyn 1 mapped to outer relation products (attno 2)
WARNING:  ParadeDB: Relation products attno 2 -> column name 'name'
WARNING:  ParadeDB: Target entry 1 mapped to: RelationColumn { relid: 114278, column_name: "name" }
WARNING:  ParadeDB: Analyzing target entry 2 (resno: 2)
WARNING:  ParadeDB: Found Var in target entry 2 - varno: -3, attno: 2, varnosyn: 1, varattnosyn: 3
WARNING:  ParadeDB: Variable references INDEX/intermediate result, using varnosyn: 1, varattnosyn: 3
WARNING:  ParadeDB: Mapping original variable varnosyn: 1, varattnosyn: 3 to relation
WARNING:  ParadeDB: Using stored relation OIDs from join state - outer: products, inner: reviews
WARNING:  ParadeDB: varnosyn 1 mapped to outer relation products (attno 3)
WARNING:  ParadeDB: Relation products attno 3 -> column name 'description'
WARNING:  ParadeDB: Target entry 2 mapped to: RelationColumn { relid: 114278, column_name: "description" }
WARNING:  ParadeDB: Analyzing target entry 3 (resno: 3)
WARNING:  ParadeDB: Found Var in target entry 3 - varno: -3, attno: 3, varnosyn: 2, varattnosyn: 4
WARNING:  ParadeDB: Variable references INDEX/intermediate result, using varnosyn: 2, varattnosyn: 4
WARNING:  ParadeDB: Mapping original variable varnosyn: 2, varattnosyn: 4 to relation
WARNING:  ParadeDB: Using stored relation OIDs from join state - outer: products, inner: reviews
WARNING:  ParadeDB: varnosyn 2 mapped to inner relation reviews (attno 4)
WARNING:  ParadeDB: Relation reviews attno 4 -> column name 'review_text'
WARNING:  ParadeDB: Target entry 3 mapped to: RelationColumn { relid: 114287, column_name: "review_text" }
WARNING:  ParadeDB: Mapped 3 out of 3 column values: [Some("Wireless Mouse"), Some("Ergonomic wireless mouse with precision tracking"), Some("Perfect wireless mouse, very responsive and comfortable")]
WARNING:  ParadeDB: Created join result tuple with real heap data: [Some("Wireless Mouse"), Some("Ergonomic wireless mouse with precision tracking"), Some("Perfect wireless mouse, very responsive and comfortable")]
WARNING:  ParadeDB: Executing join step
WARNING:  ParadeDB: Performing join matching
WARNING:  ParadeDB: Matching and returning next tuple
WARNING:  ParadeDB: Standard join matching for base relations
WARNING:  ParadeDB: Processing join match [1/2] × [3/3]
WARNING:  ParadeDB: Creating join result tuple for outer[0], inner[2]
WARNING:  ParadeDB: Creating result tuple with 3 attributes
WARNING:  ParadeDB: Using stored relation OIDs from join state - outer: products, inner: reviews
WARNING:  ParadeDB: Fetching real heap tuple values from relations products and reviews
WARNING:  ParadeDB: Using stored relation OIDs from join state - outer: products, inner: reviews
WARNING:  ParadeDB: Detected relations from predicates - outer: 'products', inner: 'reviews'
WARNING:  ParadeDB: Fetching all columns with names from relation products with CTID 2
WARNING:  ParadeDB: products column 'id' = '2'
WARNING:  ParadeDB: products column 'name' = 'Wireless Mouse'
WARNING:  ParadeDB: products column 'description' = 'Ergonomic wireless mouse with precision tracking'
WARNING:  ParadeDB: products column 'category' = 'Electronics'
WARNING:  ParadeDB: Successfully fetched 4 columns from products relation
WARNING:  ParadeDB: Fetching all columns with names from relation reviews with CTID 6
WARNING:  ParadeDB: reviews column 'id' = '6'
WARNING:  ParadeDB: reviews column 'product_id' = '5'
WARNING:  ParadeDB: reviews column 'reviewer_name' = 'Eva Martinez'
WARNING:  ParadeDB: reviews column 'review_text' = 'Amazing smartphone with incredible camera and performance'
WARNING:  ParadeDB: reviews column 'rating' = '5'
WARNING:  ParadeDB: Successfully fetched 5 columns from reviews relation
WARNING:  ParadeDB: Fetched 4 columns from outer relation, 5 from inner relation
WARNING:  ParadeDB: PLAN: Ok("{CUSTOMSCAN :scan.plan.startup_cost 100 :scan.plan.total_cost 100.01 :scan.plan.plan_rows 1 :scan.plan.plan_width 96 :scan.plan.parallel_aware false :scan.plan.parallel_safe false :scan.plan.async_capable false :scan.plan.plan_node_id 0 :scan.plan.targetlist ({TARGETENTRY :expr {VAR :varno -3 :varattno 1 :vartype 25 :vartypmod -1 :varcollid 100 :varnullingrels (b) :varlevelsup 0 :varnosyn 1 :varattnosyn 2 :location -1} :resno 1 :resname name :ressortgroupref 0 :resorigtbl 114278 :resorigcol 2 :resjunk false} {TARGETENTRY :expr {VAR :varno -3 :varattno 2 :vartype 25 :vartypmod -1 :varcollid 100 :varnullingrels (b) :varlevelsup 0 :varnosyn 1 :varattnosyn 3 :location -1} :resno 2 :resname description :ressortgroupref 0 :resorigtbl 114278 :resorigcol 3 :resjunk false} {TARGETENTRY :expr {VAR :varno -3 :varattno 3 :vartype 25 :vartypmod -1 :varcollid 100 :varnullingrels (b) :varlevelsup 0 :varnosyn 2 :varattnosyn 4 :location -1} :resno 3 :resname review_text :ressortgroupref 0 :resorigtbl 114287 :resorigcol 4 :resjunk false}) :scan.plan.qual <> :scan.plan.lefttree <> :scan.plan.righttree <> :scan.plan.initPlan <> :scan.plan.extParam (b) :scan.plan.allParam (b) :scan.scanrelid 0 :flags 4 :custom_plans <> :custom_exprs <> :custom_private (\"\\{\"heaprelid\":null,\"indexrelid\":null,\"range_table_index\":null,\"query\":null,\"limit\":null,\"segment_count\":0,\"sort_field\":null,\"sort_direction\":null,\"exec_method_type\":\"Normal\",\"var_attname_lookup\":[[\"1,2\",\"join_attr_1\"],[\"2,4\",\"join_attr_3\"],[\"1,3\",\"join_attr_2\"]],\"target_list_len\":3,\"planned_which_fast_fields\":null,\"referenced_columns_count\":0,\"join_search_predicates\":\\{\"outer_predicates\":[\\{\"rti\":1,\"relid\":114278,\"relname\":\"products\",\"query\":\\{\"with_index\":\\{\"oid\":114295,\"query\":\\{\"parse_with_field\":\\{\"field\":\"description\",\"query_string\":\"wireless\\ OR\\ smartphone\",\"lenient\":null,\"conjunction_mode\":null\\}\\}\\}\\},\"uses_search_operator\":true\\}],\"inner_predicates\":[\\{\"rti\":2,\"relid\":114287,\"relname\":\"reviews\",\"query\":\\{\"with_index\":\\{\"oid\":114296,\"query\":\\{\"parse_with_field\":\\{\"field\":\"review_text\",\"query_string\":\"amazing\\ OR\\ perfect\",\"lenient\":null,\"conjunction_mode\":null\\}\\}\\}\\},\"uses_search_operator\":true\\}],\"join_conditions\":[]\\},\"join_outer_relid\":114278,\"join_inner_relid\":114287\\}\") :custom_scan_tlist ({TARGETENTRY :expr {VAR :varno 1 :varattno 2 :vartype 25 :vartypmod -1 :varcollid 100 :varnullingrels (b) :varlevelsup 0 :varnosyn 1 :varattnosyn 2 :location -1} :resno 1 :resname name :ressortgroupref 0 :resorigtbl 114278 :resorigcol 2 :resjunk false} {TARGETENTRY :expr {VAR :varno 1 :varattno 3 :vartype 25 :vartypmod -1 :varcollid 100 :varnullingrels (b) :varlevelsup 0 :varnosyn 1 :varattnosyn 3 :location -1} :resno 2 :resname description :ressortgroupref 0 :resorigtbl 114278 :resorigcol 3 :resjunk false} {TARGETENTRY :expr {VAR :varno 2 :varattno 4 :vartype 25 :vartypmod -1 :varcollid 100 :varnullingrels (b) :varlevelsup 0 :varnosyn 2 :varattnosyn 4 :location -1} :resno 3 :resname review_text :ressortgroupref 0 :resorigtbl 114287 :resorigcol 4 :resjunk false}) :custom_relids (b 1 2) :methods ParadeDB\\ Scan}")
WARNING:  ParadeDB: Analyzing 3 target entries using execution-time varno/attno mapping: [(1, Some((Ok("{VAR :varno -3 :varattno 1 :vartype 25 :vartypmod -1 :varcollid 100 :varnullingrels (b) :varlevelsup 0 :varnosyn 1 :varattnosyn 2 :location -1}"),))), (2, Some((Ok("{VAR :varno -3 :varattno 2 :vartype 25 :vartypmod -1 :varcollid 100 :varnullingrels (b) :varlevelsup 0 :varnosyn 1 :varattnosyn 3 :location -1}"),))), (3, Some((Ok("{VAR :varno -3 :varattno 3 :vartype 25 :vartypmod -1 :varcollid 100 :varnullingrels (b) :varlevelsup 0 :varnosyn 2 :varattnosyn 4 :location -1}"),)))]
WARNING:  ParadeDB: Mapped varno 4294967293 to outer relation products
WARNING:  ParadeDB: Built execution-time varno mapping with 1 entries: [(4294967293, "products")]
WARNING:  ParadeDB: Analyzing target entry 1 (resno: 1)
WARNING:  ParadeDB: Found Var in target entry 1 - varno: -3, attno: 1, varnosyn: 1, varattnosyn: 2
WARNING:  ParadeDB: Variable references INDEX/intermediate result, using varnosyn: 1, varattnosyn: 2
WARNING:  ParadeDB: Mapping original variable varnosyn: 1, varattnosyn: 2 to relation
WARNING:  ParadeDB: Using stored relation OIDs from join state - outer: products, inner: reviews
WARNING:  ParadeDB: varnosyn 1 mapped to outer relation products (attno 2)
WARNING:  ParadeDB: Relation products attno 2 -> column name 'name'
WARNING:  ParadeDB: Target entry 1 mapped to: RelationColumn { relid: 114278, column_name: "name" }
WARNING:  ParadeDB: Analyzing target entry 2 (resno: 2)
WARNING:  ParadeDB: Found Var in target entry 2 - varno: -3, attno: 2, varnosyn: 1, varattnosyn: 3
WARNING:  ParadeDB: Variable references INDEX/intermediate result, using varnosyn: 1, varattnosyn: 3
WARNING:  ParadeDB: Mapping original variable varnosyn: 1, varattnosyn: 3 to relation
WARNING:  ParadeDB: Using stored relation OIDs from join state - outer: products, inner: reviews
WARNING:  ParadeDB: varnosyn 1 mapped to outer relation products (attno 3)
WARNING:  ParadeDB: Relation products attno 3 -> column name 'description'
WARNING:  ParadeDB: Target entry 2 mapped to: RelationColumn { relid: 114278, column_name: "description" }
WARNING:  ParadeDB: Analyzing target entry 3 (resno: 3)
WARNING:  ParadeDB: Found Var in target entry 3 - varno: -3, attno: 3, varnosyn: 2, varattnosyn: 4
WARNING:  ParadeDB: Variable references INDEX/intermediate result, using varnosyn: 2, varattnosyn: 4
WARNING:  ParadeDB: Mapping original variable varnosyn: 2, varattnosyn: 4 to relation
WARNING:  ParadeDB: Using stored relation OIDs from join state - outer: products, inner: reviews
WARNING:  ParadeDB: varnosyn 2 mapped to inner relation reviews (attno 4)
WARNING:  ParadeDB: Relation reviews attno 4 -> column name 'review_text'
WARNING:  ParadeDB: Target entry 3 mapped to: RelationColumn { relid: 114287, column_name: "review_text" }
WARNING:  ParadeDB: Mapped 3 out of 3 column values: [Some("Wireless Mouse"), Some("Ergonomic wireless mouse with precision tracking"), Some("Amazing smartphone with incredible camera and performance")]
WARNING:  ParadeDB: Created join result tuple with real heap data: [Some("Wireless Mouse"), Some("Ergonomic wireless mouse with precision tracking"), Some("Amazing smartphone with incredible camera and performance")]
WARNING:  ParadeDB: Advanced to next outer tuple [2/2]
WARNING:  ParadeDB: Executing join step
WARNING:  ParadeDB: Performing join matching
WARNING:  ParadeDB: Matching and returning next tuple
WARNING:  ParadeDB: Standard join matching for base relations
WARNING:  ParadeDB: Processing join match [2/2] × [1/3]
WARNING:  ParadeDB: Creating join result tuple for outer[1], inner[0]
WARNING:  ParadeDB: Creating result tuple with 3 attributes
WARNING:  ParadeDB: Using stored relation OIDs from join state - outer: products, inner: reviews
WARNING:  ParadeDB: Fetching real heap tuple values from relations products and reviews
WARNING:  ParadeDB: Using stored relation OIDs from join state - outer: products, inner: reviews
WARNING:  ParadeDB: Detected relations from predicates - outer: 'products', inner: 'reviews'
WARNING:  ParadeDB: Fetching all columns with names from relation products with CTID 5
WARNING:  ParadeDB: products column 'id' = '5'
WARNING:  ParadeDB: products column 'name' = 'Smartphone X'
WARNING:  ParadeDB: products column 'description' = 'Latest smartphone with cutting-edge technology'
WARNING:  ParadeDB: products column 'category' = 'Electronics'
WARNING:  ParadeDB: Successfully fetched 4 columns from products relation
WARNING:  ParadeDB: Fetching all columns with names from relation reviews with CTID 1
WARNING:  ParadeDB: reviews column 'id' = '1'
WARNING:  ParadeDB: reviews column 'product_id' = '1'
WARNING:  ParadeDB: reviews column 'reviewer_name' = 'John Doe'
WARNING:  ParadeDB: reviews column 'review_text' = 'Excellent laptop with amazing performance and battery life'
WARNING:  ParadeDB: reviews column 'rating' = '5'
WARNING:  ParadeDB: Successfully fetched 5 columns from reviews relation
WARNING:  ParadeDB: Fetched 4 columns from outer relation, 5 from inner relation
WARNING:  ParadeDB: PLAN: Ok("{CUSTOMSCAN :scan.plan.startup_cost 100 :scan.plan.total_cost 100.01 :scan.plan.plan_rows 1 :scan.plan.plan_width 96 :scan.plan.parallel_aware false :scan.plan.parallel_safe false :scan.plan.async_capable false :scan.plan.plan_node_id 0 :scan.plan.targetlist ({TARGETENTRY :expr {VAR :varno -3 :varattno 1 :vartype 25 :vartypmod -1 :varcollid 100 :varnullingrels (b) :varlevelsup 0 :varnosyn 1 :varattnosyn 2 :location -1} :resno 1 :resname name :ressortgroupref 0 :resorigtbl 114278 :resorigcol 2 :resjunk false} {TARGETENTRY :expr {VAR :varno -3 :varattno 2 :vartype 25 :vartypmod -1 :varcollid 100 :varnullingrels (b) :varlevelsup 0 :varnosyn 1 :varattnosyn 3 :location -1} :resno 2 :resname description :ressortgroupref 0 :resorigtbl 114278 :resorigcol 3 :resjunk false} {TARGETENTRY :expr {VAR :varno -3 :varattno 3 :vartype 25 :vartypmod -1 :varcollid 100 :varnullingrels (b) :varlevelsup 0 :varnosyn 2 :varattnosyn 4 :location -1} :resno 3 :resname review_text :ressortgroupref 0 :resorigtbl 114287 :resorigcol 4 :resjunk false}) :scan.plan.qual <> :scan.plan.lefttree <> :scan.plan.righttree <> :scan.plan.initPlan <> :scan.plan.extParam (b) :scan.plan.allParam (b) :scan.scanrelid 0 :flags 4 :custom_plans <> :custom_exprs <> :custom_private (\"\\{\"heaprelid\":null,\"indexrelid\":null,\"range_table_index\":null,\"query\":null,\"limit\":null,\"segment_count\":0,\"sort_field\":null,\"sort_direction\":null,\"exec_method_type\":\"Normal\",\"var_attname_lookup\":[[\"1,2\",\"join_attr_1\"],[\"2,4\",\"join_attr_3\"],[\"1,3\",\"join_attr_2\"]],\"target_list_len\":3,\"planned_which_fast_fields\":null,\"referenced_columns_count\":0,\"join_search_predicates\":\\{\"outer_predicates\":[\\{\"rti\":1,\"relid\":114278,\"relname\":\"products\",\"query\":\\{\"with_index\":\\{\"oid\":114295,\"query\":\\{\"parse_with_field\":\\{\"field\":\"description\",\"query_string\":\"wireless\\ OR\\ smartphone\",\"lenient\":null,\"conjunction_mode\":null\\}\\}\\}\\},\"uses_search_operator\":true\\}],\"inner_predicates\":[\\{\"rti\":2,\"relid\":114287,\"relname\":\"reviews\",\"query\":\\{\"with_index\":\\{\"oid\":114296,\"query\":\\{\"parse_with_field\":\\{\"field\":\"review_text\",\"query_string\":\"amazing\\ OR\\ perfect\",\"lenient\":null,\"conjunction_mode\":null\\}\\}\\}\\},\"uses_search_operator\":true\\}],\"join_conditions\":[]\\},\"join_outer_relid\":114278,\"join_inner_relid\":114287\\}\") :custom_scan_tlist ({TARGETENTRY :expr {VAR :varno 1 :varattno 2 :vartype 25 :vartypmod -1 :varcollid 100 :varnullingrels (b) :varlevelsup 0 :varnosyn 1 :varattnosyn 2 :location -1} :resno 1 :resname name :ressortgroupref 0 :resorigtbl 114278 :resorigcol 2 :resjunk false} {TARGETENTRY :expr {VAR :varno 1 :varattno 3 :vartype 25 :vartypmod -1 :varcollid 100 :varnullingrels (b) :varlevelsup 0 :varnosyn 1 :varattnosyn 3 :location -1} :resno 2 :resname description :ressortgroupref 0 :resorigtbl 114278 :resorigcol 3 :resjunk false} {TARGETENTRY :expr {VAR :varno 2 :varattno 4 :vartype 25 :vartypmod -1 :varcollid 100 :varnullingrels (b) :varlevelsup 0 :varnosyn 2 :varattnosyn 4 :location -1} :resno 3 :resname review_text :ressortgroupref 0 :resorigtbl 114287 :resorigcol 4 :resjunk false}) :custom_relids (b 1 2) :methods ParadeDB\\ Scan}")
WARNING:  ParadeDB: Analyzing 3 target entries using execution-time varno/attno mapping: [(1, Some((Ok("{VAR :varno -3 :varattno 1 :vartype 25 :vartypmod -1 :varcollid 100 :varnullingrels (b) :varlevelsup 0 :varnosyn 1 :varattnosyn 2 :location -1}"),))), (2, Some((Ok("{VAR :varno -3 :varattno 2 :vartype 25 :vartypmod -1 :varcollid 100 :varnullingrels (b) :varlevelsup 0 :varnosyn 1 :varattnosyn 3 :location -1}"),))), (3, Some((Ok("{VAR :varno -3 :varattno 3 :vartype 25 :vartypmod -1 :varcollid 100 :varnullingrels (b) :varlevelsup 0 :varnosyn 2 :varattnosyn 4 :location -1}"),)))]
WARNING:  ParadeDB: Mapped varno 4294967293 to outer relation products
WARNING:  ParadeDB: Built execution-time varno mapping with 1 entries: [(4294967293, "products")]
WARNING:  ParadeDB: Analyzing target entry 1 (resno: 1)
WARNING:  ParadeDB: Found Var in target entry 1 - varno: -3, attno: 1, varnosyn: 1, varattnosyn: 2
WARNING:  ParadeDB: Variable references INDEX/intermediate result, using varnosyn: 1, varattnosyn: 2
WARNING:  ParadeDB: Mapping original variable varnosyn: 1, varattnosyn: 2 to relation
WARNING:  ParadeDB: Using stored relation OIDs from join state - outer: products, inner: reviews
WARNING:  ParadeDB: varnosyn 1 mapped to outer relation products (attno 2)
WARNING:  ParadeDB: Relation products attno 2 -> column name 'name'
WARNING:  ParadeDB: Target entry 1 mapped to: RelationColumn { relid: 114278, column_name: "name" }
WARNING:  ParadeDB: Analyzing target entry 2 (resno: 2)
WARNING:  ParadeDB: Found Var in target entry 2 - varno: -3, attno: 2, varnosyn: 1, varattnosyn: 3
WARNING:  ParadeDB: Variable references INDEX/intermediate result, using varnosyn: 1, varattnosyn: 3
WARNING:  ParadeDB: Mapping original variable varnosyn: 1, varattnosyn: 3 to relation
WARNING:  ParadeDB: Using stored relation OIDs from join state - outer: products, inner: reviews
WARNING:  ParadeDB: varnosyn 1 mapped to outer relation products (attno 3)
WARNING:  ParadeDB: Relation products attno 3 -> column name 'description'
WARNING:  ParadeDB: Target entry 2 mapped to: RelationColumn { relid: 114278, column_name: "description" }
WARNING:  ParadeDB: Analyzing target entry 3 (resno: 3)
WARNING:  ParadeDB: Found Var in target entry 3 - varno: -3, attno: 3, varnosyn: 2, varattnosyn: 4
WARNING:  ParadeDB: Variable references INDEX/intermediate result, using varnosyn: 2, varattnosyn: 4
WARNING:  ParadeDB: Mapping original variable varnosyn: 2, varattnosyn: 4 to relation
WARNING:  ParadeDB: Using stored relation OIDs from join state - outer: products, inner: reviews
WARNING:  ParadeDB: varnosyn 2 mapped to inner relation reviews (attno 4)
WARNING:  ParadeDB: Relation reviews attno 4 -> column name 'review_text'
WARNING:  ParadeDB: Target entry 3 mapped to: RelationColumn { relid: 114287, column_name: "review_text" }
WARNING:  ParadeDB: Mapped 3 out of 3 column values: [Some("Smartphone X"), Some("Latest smartphone with cutting-edge technology"), Some("Excellent laptop with amazing performance and battery life")]
WARNING:  ParadeDB: Created join result tuple with real heap data: [Some("Smartphone X"), Some("Latest smartphone with cutting-edge technology"), Some("Excellent laptop with amazing performance and battery life")]
WARNING:  ParadeDB: Executing join step
WARNING:  ParadeDB: Performing join matching
WARNING:  ParadeDB: Matching and returning next tuple
WARNING:  ParadeDB: Standard join matching for base relations
WARNING:  ParadeDB: Processing join match [2/2] × [2/3]
WARNING:  ParadeDB: Creating join result tuple for outer[1], inner[1]
WARNING:  ParadeDB: Creating result tuple with 3 attributes
WARNING:  ParadeDB: Using stored relation OIDs from join state - outer: products, inner: reviews
WARNING:  ParadeDB: Fetching real heap tuple values from relations products and reviews
WARNING:  ParadeDB: Using stored relation OIDs from join state - outer: products, inner: reviews
WARNING:  ParadeDB: Detected relations from predicates - outer: 'products', inner: 'reviews'
WARNING:  ParadeDB: Fetching all columns with names from relation products with CTID 5
WARNING:  ParadeDB: products column 'id' = '5'
WARNING:  ParadeDB: products column 'name' = 'Smartphone X'
WARNING:  ParadeDB: products column 'description' = 'Latest smartphone with cutting-edge technology'
WARNING:  ParadeDB: products column 'category' = 'Electronics'
WARNING:  ParadeDB: Successfully fetched 4 columns from products relation
WARNING:  ParadeDB: Fetching all columns with names from relation reviews with CTID 3
WARNING:  ParadeDB: reviews column 'id' = '3'
WARNING:  ParadeDB: reviews column 'product_id' = '2'
WARNING:  ParadeDB: reviews column 'reviewer_name' = 'Bob Wilson'
WARNING:  ParadeDB: reviews column 'review_text' = 'Perfect wireless mouse, very responsive and comfortable'
WARNING:  ParadeDB: reviews column 'rating' = '5'
WARNING:  ParadeDB: Successfully fetched 5 columns from reviews relation
WARNING:  ParadeDB: Fetched 4 columns from outer relation, 5 from inner relation
WARNING:  ParadeDB: PLAN: Ok("{CUSTOMSCAN :scan.plan.startup_cost 100 :scan.plan.total_cost 100.01 :scan.plan.plan_rows 1 :scan.plan.plan_width 96 :scan.plan.parallel_aware false :scan.plan.parallel_safe false :scan.plan.async_capable false :scan.plan.plan_node_id 0 :scan.plan.targetlist ({TARGETENTRY :expr {VAR :varno -3 :varattno 1 :vartype 25 :vartypmod -1 :varcollid 100 :varnullingrels (b) :varlevelsup 0 :varnosyn 1 :varattnosyn 2 :location -1} :resno 1 :resname name :ressortgroupref 0 :resorigtbl 114278 :resorigcol 2 :resjunk false} {TARGETENTRY :expr {VAR :varno -3 :varattno 2 :vartype 25 :vartypmod -1 :varcollid 100 :varnullingrels (b) :varlevelsup 0 :varnosyn 1 :varattnosyn 3 :location -1} :resno 2 :resname description :ressortgroupref 0 :resorigtbl 114278 :resorigcol 3 :resjunk false} {TARGETENTRY :expr {VAR :varno -3 :varattno 3 :vartype 25 :vartypmod -1 :varcollid 100 :varnullingrels (b) :varlevelsup 0 :varnosyn 2 :varattnosyn 4 :location -1} :resno 3 :resname review_text :ressortgroupref 0 :resorigtbl 114287 :resorigcol 4 :resjunk false}) :scan.plan.qual <> :scan.plan.lefttree <> :scan.plan.righttree <> :scan.plan.initPlan <> :scan.plan.extParam (b) :scan.plan.allParam (b) :scan.scanrelid 0 :flags 4 :custom_plans <> :custom_exprs <> :custom_private (\"\\{\"heaprelid\":null,\"indexrelid\":null,\"range_table_index\":null,\"query\":null,\"limit\":null,\"segment_count\":0,\"sort_field\":null,\"sort_direction\":null,\"exec_method_type\":\"Normal\",\"var_attname_lookup\":[[\"1,2\",\"join_attr_1\"],[\"2,4\",\"join_attr_3\"],[\"1,3\",\"join_attr_2\"]],\"target_list_len\":3,\"planned_which_fast_fields\":null,\"referenced_columns_count\":0,\"join_search_predicates\":\\{\"outer_predicates\":[\\{\"rti\":1,\"relid\":114278,\"relname\":\"products\",\"query\":\\{\"with_index\":\\{\"oid\":114295,\"query\":\\{\"parse_with_field\":\\{\"field\":\"description\",\"query_string\":\"wireless\\ OR\\ smartphone\",\"lenient\":null,\"conjunction_mode\":null\\}\\}\\}\\},\"uses_search_operator\":true\\}],\"inner_predicates\":[\\{\"rti\":2,\"relid\":114287,\"relname\":\"reviews\",\"query\":\\{\"with_index\":\\{\"oid\":114296,\"query\":\\{\"parse_with_field\":\\{\"field\":\"review_text\",\"query_string\":\"amazing\\ OR\\ perfect\",\"lenient\":null,\"conjunction_mode\":null\\}\\}\\}\\},\"uses_search_operator\":true\\}],\"join_conditions\":[]\\},\"join_outer_relid\":114278,\"join_inner_relid\":114287\\}\") :custom_scan_tlist ({TARGETENTRY :expr {VAR :varno 1 :varattno 2 :vartype 25 :vartypmod -1 :varcollid 100 :varnullingrels (b) :varlevelsup 0 :varnosyn 1 :varattnosyn 2 :location -1} :resno 1 :resname name :ressortgroupref 0 :resorigtbl 114278 :resorigcol 2 :resjunk false} {TARGETENTRY :expr {VAR :varno 1 :varattno 3 :vartype 25 :vartypmod -1 :varcollid 100 :varnullingrels (b) :varlevelsup 0 :varnosyn 1 :varattnosyn 3 :location -1} :resno 2 :resname description :ressortgroupref 0 :resorigtbl 114278 :resorigcol 3 :resjunk false} {TARGETENTRY :expr {VAR :varno 2 :varattno 4 :vartype 25 :vartypmod -1 :varcollid 100 :varnullingrels (b) :varlevelsup 0 :varnosyn 2 :varattnosyn 4 :location -1} :resno 3 :resname review_text :ressortgroupref 0 :resorigtbl 114287 :resorigcol 4 :resjunk false}) :custom_relids (b 1 2) :methods ParadeDB\\ Scan}")
WARNING:  ParadeDB: Analyzing 3 target entries using execution-time varno/attno mapping: [(1, Some((Ok("{VAR :varno -3 :varattno 1 :vartype 25 :vartypmod -1 :varcollid 100 :varnullingrels (b) :varlevelsup 0 :varnosyn 1 :varattnosyn 2 :location -1}"),))), (2, Some((Ok("{VAR :varno -3 :varattno 2 :vartype 25 :vartypmod -1 :varcollid 100 :varnullingrels (b) :varlevelsup 0 :varnosyn 1 :varattnosyn 3 :location -1}"),))), (3, Some((Ok("{VAR :varno -3 :varattno 3 :vartype 25 :vartypmod -1 :varcollid 100 :varnullingrels (b) :varlevelsup 0 :varnosyn 2 :varattnosyn 4 :location -1}"),)))]
WARNING:  ParadeDB: Mapped varno 4294967293 to outer relation products
WARNING:  ParadeDB: Built execution-time varno mapping with 1 entries: [(4294967293, "products")]
WARNING:  ParadeDB: Analyzing target entry 1 (resno: 1)
WARNING:  ParadeDB: Found Var in target entry 1 - varno: -3, attno: 1, varnosyn: 1, varattnosyn: 2
WARNING:  ParadeDB: Variable references INDEX/intermediate result, using varnosyn: 1, varattnosyn: 2
WARNING:  ParadeDB: Mapping original variable varnosyn: 1, varattnosyn: 2 to relation
WARNING:  ParadeDB: Using stored relation OIDs from join state - outer: products, inner: reviews
WARNING:  ParadeDB: varnosyn 1 mapped to outer relation products (attno 2)
WARNING:  ParadeDB: Relation products attno 2 -> column name 'name'
WARNING:  ParadeDB: Target entry 1 mapped to: RelationColumn { relid: 114278, column_name: "name" }
WARNING:  ParadeDB: Analyzing target entry 2 (resno: 2)
WARNING:  ParadeDB: Found Var in target entry 2 - varno: -3, attno: 2, varnosyn: 1, varattnosyn: 3
WARNING:  ParadeDB: Variable references INDEX/intermediate result, using varnosyn: 1, varattnosyn: 3
WARNING:  ParadeDB: Mapping original variable varnosyn: 1, varattnosyn: 3 to relation
WARNING:  ParadeDB: Using stored relation OIDs from join state - outer: products, inner: reviews
WARNING:  ParadeDB: varnosyn 1 mapped to outer relation products (attno 3)
WARNING:  ParadeDB: Relation products attno 3 -> column name 'description'
WARNING:  ParadeDB: Target entry 2 mapped to: RelationColumn { relid: 114278, column_name: "description" }
WARNING:  ParadeDB: Analyzing target entry 3 (resno: 3)
WARNING:  ParadeDB: Found Var in target entry 3 - varno: -3, attno: 3, varnosyn: 2, varattnosyn: 4
WARNING:  ParadeDB: Variable references INDEX/intermediate result, using varnosyn: 2, varattnosyn: 4
WARNING:  ParadeDB: Mapping original variable varnosyn: 2, varattnosyn: 4 to relation
WARNING:  ParadeDB: Using stored relation OIDs from join state - outer: products, inner: reviews
WARNING:  ParadeDB: varnosyn 2 mapped to inner relation reviews (attno 4)
WARNING:  ParadeDB: Relation reviews attno 4 -> column name 'review_text'
WARNING:  ParadeDB: Target entry 3 mapped to: RelationColumn { relid: 114287, column_name: "review_text" }
WARNING:  ParadeDB: Mapped 3 out of 3 column values: [Some("Smartphone X"), Some("Latest smartphone with cutting-edge technology"), Some("Perfect wireless mouse, very responsive and comfortable")]
WARNING:  ParadeDB: Created join result tuple with real heap data: [Some("Smartphone X"), Some("Latest smartphone with cutting-edge technology"), Some("Perfect wireless mouse, very responsive and comfortable")]
WARNING:  ParadeDB: Executing join step
WARNING:  ParadeDB: Performing join matching
WARNING:  ParadeDB: Matching and returning next tuple
WARNING:  ParadeDB: Standard join matching for base relations
WARNING:  ParadeDB: Processing join match [2/2] × [3/3]
WARNING:  ParadeDB: Creating join result tuple for outer[1], inner[2]
WARNING:  ParadeDB: Creating result tuple with 3 attributes
WARNING:  ParadeDB: Using stored relation OIDs from join state - outer: products, inner: reviews
WARNING:  ParadeDB: Fetching real heap tuple values from relations products and reviews
WARNING:  ParadeDB: Using stored relation OIDs from join state - outer: products, inner: reviews
WARNING:  ParadeDB: Detected relations from predicates - outer: 'products', inner: 'reviews'
WARNING:  ParadeDB: Fetching all columns with names from relation products with CTID 5
WARNING:  ParadeDB: products column 'id' = '5'
WARNING:  ParadeDB: products column 'name' = 'Smartphone X'
WARNING:  ParadeDB: products column 'description' = 'Latest smartphone with cutting-edge technology'
WARNING:  ParadeDB: products column 'category' = 'Electronics'
WARNING:  ParadeDB: Successfully fetched 4 columns from products relation
WARNING:  ParadeDB: Fetching all columns with names from relation reviews with CTID 6
WARNING:  ParadeDB: reviews column 'id' = '6'
WARNING:  ParadeDB: reviews column 'product_id' = '5'
WARNING:  ParadeDB: reviews column 'reviewer_name' = 'Eva Martinez'
WARNING:  ParadeDB: reviews column 'review_text' = 'Amazing smartphone with incredible camera and performance'
WARNING:  ParadeDB: reviews column 'rating' = '5'
WARNING:  ParadeDB: Successfully fetched 5 columns from reviews relation
WARNING:  ParadeDB: Fetched 4 columns from outer relation, 5 from inner relation
WARNING:  ParadeDB: PLAN: Ok("{CUSTOMSCAN :scan.plan.startup_cost 100 :scan.plan.total_cost 100.01 :scan.plan.plan_rows 1 :scan.plan.plan_width 96 :scan.plan.parallel_aware false :scan.plan.parallel_safe false :scan.plan.async_capable false :scan.plan.plan_node_id 0 :scan.plan.targetlist ({TARGETENTRY :expr {VAR :varno -3 :varattno 1 :vartype 25 :vartypmod -1 :varcollid 100 :varnullingrels (b) :varlevelsup 0 :varnosyn 1 :varattnosyn 2 :location -1} :resno 1 :resname name :ressortgroupref 0 :resorigtbl 114278 :resorigcol 2 :resjunk false} {TARGETENTRY :expr {VAR :varno -3 :varattno 2 :vartype 25 :vartypmod -1 :varcollid 100 :varnullingrels (b) :varlevelsup 0 :varnosyn 1 :varattnosyn 3 :location -1} :resno 2 :resname description :ressortgroupref 0 :resorigtbl 114278 :resorigcol 3 :resjunk false} {TARGETENTRY :expr {VAR :varno -3 :varattno 3 :vartype 25 :vartypmod -1 :varcollid 100 :varnullingrels (b) :varlevelsup 0 :varnosyn 2 :varattnosyn 4 :location -1} :resno 3 :resname review_text :ressortgroupref 0 :resorigtbl 114287 :resorigcol 4 :resjunk false}) :scan.plan.qual <> :scan.plan.lefttree <> :scan.plan.righttree <> :scan.plan.initPlan <> :scan.plan.extParam (b) :scan.plan.allParam (b) :scan.scanrelid 0 :flags 4 :custom_plans <> :custom_exprs <> :custom_private (\"\\{\"heaprelid\":null,\"indexrelid\":null,\"range_table_index\":null,\"query\":null,\"limit\":null,\"segment_count\":0,\"sort_field\":null,\"sort_direction\":null,\"exec_method_type\":\"Normal\",\"var_attname_lookup\":[[\"1,2\",\"join_attr_1\"],[\"2,4\",\"join_attr_3\"],[\"1,3\",\"join_attr_2\"]],\"target_list_len\":3,\"planned_which_fast_fields\":null,\"referenced_columns_count\":0,\"join_search_predicates\":\\{\"outer_predicates\":[\\{\"rti\":1,\"relid\":114278,\"relname\":\"products\",\"query\":\\{\"with_index\":\\{\"oid\":114295,\"query\":\\{\"parse_with_field\":\\{\"field\":\"description\",\"query_string\":\"wireless\\ OR\\ smartphone\",\"lenient\":null,\"conjunction_mode\":null\\}\\}\\}\\},\"uses_search_operator\":true\\}],\"inner_predicates\":[\\{\"rti\":2,\"relid\":114287,\"relname\":\"reviews\",\"query\":\\{\"with_index\":\\{\"oid\":114296,\"query\":\\{\"parse_with_field\":\\{\"field\":\"review_text\",\"query_string\":\"amazing\\ OR\\ perfect\",\"lenient\":null,\"conjunction_mode\":null\\}\\}\\}\\},\"uses_search_operator\":true\\}],\"join_conditions\":[]\\},\"join_outer_relid\":114278,\"join_inner_relid\":114287\\}\") :custom_scan_tlist ({TARGETENTRY :expr {VAR :varno 1 :varattno 2 :vartype 25 :vartypmod -1 :varcollid 100 :varnullingrels (b) :varlevelsup 0 :varnosyn 1 :varattnosyn 2 :location -1} :resno 1 :resname name :ressortgroupref 0 :resorigtbl 114278 :resorigcol 2 :resjunk false} {TARGETENTRY :expr {VAR :varno 1 :varattno 3 :vartype 25 :vartypmod -1 :varcollid 100 :varnullingrels (b) :varlevelsup 0 :varnosyn 1 :varattnosyn 3 :location -1} :resno 2 :resname description :ressortgroupref 0 :resorigtbl 114278 :resorigcol 3 :resjunk false} {TARGETENTRY :expr {VAR :varno 2 :varattno 4 :vartype 25 :vartypmod -1 :varcollid 100 :varnullingrels (b) :varlevelsup 0 :varnosyn 2 :varattnosyn 4 :location -1} :resno 3 :resname review_text :ressortgroupref 0 :resorigtbl 114287 :resorigcol 4 :resjunk false}) :custom_relids (b 1 2) :methods ParadeDB\\ Scan}")
WARNING:  ParadeDB: Analyzing 3 target entries using execution-time varno/attno mapping: [(1, Some((Ok("{VAR :varno -3 :varattno 1 :vartype 25 :vartypmod -1 :varcollid 100 :varnullingrels (b) :varlevelsup 0 :varnosyn 1 :varattnosyn 2 :location -1}"),))), (2, Some((Ok("{VAR :varno -3 :varattno 2 :vartype 25 :vartypmod -1 :varcollid 100 :varnullingrels (b) :varlevelsup 0 :varnosyn 1 :varattnosyn 3 :location -1}"),))), (3, Some((Ok("{VAR :varno -3 :varattno 3 :vartype 25 :vartypmod -1 :varcollid 100 :varnullingrels (b) :varlevelsup 0 :varnosyn 2 :varattnosyn 4 :location -1}"),)))]
WARNING:  ParadeDB: Mapped varno 4294967293 to outer relation products
WARNING:  ParadeDB: Built execution-time varno mapping with 1 entries: [(4294967293, "products")]
WARNING:  ParadeDB: Analyzing target entry 1 (resno: 1)
WARNING:  ParadeDB: Found Var in target entry 1 - varno: -3, attno: 1, varnosyn: 1, varattnosyn: 2
WARNING:  ParadeDB: Variable references INDEX/intermediate result, using varnosyn: 1, varattnosyn: 2
WARNING:  ParadeDB: Mapping original variable varnosyn: 1, varattnosyn: 2 to relation
WARNING:  ParadeDB: Using stored relation OIDs from join state - outer: products, inner: reviews
WARNING:  ParadeDB: varnosyn 1 mapped to outer relation products (attno 2)
WARNING:  ParadeDB: Relation products attno 2 -> column name 'name'
WARNING:  ParadeDB: Target entry 1 mapped to: RelationColumn { relid: 114278, column_name: "name" }
WARNING:  ParadeDB: Analyzing target entry 2 (resno: 2)
WARNING:  ParadeDB: Found Var in target entry 2 - varno: -3, attno: 2, varnosyn: 1, varattnosyn: 3
WARNING:  ParadeDB: Variable references INDEX/intermediate result, using varnosyn: 1, varattnosyn: 3
WARNING:  ParadeDB: Mapping original variable varnosyn: 1, varattnosyn: 3 to relation
WARNING:  ParadeDB: Using stored relation OIDs from join state - outer: products, inner: reviews
WARNING:  ParadeDB: varnosyn 1 mapped to outer relation products (attno 3)
WARNING:  ParadeDB: Relation products attno 3 -> column name 'description'
WARNING:  ParadeDB: Target entry 2 mapped to: RelationColumn { relid: 114278, column_name: "description" }
WARNING:  ParadeDB: Analyzing target entry 3 (resno: 3)
WARNING:  ParadeDB: Found Var in target entry 3 - varno: -3, attno: 3, varnosyn: 2, varattnosyn: 4
WARNING:  ParadeDB: Variable references INDEX/intermediate result, using varnosyn: 2, varattnosyn: 4
WARNING:  ParadeDB: Mapping original variable varnosyn: 2, varattnosyn: 4 to relation
WARNING:  ParadeDB: Using stored relation OIDs from join state - outer: products, inner: reviews
WARNING:  ParadeDB: varnosyn 2 mapped to inner relation reviews (attno 4)
WARNING:  ParadeDB: Relation reviews attno 4 -> column name 'review_text'
WARNING:  ParadeDB: Target entry 3 mapped to: RelationColumn { relid: 114287, column_name: "review_text" }
WARNING:  ParadeDB: Mapped 3 out of 3 column values: [Some("Smartphone X"), Some("Latest smartphone with cutting-edge technology"), Some("Amazing smartphone with incredible camera and performance")]
WARNING:  ParadeDB: Created join result tuple with real heap data: [Some("Smartphone X"), Some("Latest smartphone with cutting-edge technology"), Some("Amazing smartphone with incredible camera and performance")]
WARNING:  ParadeDB: Executing join step
WARNING:  ParadeDB: Performing join matching
WARNING:  ParadeDB: Matching and returning next tuple
WARNING:  ParadeDB: Standard join matching for base relations
WARNING:  ParadeDB: Join matching complete - total matches: 6
WARNING:  ParadeDB: Cleaning up join execution
WARNING:  ParadeDB: Cleaning up join execution state
WARNING:  ParadeDB: ===== JOIN EXECUTION STATISTICS =====
WARNING:  ParadeDB: Search Results - Outer: 2, Inner: 3, Total Combinations: 6
WARNING:  ParadeDB: Join Processing - Matches: 6, Returned: 6, Success Rate: 100.0%
WARNING:  ParadeDB: Heap Tuple Access - Attempts: 12, Successes: 18, Success Rate: 150.0%
WARNING:  ParadeDB: Cleaned up 2 search readers
WARNING:  ParadeDB: Cleared 2 outer and 3 inner search results
WARNING:  ParadeDB: ===== END JOIN EXECUTION STATISTICS =====
WARNING:  ParadeDB: Join execution cleanup complete
      name      |                   description                    |                        review_text                         
----------------+--------------------------------------------------+------------------------------------------------------------
 Wireless Mouse | Ergonomic wireless mouse with precision tracking | Excellent laptop with amazing performance and battery life
 Wireless Mouse | Ergonomic wireless mouse with precision tracking | Perfect wireless mouse, very responsive and comfortable
 Wireless Mouse | Ergonomic wireless mouse with precision tracking | Amazing smartphone with incredible camera and performance
 Smartphone X   | Latest smartphone with cutting-edge technology   | Excellent laptop with amazing performance and battery life
 Smartphone X   | Latest smartphone with cutting-edge technology   | Perfect wireless mouse, very responsive and comfortable
 Smartphone X   | Latest smartphone with cutting-edge technology   | Amazing smartphone with incredible camera and performance
(6 rows)

-- Test 4: Search with numeric conditions (should still trigger custom join)
SELECT p.name, r.review_text, r.rating
FROM products p
JOIN reviews r ON p.id = r.product_id
WHERE p.description @@@ 'laptop' AND r.rating >= 4;
WARNING:  ParadeDB: Join pathlist callback called - jointype: 0, outer relids: ["products"], inner relids: ["reviews"]
WARNING:  ParadeDB: Found BM25 index for relation products (rti 1)
WARNING:  ParadeDB: Checked relations ["products"] for BM25 indexes, found: true
WARNING:  ParadeDB: Found BM25 index for relation reviews (rti 2)
WARNING:  ParadeDB: Checked relations ["reviews"] for BM25 indexes, found: true
WARNING:  ParadeDB: Join feasibility check - outer has BM25: true, inner has BM25: true
WARNING:  ParadeDB: Analyzing join search predicates
WARNING:  ParadeDB: Found 1 join restriction clauses
WARNING:  ParadeDB: Analyzing join clause of type T_OpExpr
WARNING:  ParadeDB: Analyzing 1 base restriction clauses for relation
WARNING:  ParadeDB: Extracting predicates for relation products (rti 1)
WARNING:  ParadeDB: Extracted search query for products: uses_search_operator=true
WARNING:  ParadeDB: Analyzing 1 base restriction clauses for relation
WARNING:  ParadeDB: Extracting predicates for relation reviews (rti 2)
WARNING:  ParadeDB: Extracted search query for reviews: uses_search_operator=false
WARNING:  ParadeDB: Extracted 1 outer predicates, 1 inner predicates, 0 join conditions
WARNING:  ParadeDB: Found search predicates - outer: 1, inner: 1, bilateral: true
WARNING:  ParadeDB: Join is feasible - outer feasible: true, inner feasible: false
WARNING:  ParadeDB: Outer predicate for products - uses_search: true
WARNING:  ParadeDB: Inner predicate for reviews - uses_search: false
WARNING:  ParadeDB: Bilateral search detected - proceeding with custom join path
WARNING:  ParadeDB: Storing join relation OIDs - outer: ["products"], inner: ["reviews"]
WARNING:  ParadeDB: Join path estimates - rows: 1, startup_cost: 100.00, total_cost: 100.01
WARNING:  ParadeDB: Created custom join path, adding to joinrel
WARNING:  ParadeDB: Join pathlist callback called - jointype: 0, outer relids: ["reviews"], inner relids: ["products"]
WARNING:  ParadeDB: Found BM25 index for relation reviews (rti 2)
WARNING:  ParadeDB: Checked relations ["reviews"] for BM25 indexes, found: true
WARNING:  ParadeDB: Found BM25 index for relation products (rti 1)
WARNING:  ParadeDB: Checked relations ["products"] for BM25 indexes, found: true
WARNING:  ParadeDB: Join feasibility check - outer has BM25: true, inner has BM25: true
WARNING:  ParadeDB: Analyzing join search predicates
WARNING:  ParadeDB: Found 1 join restriction clauses
WARNING:  ParadeDB: Analyzing join clause of type T_OpExpr
WARNING:  ParadeDB: Analyzing 1 base restriction clauses for relation
WARNING:  ParadeDB: Extracting predicates for relation reviews (rti 2)
WARNING:  ParadeDB: Extracted search query for reviews: uses_search_operator=false
WARNING:  ParadeDB: Analyzing 1 base restriction clauses for relation
WARNING:  ParadeDB: Extracting predicates for relation products (rti 1)
WARNING:  ParadeDB: Extracted search query for products: uses_search_operator=true
WARNING:  ParadeDB: Extracted 1 outer predicates, 1 inner predicates, 0 join conditions
WARNING:  ParadeDB: Found search predicates - outer: 1, inner: 1, bilateral: true
WARNING:  ParadeDB: Join is feasible - outer feasible: false, inner feasible: true
WARNING:  ParadeDB: Outer predicate for reviews - uses_search: false
WARNING:  ParadeDB: Inner predicate for products - uses_search: true
WARNING:  ParadeDB: Bilateral search detected - proceeding with custom join path
WARNING:  ParadeDB: Storing join relation OIDs - outer: ["reviews"], inner: ["products"]
WARNING:  ParadeDB: Join path estimates - rows: 1, startup_cost: 100.00, total_cost: 100.01
WARNING:  ParadeDB: Created custom join path, adding to joinrel
WARNING:  ParadeDB: Planning custom join path with scanrelid = 0
WARNING:  ParadeDB: Join target list has 3 entries
WARNING:  ParadeDB: Mapped join variable varno=1, varattno=2 to 'join_attr_1'
WARNING:  ParadeDB: Mapped join variable varno=2, varattno=4 to 'join_attr_2'
WARNING:  ParadeDB: Mapped join variable varno=2, varattno=5 to 'join_attr_3'
WARNING:  ParadeDB: Set custom scan target list for join node
WARNING:  ParadeDB: Creating custom scan state for join node (scanrelid = 0)
WARNING:  ParadeDB: Extracted search predicates from private data - outer: 1, inner: 1, bilateral: true
WARNING:  ParadeDB: Stored outer relation OID: products
WARNING:  ParadeDB: Stored inner relation OID: reviews
WARNING:  ParadeDB: Storing 3 variable mappings from planning phase
WARNING:  ParadeDB: Planning-time mapping: varno=1, attno=2 -> 'join_attr_1'
WARNING:  ParadeDB: Planning-time mapping: varno=2, attno=4 -> 'join_attr_2'
WARNING:  ParadeDB: Planning-time mapping: varno=2, attno=5 -> 'join_attr_3'
WARNING:  ParadeDB: Beginning custom scan for join node
WARNING:  ParadeDB: Initializing join execution (simplified)
WARNING:  ParadeDB: Using stored search predicates - outer: 1, inner: 1, bilateral: true
WARNING:  ParadeDB: Join execution initialization complete
WARNING:  ParadeDB: Executing join step
WARNING:  ParadeDB: Starting join execution - initializing search
WARNING:  ParadeDB: Initializing search execution for join
WARNING:  ParadeDB: Retrieved search predicates from join state - outer: 1, inner: 1
WARNING:  ParadeDB: Initializing search readers for join relations
WARNING:  ParadeDB: Opening search reader for outer relation products
WARNING:  ParadeDB: Successfully opened search reader for products
WARNING:  ParadeDB: Initialized 1 search readers
WARNING:  ParadeDB: Executing real searches on join relations
WARNING:  ParadeDB: Executing search on outer relation products
WARNING:  ParadeDB: Executing real BM25 search on relation products
WARNING:  ParadeDB: Real search on products returned 1 results
WARNING:  ParadeDB: Found 1 results for outer relation products
WARNING:  ParadeDB: No inner search results, using default result
WARNING:  ParadeDB: Completed real search execution - outer: 1, inner: 1
WARNING:  ParadeDB: Executing join step
WARNING:  ParadeDB: Executing outer search
WARNING:  ParadeDB: Executing search on outer relation
WARNING:  ParadeDB: Outer search completed - 1 results
WARNING:  ParadeDB: Executing join step
WARNING:  ParadeDB: Executing inner search
WARNING:  ParadeDB: Executing search on inner relation
WARNING:  ParadeDB: Inner search completed - 1 results
WARNING:  ParadeDB: Executing join step
WARNING:  ParadeDB: Performing join matching
WARNING:  ParadeDB: Matching and returning next tuple
WARNING:  ParadeDB: Standard join matching for base relations
WARNING:  ParadeDB: Processing join match [1/1] × [1/1]
WARNING:  ParadeDB: Creating join result tuple for outer[0], inner[0]
WARNING:  ParadeDB: Creating result tuple with 3 attributes
WARNING:  ParadeDB: Using stored relation OIDs from join state - outer: products, inner: reviews
WARNING:  ParadeDB: Fetching real heap tuple values from relations products and reviews
WARNING:  ParadeDB: Using stored relation OIDs from join state - outer: products, inner: reviews
WARNING:  ParadeDB: Detected relations from predicates - outer: 'products', inner: 'reviews'
WARNING:  ParadeDB: Fetching all columns with names from relation products with CTID 1
WARNING:  ParadeDB: products column 'id' = '1'
WARNING:  ParadeDB: products column 'name' = 'Laptop Pro'
WARNING:  ParadeDB: products column 'description' = 'High-performance laptop with advanced features for professionals'
WARNING:  ParadeDB: products column 'category' = 'Electronics'
WARNING:  ParadeDB: Successfully fetched 4 columns from products relation
WARNING:  ParadeDB: Fetching all columns with names from relation reviews with CTID 1
WARNING:  ParadeDB: reviews column 'id' = '1'
WARNING:  ParadeDB: reviews column 'product_id' = '1'
WARNING:  ParadeDB: reviews column 'reviewer_name' = 'John Doe'
WARNING:  ParadeDB: reviews column 'review_text' = 'Excellent laptop with amazing performance and battery life'
WARNING:  ParadeDB: reviews column 'rating' = '5'
WARNING:  ParadeDB: Successfully fetched 5 columns from reviews relation
WARNING:  ParadeDB: Fetched 4 columns from outer relation, 5 from inner relation
WARNING:  ParadeDB: PLAN: Ok("{CUSTOMSCAN :scan.plan.startup_cost 100 :scan.plan.total_cost 100.01 :scan.plan.plan_rows 1 :scan.plan.plan_width 68 :scan.plan.parallel_aware false :scan.plan.parallel_safe false :scan.plan.async_capable false :scan.plan.plan_node_id 0 :scan.plan.targetlist ({TARGETENTRY :expr {VAR :varno -3 :varattno 1 :vartype 25 :vartypmod -1 :varcollid 100 :varnullingrels (b) :varlevelsup 0 :varnosyn 1 :varattnosyn 2 :location -1} :resno 1 :resname name :ressortgroupref 0 :resorigtbl 114278 :resorigcol 2 :resjunk false} {TARGETENTRY :expr {VAR :varno -3 :varattno 2 :vartype 25 :vartypmod -1 :varcollid 100 :varnullingrels (b) :varlevelsup 0 :varnosyn 2 :varattnosyn 4 :location -1} :resno 2 :resname review_text :ressortgroupref 0 :resorigtbl 114287 :resorigcol 4 :resjunk false} {TARGETENTRY :expr {VAR :varno -3 :varattno 3 :vartype 23 :vartypmod -1 :varcollid 0 :varnullingrels (b) :varlevelsup 0 :varnosyn 2 :varattnosyn 5 :location -1} :resno 3 :resname rating :ressortgroupref 0 :resorigtbl 114287 :resorigcol 5 :resjunk false}) :scan.plan.qual <> :scan.plan.lefttree <> :scan.plan.righttree <> :scan.plan.initPlan <> :scan.plan.extParam (b) :scan.plan.allParam (b) :scan.scanrelid 0 :flags 4 :custom_plans <> :custom_exprs <> :custom_private (\"\\{\"heaprelid\":null,\"indexrelid\":null,\"range_table_index\":null,\"query\":null,\"limit\":null,\"segment_count\":0,\"sort_field\":null,\"sort_direction\":null,\"exec_method_type\":\"Normal\",\"var_attname_lookup\":[[\"1,2\",\"join_attr_1\"],[\"2,4\",\"join_attr_2\"],[\"2,5\",\"join_attr_3\"]],\"target_list_len\":3,\"planned_which_fast_fields\":null,\"referenced_columns_count\":0,\"join_search_predicates\":\\{\"outer_predicates\":[\\{\"rti\":1,\"relid\":114278,\"relname\":\"products\",\"query\":\\{\"with_index\":\\{\"oid\":114295,\"query\":\\{\"parse_with_field\":\\{\"field\":\"description\",\"query_string\":\"laptop\",\"lenient\":null,\"conjunction_mode\":null\\}\\}\\}\\},\"uses_search_operator\":true\\}],\"inner_predicates\":[\\{\"rti\":2,\"relid\":114287,\"relname\":\"reviews\",\"query\":\\{\"range\":\\{\"field\":\"rating\",\"lower_bound\":\\{\"included\":4\\},\"upper_bound\":null,\"is_datetime\":false\\}\\},\"uses_search_operator\":false\\}],\"join_conditions\":[]\\},\"join_outer_relid\":114278,\"join_inner_relid\":114287\\}\") :custom_scan_tlist ({TARGETENTRY :expr {VAR :varno 1 :varattno 2 :vartype 25 :vartypmod -1 :varcollid 100 :varnullingrels (b) :varlevelsup 0 :varnosyn 1 :varattnosyn 2 :location -1} :resno 1 :resname name :ressortgroupref 0 :resorigtbl 114278 :resorigcol 2 :resjunk false} {TARGETENTRY :expr {VAR :varno 2 :varattno 4 :vartype 25 :vartypmod -1 :varcollid 100 :varnullingrels (b) :varlevelsup 0 :varnosyn 2 :varattnosyn 4 :location -1} :resno 2 :resname review_text :ressortgroupref 0 :resorigtbl 114287 :resorigcol 4 :resjunk false} {TARGETENTRY :expr {VAR :varno 2 :varattno 5 :vartype 23 :vartypmod -1 :varcollid 0 :varnullingrels (b) :varlevelsup 0 :varnosyn 2 :varattnosyn 5 :location -1} :resno 3 :resname rating :ressortgroupref 0 :resorigtbl 114287 :resorigcol 5 :resjunk false}) :custom_relids (b 1 2) :methods ParadeDB\\ Scan}")
WARNING:  ParadeDB: Analyzing 3 target entries using execution-time varno/attno mapping: [(1, Some((Ok("{VAR :varno -3 :varattno 1 :vartype 25 :vartypmod -1 :varcollid 100 :varnullingrels (b) :varlevelsup 0 :varnosyn 1 :varattnosyn 2 :location -1}"),))), (2, Some((Ok("{VAR :varno -3 :varattno 2 :vartype 25 :vartypmod -1 :varcollid 100 :varnullingrels (b) :varlevelsup 0 :varnosyn 2 :varattnosyn 4 :location -1}"),))), (3, Some((Ok("{VAR :varno -3 :varattno 3 :vartype 23 :vartypmod -1 :varcollid 0 :varnullingrels (b) :varlevelsup 0 :varnosyn 2 :varattnosyn 5 :location -1}"),)))]
WARNING:  ParadeDB: Mapped varno 4294967293 to outer relation products
WARNING:  ParadeDB: Built execution-time varno mapping with 1 entries: [(4294967293, "products")]
WARNING:  ParadeDB: Analyzing target entry 1 (resno: 1)
WARNING:  ParadeDB: Found Var in target entry 1 - varno: -3, attno: 1, varnosyn: 1, varattnosyn: 2
WARNING:  ParadeDB: Variable references INDEX/intermediate result, using varnosyn: 1, varattnosyn: 2
WARNING:  ParadeDB: Mapping original variable varnosyn: 1, varattnosyn: 2 to relation
WARNING:  ParadeDB: Using stored relation OIDs from join state - outer: products, inner: reviews
WARNING:  ParadeDB: varnosyn 1 mapped to outer relation products (attno 2)
WARNING:  ParadeDB: Relation products attno 2 -> column name 'name'
WARNING:  ParadeDB: Target entry 1 mapped to: RelationColumn { relid: 114278, column_name: "name" }
WARNING:  ParadeDB: Analyzing target entry 2 (resno: 2)
WARNING:  ParadeDB: Found Var in target entry 2 - varno: -3, attno: 2, varnosyn: 2, varattnosyn: 4
WARNING:  ParadeDB: Variable references INDEX/intermediate result, using varnosyn: 2, varattnosyn: 4
WARNING:  ParadeDB: Mapping original variable varnosyn: 2, varattnosyn: 4 to relation
WARNING:  ParadeDB: Using stored relation OIDs from join state - outer: products, inner: reviews
WARNING:  ParadeDB: varnosyn 2 mapped to inner relation reviews (attno 4)
WARNING:  ParadeDB: Relation reviews attno 4 -> column name 'review_text'
WARNING:  ParadeDB: Target entry 2 mapped to: RelationColumn { relid: 114287, column_name: "review_text" }
WARNING:  ParadeDB: Analyzing target entry 3 (resno: 3)
WARNING:  ParadeDB: Found Var in target entry 3 - varno: -3, attno: 3, varnosyn: 2, varattnosyn: 5
WARNING:  ParadeDB: Variable references INDEX/intermediate result, using varnosyn: 2, varattnosyn: 5
WARNING:  ParadeDB: Mapping original variable varnosyn: 2, varattnosyn: 5 to relation
WARNING:  ParadeDB: Using stored relation OIDs from join state - outer: products, inner: reviews
WARNING:  ParadeDB: varnosyn 2 mapped to inner relation reviews (attno 5)
WARNING:  ParadeDB: Relation reviews attno 5 -> column name 'rating'
WARNING:  ParadeDB: Target entry 3 mapped to: RelationColumn { relid: 114287, column_name: "rating" }
WARNING:  ParadeDB: Mapped 3 out of 3 column values: [Some("Laptop Pro"), Some("Excellent laptop with amazing performance and battery life"), Some("5")]
WARNING:  ParadeDB: Created join result tuple with real heap data: [Some("Laptop Pro"), Some("Excellent laptop with amazing performance and battery life"), Some("5")]
WARNING:  ParadeDB: Executing join step
WARNING:  ParadeDB: Performing join matching
WARNING:  ParadeDB: Matching and returning next tuple
WARNING:  ParadeDB: Standard join matching for base relations
WARNING:  ParadeDB: Join matching complete - total matches: 1
WARNING:  ParadeDB: Cleaning up join execution
WARNING:  ParadeDB: Cleaning up join execution state
WARNING:  ParadeDB: ===== JOIN EXECUTION STATISTICS =====
WARNING:  ParadeDB: Search Results - Outer: 1, Inner: 1, Total Combinations: 1
WARNING:  ParadeDB: Join Processing - Matches: 1, Returned: 1, Success Rate: 100.0%
WARNING:  ParadeDB: Heap Tuple Access - Attempts: 2, Successes: 3, Success Rate: 150.0%
WARNING:  ParadeDB: Cleaned up 1 search readers
WARNING:  ParadeDB: Cleared 1 outer and 1 inner search results
WARNING:  ParadeDB: ===== END JOIN EXECUTION STATISTICS =====
WARNING:  ParadeDB: Join execution cleanup complete
    name    |                        review_text                         |  rating   
------------+------------------------------------------------------------+-----------
 Laptop Pro | Excellent laptop with amazing performance and battery life | 939731888
(1 row)

-- Test 5: No search predicates (should use regular join)
SELECT p.name, r.reviewer_name
FROM products p
JOIN reviews r ON p.id = r.product_id
WHERE p.id = 1;
WARNING:  ParadeDB: Join pathlist callback called - jointype: 0, outer relids: ["products"], inner relids: ["reviews"]
WARNING:  ParadeDB: Found BM25 index for relation products (rti 1)
WARNING:  ParadeDB: Checked relations ["products"] for BM25 indexes, found: true
WARNING:  ParadeDB: Found BM25 index for relation reviews (rti 2)
WARNING:  ParadeDB: Checked relations ["reviews"] for BM25 indexes, found: true
WARNING:  ParadeDB: Join feasibility check - outer has BM25: true, inner has BM25: true
WARNING:  ParadeDB: Analyzing join search predicates
WARNING:  ParadeDB: Analyzing 1 base restriction clauses for relation
WARNING:  ParadeDB: Extracting predicates for relation products (rti 1)
WARNING:  ParadeDB: Extracted search query for products: uses_search_operator=false
WARNING:  ParadeDB: Analyzing 1 base restriction clauses for relation
WARNING:  ParadeDB: Extracting predicates for relation reviews (rti 2)
WARNING:  ParadeDB: Extracted search query for reviews: uses_search_operator=false
WARNING:  ParadeDB: Extracted 1 outer predicates, 1 inner predicates, 0 join conditions
WARNING:  ParadeDB: Found search predicates - outer: 1, inner: 1, bilateral: true
WARNING:  ParadeDB: Skipping custom join - no search operators found (outer: false, inner: false)
WARNING:  ParadeDB: Join pathlist callback called - jointype: 0, outer relids: ["reviews"], inner relids: ["products"]
WARNING:  ParadeDB: Found BM25 index for relation reviews (rti 2)
WARNING:  ParadeDB: Checked relations ["reviews"] for BM25 indexes, found: true
WARNING:  ParadeDB: Found BM25 index for relation products (rti 1)
WARNING:  ParadeDB: Checked relations ["products"] for BM25 indexes, found: true
WARNING:  ParadeDB: Join feasibility check - outer has BM25: true, inner has BM25: true
WARNING:  ParadeDB: Analyzing join search predicates
WARNING:  ParadeDB: Analyzing 1 base restriction clauses for relation
WARNING:  ParadeDB: Extracting predicates for relation reviews (rti 2)
WARNING:  ParadeDB: Extracted search query for reviews: uses_search_operator=false
WARNING:  ParadeDB: Analyzing 1 base restriction clauses for relation
WARNING:  ParadeDB: Extracting predicates for relation products (rti 1)
WARNING:  ParadeDB: Extracted search query for products: uses_search_operator=false
WARNING:  ParadeDB: Extracted 1 outer predicates, 1 inner predicates, 0 join conditions
WARNING:  ParadeDB: Found search predicates - outer: 1, inner: 1, bilateral: true
WARNING:  ParadeDB: Skipping custom join - no search operators found (outer: false, inner: false)
    name    | reviewer_name 
------------+---------------
 Laptop Pro | John Doe
 Laptop Pro | Jane Smith
(2 rows)

-- Cleanup
DROP TABLE products CASCADE;
DROP TABLE reviews CASCADE;
RESET paradedb.enable_custom_join; 
