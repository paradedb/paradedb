DROP TABLE IF EXISTS rhs_typmod;
CREATE TABLE rhs_typmod(
    id serial8 not null primary key,
    t text
);
INSERT INTO rhs_typmod(t) VALUES ('hello, world');
CREATE INDEX idxrhs_typmod ON rhs_typmod USING bm25 (id, t) WITH (key_field = 'id');
-- should fail as @@@ doesn't support casting to a tokenizer on the rhs
SELECT * FROM rhs_typmod WHERE t @@@ 'hello'::pdb.ngram(3, 4);
ERROR:  operator does not exist: text @@@ pdb.ngram at character 34
-- but all of these should pass
SELECT * FROM rhs_typmod WHERE t &&& 'hello'::pdb.ngram(5, 6);
 id |      t       
----+--------------
  1 | hello, world
(1 row)

SELECT * FROM rhs_typmod WHERE t ||| 'hello'::pdb.ngram(5, 6);
 id |      t       
----+--------------
  1 | hello, world
(1 row)

SELECT * FROM rhs_typmod WHERE t ### 'hello'::pdb.ngram(5, 6);
 id |      t       
----+--------------
  1 | hello, world
(1 row)

SELECT * FROM rhs_typmod WHERE t === 'hello'::pdb.ngram(5, 6);
 id |      t       
----+--------------
  1 | hello, world
(1 row)

